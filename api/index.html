
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the AIPerf project">
      
      
        <meta name="author" content="NVIDIA CORPORATION & AFFILIATES">
      
      
      
        <link rel="prev" href="../Development/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>API Reference - AIPerf Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="AIPerf Documentation" class="md-header__button md-logo" aria-label="AIPerf Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AIPerf Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="AIPerf Documentation" class="md-nav__button md-logo" aria-label="AIPerf Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    AIPerf Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#aiperfcli" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.cli
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.cli" class="md-nav__link">
    <span class="md-ellipsis">
      cli
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.cli.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonbase_metaclass" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.base_metaclass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.base_metaclass" class="md-nav__link">
    <span class="md-ellipsis">
      base_metaclass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.base_metaclass.BaseMetaclass" class="md-nav__link">
    <span class="md-ellipsis">
      BaseMetaclass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.base_metaclass.register_metaclass" class="md-nav__link">
    <span class="md-ellipsis">
      register_metaclass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonbootstrap" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.bootstrap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.bootstrap" class="md-nav__link">
    <span class="md-ellipsis">
      bootstrap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.bootstrap.bootstrap_and_run_service" class="md-nav__link">
    <span class="md-ellipsis">
      bootstrap_and_run_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommsbase" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.base
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.base" class="md-nav__link">
    <span class="md-ellipsis">
      base
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication" class="md-nav__link">
    <span class="md-ellipsis">
      BaseCommunication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseCommunication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.is_initialized" class="md-nav__link">
    <span class="md-ellipsis">
      is_initialized
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.is_shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      is_shutdown
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.create_clients" class="md-nav__link">
    <span class="md-ellipsis">
      create_clients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.initialize" class="md-nav__link">
    <span class="md-ellipsis">
      initialize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.publish" class="md-nav__link">
    <span class="md-ellipsis">
      publish
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.pull" class="md-nav__link">
    <span class="md-ellipsis">
      pull
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.push" class="md-nav__link">
    <span class="md-ellipsis">
      push
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.request" class="md-nav__link">
    <span class="md-ellipsis">
      request
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.respond" class="md-nav__link">
    <span class="md-ellipsis">
      respond
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      shutdown
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.subscribe" class="md-nav__link">
    <span class="md-ellipsis">
      subscribe
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.CommunicationFactory" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationFactory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CommunicationFactory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.CommunicationFactory.create_communication" class="md-nav__link">
    <span class="md-ellipsis">
      create_communication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.CommunicationFactory.register" class="md-nav__link">
    <span class="md-ellipsis">
      register
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommsclient_enums" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.client_enums
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums" class="md-nav__link">
    <span class="md-ellipsis">
      client_enums
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.ClientType" class="md-nav__link">
    <span class="md-ellipsis">
      ClientType
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.PubClientType" class="md-nav__link">
    <span class="md-ellipsis">
      PubClientType
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PubClientType">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.PubClientType.from_topic" class="md-nav__link">
    <span class="md-ellipsis">
      from_topic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.PullClientType" class="md-nav__link">
    <span class="md-ellipsis">
      PullClientType
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PullClientType">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.PullClientType.from_topic" class="md-nav__link">
    <span class="md-ellipsis">
      from_topic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.PushClientType" class="md-nav__link">
    <span class="md-ellipsis">
      PushClientType
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PushClientType">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.PushClientType.from_topic" class="md-nav__link">
    <span class="md-ellipsis">
      from_topic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.RepClientType" class="md-nav__link">
    <span class="md-ellipsis">
      RepClientType
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RepClientType">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.RepClientType.from_topic" class="md-nav__link">
    <span class="md-ellipsis">
      from_topic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.ReqClientType" class="md-nav__link">
    <span class="md-ellipsis">
      ReqClientType
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ReqClientType">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.ReqClientType.from_topic" class="md-nav__link">
    <span class="md-ellipsis">
      from_topic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.SubClientType" class="md-nav__link">
    <span class="md-ellipsis">
      SubClientType
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SubClientType">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.SubClientType.from_topic" class="md-nav__link">
    <span class="md-ellipsis">
      from_topic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommszmqclientsbase" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.zmq.clients.base
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.base" class="md-nav__link">
    <span class="md-ellipsis">
      base
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient" class="md-nav__link">
    <span class="md-ellipsis">
      BaseZMQClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseZMQClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.is_initialized" class="md-nav__link">
    <span class="md-ellipsis">
      is_initialized
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.is_shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      is_shutdown
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.socket" class="md-nav__link">
    <span class="md-ellipsis">
      socket
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.socket_type_name" class="md-nav__link">
    <span class="md-ellipsis">
      socket_type_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.initialize" class="md-nav__link">
    <span class="md-ellipsis">
      initialize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      shutdown
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommszmqclientsmetaclass" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.zmq.clients.metaclass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.metaclass" class="md-nav__link">
    <span class="md-ellipsis">
      metaclass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.metaclass.ZMQClientMetaclass" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQClientMetaclass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommszmqclientspub" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.zmq.clients.pub
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.pub" class="md-nav__link">
    <span class="md-ellipsis">
      pub
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.pub.ZMQPubClient" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQPubClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ZMQPubClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.pub.ZMQPubClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.pub.ZMQPubClient.publish" class="md-nav__link">
    <span class="md-ellipsis">
      publish
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommszmqclientspull" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.zmq.clients.pull
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.pull" class="md-nav__link">
    <span class="md-ellipsis">
      pull
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.pull.ZMQPullClient" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQPullClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ZMQPullClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.pull.ZMQPullClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.pull.ZMQPullClient.pull" class="md-nav__link">
    <span class="md-ellipsis">
      pull
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommszmqclientspush" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.zmq.clients.push
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.push" class="md-nav__link">
    <span class="md-ellipsis">
      push
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.push.ZMQPushClient" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQPushClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ZMQPushClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.push.ZMQPushClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.push.ZMQPushClient.push" class="md-nav__link">
    <span class="md-ellipsis">
      push
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommszmqclientsrep" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.zmq.clients.rep
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.rep" class="md-nav__link">
    <span class="md-ellipsis">
      rep
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.rep.ZMQRepClient" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQRepClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ZMQRepClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.rep.ZMQRepClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.rep.ZMQRepClient.respond" class="md-nav__link">
    <span class="md-ellipsis">
      respond
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.rep.ZMQRepClient.wait_for_request" class="md-nav__link">
    <span class="md-ellipsis">
      wait_for_request
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommszmqclientsreq" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.zmq.clients.req
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.req" class="md-nav__link">
    <span class="md-ellipsis">
      req
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.req.ZMQReqClient" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQReqClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ZMQReqClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.req.ZMQReqClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.req.ZMQReqClient.request" class="md-nav__link">
    <span class="md-ellipsis">
      request
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommszmqclientssub" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.zmq.clients.sub
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.sub" class="md-nav__link">
    <span class="md-ellipsis">
      sub
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.sub.ZMQSubClient" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQSubClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ZMQSubClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.sub.ZMQSubClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.sub.ZMQSubClient.subscribe" class="md-nav__link">
    <span class="md-ellipsis">
      subscribe
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommszmqzmq_comms" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.zmq.zmq_comms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms" class="md-nav__link">
    <span class="md-ellipsis">
      zmq_comms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQCommunication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ZMQCommunication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.context" class="md-nav__link">
    <span class="md-ellipsis">
      context
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.is_initialized" class="md-nav__link">
    <span class="md-ellipsis">
      is_initialized
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.is_shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      is_shutdown
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.create_clients" class="md-nav__link">
    <span class="md-ellipsis">
      create_clients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.initialize" class="md-nav__link">
    <span class="md-ellipsis">
      initialize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.publish" class="md-nav__link">
    <span class="md-ellipsis">
      publish
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.pull" class="md-nav__link">
    <span class="md-ellipsis">
      pull
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.push" class="md-nav__link">
    <span class="md-ellipsis">
      push
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.request" class="md-nav__link">
    <span class="md-ellipsis">
      request
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.respond" class="md-nav__link">
    <span class="md-ellipsis">
      respond
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      shutdown
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.subscribe" class="md-nav__link">
    <span class="md-ellipsis">
      subscribe
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonconfigloader" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.config.loader
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.config.loader" class="md-nav__link">
    <span class="md-ellipsis">
      loader
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.config.loader.load_service_config" class="md-nav__link">
    <span class="md-ellipsis">
      load_service_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonconfigservice_config" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.config.service_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.config.service_config" class="md-nav__link">
    <span class="md-ellipsis">
      service_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.config.service_config.ServiceConfig" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommondecorators" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.decorators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators" class="md-nav__link">
    <span class="md-ellipsis">
      decorators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators.AIPerfHooks" class="md-nav__link">
    <span class="md-ellipsis">
      AIPerfHooks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators.aiperf_task" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf_task
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators.on_cleanup" class="md-nav__link">
    <span class="md-ellipsis">
      on_cleanup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators.on_comms_init" class="md-nav__link">
    <span class="md-ellipsis">
      on_comms_init
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators.on_configure" class="md-nav__link">
    <span class="md-ellipsis">
      on_configure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators.on_init" class="md-nav__link">
    <span class="md-ellipsis">
      on_init
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators.on_run" class="md-nav__link">
    <span class="md-ellipsis">
      on_run
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators.on_set_state" class="md-nav__link">
    <span class="md-ellipsis">
      on_set_state
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators.on_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_start
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators.on_stop" class="md-nav__link">
    <span class="md-ellipsis">
      on_stop
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonenums" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.enums
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums" class="md-nav__link">
    <span class="md-ellipsis">
      enums
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.TopicType" class="md-nav__link">
    <span class="md-ellipsis">
      TopicType
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.CommandType" class="md-nav__link">
    <span class="md-ellipsis">
      CommandType
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.CommunicationBackend" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationBackend
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CommunicationBackend">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.CommunicationBackend.ZMQ_TCP" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQ_TCP
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.DataTopic" class="md-nav__link">
    <span class="md-ellipsis">
      DataTopic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType" class="md-nav__link">
    <span class="md-ellipsis">
      MessageType
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MessageType">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType.COMMAND" class="md-nav__link">
    <span class="md-ellipsis">
      COMMAND
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType.CREDIT_DROP" class="md-nav__link">
    <span class="md-ellipsis">
      CREDIT_DROP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType.CREDIT_RETURN" class="md-nav__link">
    <span class="md-ellipsis">
      CREDIT_RETURN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType.DATA" class="md-nav__link">
    <span class="md-ellipsis">
      DATA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType.ERROR" class="md-nav__link">
    <span class="md-ellipsis">
      ERROR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType.HEARTBEAT" class="md-nav__link">
    <span class="md-ellipsis">
      HEARTBEAT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType.REGISTRATION" class="md-nav__link">
    <span class="md-ellipsis">
      REGISTRATION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType.RESPONSE" class="md-nav__link">
    <span class="md-ellipsis">
      RESPONSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType.STATUS" class="md-nav__link">
    <span class="md-ellipsis">
      STATUS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType.UNKNOWN" class="md-nav__link">
    <span class="md-ellipsis">
      UNKNOWN
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceRegistrationStatus" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceRegistrationStatus
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ServiceRegistrationStatus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceRegistrationStatus.ERROR" class="md-nav__link">
    <span class="md-ellipsis">
      ERROR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceRegistrationStatus.REGISTERED" class="md-nav__link">
    <span class="md-ellipsis">
      REGISTERED
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceRegistrationStatus.TIMEOUT" class="md-nav__link">
    <span class="md-ellipsis">
      TIMEOUT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceRegistrationStatus.UNREGISTERED" class="md-nav__link">
    <span class="md-ellipsis">
      UNREGISTERED
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceRegistrationStatus.WAITING" class="md-nav__link">
    <span class="md-ellipsis">
      WAITING
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceRunType" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceRunType
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ServiceRunType">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceRunType.KUBERNETES" class="md-nav__link">
    <span class="md-ellipsis">
      KUBERNETES
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceRunType.MULTIPROCESSING" class="md-nav__link">
    <span class="md-ellipsis">
      MULTIPROCESSING
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceState" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceState
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ServiceState">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceState.ERROR" class="md-nav__link">
    <span class="md-ellipsis">
      ERROR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceState.INITIALIZING" class="md-nav__link">
    <span class="md-ellipsis">
      INITIALIZING
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceState.READY" class="md-nav__link">
    <span class="md-ellipsis">
      READY
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceState.STARTING" class="md-nav__link">
    <span class="md-ellipsis">
      STARTING
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceState.STOPPING" class="md-nav__link">
    <span class="md-ellipsis">
      STOPPING
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceType" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceType
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.StrEnum" class="md-nav__link">
    <span class="md-ellipsis">
      StrEnum
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.Topic" class="md-nav__link">
    <span class="md-ellipsis">
      Topic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonexceptions" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.exceptions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      exceptions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.AIPerfError" class="md-nav__link">
    <span class="md-ellipsis">
      AIPerfError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.AIPerfMetaclassError" class="md-nav__link">
    <span class="md-ellipsis">
      AIPerfMetaclassError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.AIPerfMultiError" class="md-nav__link">
    <span class="md-ellipsis">
      AIPerfMultiError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationClientCreationError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationClientCreationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationClientNotFoundError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationClientNotFoundError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationCreateError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationCreateError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationInitializationError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationInitializationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationNotInitializedError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationNotInitializedError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationPublishError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationPublishError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationPullError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationPullError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationPushError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationPushError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationRequestError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationRequestError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationResponseError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationResponseError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationShutdownError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationShutdownError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationSubscribeError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationSubscribeError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationTypeAlreadyRegisteredError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationTypeAlreadyRegisteredError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationTypeUnknownError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationTypeUnknownError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ConfigError" class="md-nav__link">
    <span class="md-ellipsis">
      ConfigError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ConfigLoadError" class="md-nav__link">
    <span class="md-ellipsis">
      ConfigLoadError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ConfigParseError" class="md-nav__link">
    <span class="md-ellipsis">
      ConfigParseError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ConfigValidationError" class="md-nav__link">
    <span class="md-ellipsis">
      ConfigValidationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.GeneratorConfigurationError" class="md-nav__link">
    <span class="md-ellipsis">
      GeneratorConfigurationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.GeneratorError" class="md-nav__link">
    <span class="md-ellipsis">
      GeneratorError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.GeneratorInitializationError" class="md-nav__link">
    <span class="md-ellipsis">
      GeneratorInitializationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceCleanupError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceCleanupError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceConfigureError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceConfigureError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceHeartbeatError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceHeartbeatError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceInitializationError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceInitializationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceMessageProcessingError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceMessageProcessingError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceMetaclassError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceMetaclassError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceRegistrationError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceRegistrationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceRunError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceRunError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceStartError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceStartError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceStatusError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceStatusError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceStopError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceStopError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.TokenizerError" class="md-nav__link">
    <span class="md-ellipsis">
      TokenizerError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.TokenizerInitializationError" class="md-nav__link">
    <span class="md-ellipsis">
      TokenizerInitializationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonmodels" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models" class="md-nav__link">
    <span class="md-ellipsis">
      models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.Message" class="md-nav__link">
    <span class="md-ellipsis">
      Message
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.Payload" class="md-nav__link">
    <span class="md-ellipsis">
      Payload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.BaseMessage" class="md-nav__link">
    <span class="md-ellipsis">
      BaseMessage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.BasePayload" class="md-nav__link">
    <span class="md-ellipsis">
      BasePayload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.CommandMessage" class="md-nav__link">
    <span class="md-ellipsis">
      CommandMessage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.CommandPayload" class="md-nav__link">
    <span class="md-ellipsis">
      CommandPayload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.CreditDropMessage" class="md-nav__link">
    <span class="md-ellipsis">
      CreditDropMessage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.CreditDropPayload" class="md-nav__link">
    <span class="md-ellipsis">
      CreditDropPayload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.CreditReturnMessage" class="md-nav__link">
    <span class="md-ellipsis">
      CreditReturnMessage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.CreditReturnPayload" class="md-nav__link">
    <span class="md-ellipsis">
      CreditReturnPayload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.DataMessage" class="md-nav__link">
    <span class="md-ellipsis">
      DataMessage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.DataPayload" class="md-nav__link">
    <span class="md-ellipsis">
      DataPayload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.ErrorMessage" class="md-nav__link">
    <span class="md-ellipsis">
      ErrorMessage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.ErrorPayload" class="md-nav__link">
    <span class="md-ellipsis">
      ErrorPayload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.HeartbeatMessage" class="md-nav__link">
    <span class="md-ellipsis">
      HeartbeatMessage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.HeartbeatPayload" class="md-nav__link">
    <span class="md-ellipsis">
      HeartbeatPayload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.RegistrationMessage" class="md-nav__link">
    <span class="md-ellipsis">
      RegistrationMessage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.RegistrationPayload" class="md-nav__link">
    <span class="md-ellipsis">
      RegistrationPayload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.ServiceRunInfo" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceRunInfo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.StatusMessage" class="md-nav__link">
    <span class="md-ellipsis">
      StatusMessage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.StatusPayload" class="md-nav__link">
    <span class="md-ellipsis">
      StatusPayload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.ZMQCommunicationConfig" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQCommunicationConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ZMQCommunicationConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.models.ZMQCommunicationConfig.component_pub_sub_address" class="md-nav__link">
    <span class="md-ellipsis">
      component_pub_sub_address
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.models.ZMQCommunicationConfig.controller_pub_sub_address" class="md-nav__link">
    <span class="md-ellipsis">
      controller_pub_sub_address
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.models.ZMQCommunicationConfig.conversation_data_address" class="md-nav__link">
    <span class="md-ellipsis">
      conversation_data_address
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.models.ZMQCommunicationConfig.credit_drop_address" class="md-nav__link">
    <span class="md-ellipsis">
      credit_drop_address
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.models.ZMQCommunicationConfig.credit_return_address" class="md-nav__link">
    <span class="md-ellipsis">
      credit_return_address
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.models.ZMQCommunicationConfig.inference_push_pull_address" class="md-nav__link">
    <span class="md-ellipsis">
      inference_push_pull_address
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.models.ZMQCommunicationConfig.records_address" class="md-nav__link">
    <span class="md-ellipsis">
      records_address
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.ZMQTCPTransportConfig" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQTCPTransportConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonservicebase_component_service" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.service.base_component_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.service.base_component_service" class="md-nav__link">
    <span class="md-ellipsis">
      base_component_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.service.base_component_service.BaseComponentService" class="md-nav__link">
    <span class="md-ellipsis">
      BaseComponentService
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseComponentService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_component_service.BaseComponentService.required_clients" class="md-nav__link">
    <span class="md-ellipsis">
      required_clients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_component_service.BaseComponentService.create_heartbeat_message" class="md-nav__link">
    <span class="md-ellipsis">
      create_heartbeat_message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_component_service.BaseComponentService.create_registration_message" class="md-nav__link">
    <span class="md-ellipsis">
      create_registration_message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_component_service.BaseComponentService.create_status_message" class="md-nav__link">
    <span class="md-ellipsis">
      create_status_message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_component_service.BaseComponentService.process_command_message" class="md-nav__link">
    <span class="md-ellipsis">
      process_command_message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_component_service.BaseComponentService.register" class="md-nav__link">
    <span class="md-ellipsis">
      register
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_component_service.BaseComponentService.send_heartbeat" class="md-nav__link">
    <span class="md-ellipsis">
      send_heartbeat
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonservicebase_controller_service" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.service.base_controller_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.service.base_controller_service" class="md-nav__link">
    <span class="md-ellipsis">
      base_controller_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.service.base_controller_service.BaseControllerService" class="md-nav__link">
    <span class="md-ellipsis">
      BaseControllerService
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseControllerService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_controller_service.BaseControllerService.required_clients" class="md-nav__link">
    <span class="md-ellipsis">
      required_clients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_controller_service.BaseControllerService.create_command_message" class="md-nav__link">
    <span class="md-ellipsis">
      create_command_message
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonservicebase_service" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.service.base_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service" class="md-nav__link">
    <span class="md-ellipsis">
      base_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService" class="md-nav__link">
    <span class="md-ellipsis">
      BaseService
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.comms" class="md-nav__link">
    <span class="md-ellipsis">
      comms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.is_initialized" class="md-nav__link">
    <span class="md-ellipsis">
      is_initialized
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.is_shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      is_shutdown
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.state" class="md-nav__link">
    <span class="md-ellipsis">
      state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.configure" class="md-nav__link">
    <span class="md-ellipsis">
      configure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.create_message" class="md-nav__link">
    <span class="md-ellipsis">
      create_message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.initialize" class="md-nav__link">
    <span class="md-ellipsis">
      initialize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.run_forever" class="md-nav__link">
    <span class="md-ellipsis">
      run_forever
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.set_state" class="md-nav__link">
    <span class="md-ellipsis">
      set_state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.start" class="md-nav__link">
    <span class="md-ellipsis">
      start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.stop" class="md-nav__link">
    <span class="md-ellipsis">
      stop
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonservicebase_service_interface" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.service.base_service_interface
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service_interface" class="md-nav__link">
    <span class="md-ellipsis">
      base_service_interface
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service_interface.BaseServiceInterface" class="md-nav__link">
    <span class="md-ellipsis">
      BaseServiceInterface
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseServiceInterface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.required_clients" class="md-nav__link">
    <span class="md-ellipsis">
      required_clients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.service_type" class="md-nav__link">
    <span class="md-ellipsis">
      service_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.configure" class="md-nav__link">
    <span class="md-ellipsis">
      configure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.initialize" class="md-nav__link">
    <span class="md-ellipsis">
      initialize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.run_forever" class="md-nav__link">
    <span class="md-ellipsis">
      run_forever
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.set_state" class="md-nav__link">
    <span class="md-ellipsis">
      set_state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.start" class="md-nav__link">
    <span class="md-ellipsis">
      start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.stop" class="md-nav__link">
    <span class="md-ellipsis">
      stop
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonserviceservice_metaclass" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.service.service_metaclass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.service.service_metaclass" class="md-nav__link">
    <span class="md-ellipsis">
      service_metaclass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.service.service_metaclass.ServiceMetaclass" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceMetaclass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommontokenizer" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.tokenizer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.tokenizer" class="md-nav__link">
    <span class="md-ellipsis">
      tokenizer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.tokenizer.Tokenizer" class="md-nav__link">
    <span class="md-ellipsis">
      Tokenizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tokenizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.tokenizer.Tokenizer.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.tokenizer.Tokenizer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.tokenizer.Tokenizer.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.tokenizer.Tokenizer.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.tokenizer.Tokenizer.bos_token_id" class="md-nav__link">
    <span class="md-ellipsis">
      bos_token_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.tokenizer.Tokenizer.decode" class="md-nav__link">
    <span class="md-ellipsis">
      decode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.tokenizer.Tokenizer.encode" class="md-nav__link">
    <span class="md-ellipsis">
      encode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.tokenizer.Tokenizer.from_pretrained" class="md-nav__link">
    <span class="md-ellipsis">
      from_pretrained
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonutils" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.utils" class="md-nav__link">
    <span class="md-ellipsis">
      utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.utils.call_all_functions" class="md-nav__link">
    <span class="md-ellipsis">
      call_all_functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.utils.call_all_functions_self" class="md-nav__link">
    <span class="md-ellipsis">
      call_all_functions_self
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesdatasetdataset_manager" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.dataset.dataset_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.dataset_manager" class="md-nav__link">
    <span class="md-ellipsis">
      dataset_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.dataset_manager.DatasetManager" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DatasetManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.dataset.dataset_manager.DatasetManager.service_type" class="md-nav__link">
    <span class="md-ellipsis">
      service_type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.dataset_manager.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesdatasetgeneratoraudio" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.dataset.generator.audio
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.audio" class="md-nav__link">
    <span class="md-ellipsis">
      audio
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.audio.AudioGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      AudioGenerator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AudioGenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.audio.AudioGenerator.create_synthetic_audio" class="md-nav__link">
    <span class="md-ellipsis">
      create_synthetic_audio
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesdatasetgeneratorimage" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.dataset.generator.image
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.image" class="md-nav__link">
    <span class="md-ellipsis">
      image
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.image.ImageGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      ImageGenerator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ImageGenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.image.ImageGenerator.create_synthetic_image" class="md-nav__link">
    <span class="md-ellipsis">
      create_synthetic_image
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesdatasetgeneratorprompt" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.dataset.generator.prompt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.prompt" class="md-nav__link">
    <span class="md-ellipsis">
      prompt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.prompt.PromptGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      PromptGenerator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PromptGenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.prompt.PromptGenerator.create_prefix_prompts_pool" class="md-nav__link">
    <span class="md-ellipsis">
      create_prefix_prompts_pool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.prompt.PromptGenerator.create_synthetic_prompt" class="md-nav__link">
    <span class="md-ellipsis">
      create_synthetic_prompt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.prompt.PromptGenerator.get_random_prefix_prompt" class="md-nav__link">
    <span class="md-ellipsis">
      get_random_prefix_prompt
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesdatasetgeneratorutils" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.dataset.generator.utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.utils" class="md-nav__link">
    <span class="md-ellipsis">
      utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.utils.encode_image" class="md-nav__link">
    <span class="md-ellipsis">
      encode_image
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicespost_processor_managerpost_processor_manager" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.post_processor_manager.post_processor_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.post_processor_manager.post_processor_manager" class="md-nav__link">
    <span class="md-ellipsis">
      post_processor_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.post_processor_manager.post_processor_manager.PostProcessorManager" class="md-nav__link">
    <span class="md-ellipsis">
      PostProcessorManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PostProcessorManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.post_processor_manager.post_processor_manager.PostProcessorManager.service_type" class="md-nav__link">
    <span class="md-ellipsis">
      service_type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.post_processor_manager.post_processor_manager.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesrecords_managerrecords_manager" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.records_manager.records_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.records_manager.records_manager" class="md-nav__link">
    <span class="md-ellipsis">
      records_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.records_manager.records_manager.RecordsManager" class="md-nav__link">
    <span class="md-ellipsis">
      RecordsManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RecordsManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.records_manager.records_manager.RecordsManager.service_type" class="md-nav__link">
    <span class="md-ellipsis">
      service_type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.records_manager.records_manager.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesservice_managerbase" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.service_manager.base
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.base" class="md-nav__link">
    <span class="md-ellipsis">
      base
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.base.BaseServiceManager" class="md-nav__link">
    <span class="md-ellipsis">
      BaseServiceManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseServiceManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.base.BaseServiceManager.initialize_all_services" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_all_services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.base.BaseServiceManager.stop_all_services" class="md-nav__link">
    <span class="md-ellipsis">
      stop_all_services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.base.BaseServiceManager.wait_for_all_services_registration" class="md-nav__link">
    <span class="md-ellipsis">
      wait_for_all_services_registration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.base.BaseServiceManager.wait_for_all_services_start" class="md-nav__link">
    <span class="md-ellipsis">
      wait_for_all_services_start
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesservice_managerkubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.service_manager.kubernetes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      kubernetes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.kubernetes.KubernetesServiceManager" class="md-nav__link">
    <span class="md-ellipsis">
      KubernetesServiceManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KubernetesServiceManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.kubernetes.KubernetesServiceManager.initialize_all_services" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_all_services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.kubernetes.KubernetesServiceManager.stop_all_services" class="md-nav__link">
    <span class="md-ellipsis">
      stop_all_services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.kubernetes.KubernetesServiceManager.wait_for_all_services_registration" class="md-nav__link">
    <span class="md-ellipsis">
      wait_for_all_services_registration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.kubernetes.KubernetesServiceManager.wait_for_all_services_start" class="md-nav__link">
    <span class="md-ellipsis">
      wait_for_all_services_start
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.kubernetes.ServiceKubernetesRunInfo" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceKubernetesRunInfo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesservice_managermultiprocess" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.service_manager.multiprocess
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.multiprocess" class="md-nav__link">
    <span class="md-ellipsis">
      multiprocess
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.multiprocess.MultiProcessRunInfo" class="md-nav__link">
    <span class="md-ellipsis">
      MultiProcessRunInfo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.multiprocess.MultiProcessServiceManager" class="md-nav__link">
    <span class="md-ellipsis">
      MultiProcessServiceManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MultiProcessServiceManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.multiprocess.MultiProcessServiceManager.initialize_all_services" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_all_services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.multiprocess.MultiProcessServiceManager.stop_all_services" class="md-nav__link">
    <span class="md-ellipsis">
      stop_all_services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.multiprocess.MultiProcessServiceManager.wait_for_all_services_registration" class="md-nav__link">
    <span class="md-ellipsis">
      wait_for_all_services_registration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.multiprocess.MultiProcessServiceManager.wait_for_all_services_start" class="md-nav__link">
    <span class="md-ellipsis">
      wait_for_all_services_start
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicessystem_controllersystem_controller" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.system_controller.system_controller
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.system_controller.system_controller" class="md-nav__link">
    <span class="md-ellipsis">
      system_controller
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.system_controller.system_controller.SystemController" class="md-nav__link">
    <span class="md-ellipsis">
      SystemController
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SystemController">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.system_controller.system_controller.SystemController.service_type" class="md-nav__link">
    <span class="md-ellipsis">
      service_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.system_controller.system_controller.SystemController.send_command_to_service" class="md-nav__link">
    <span class="md-ellipsis">
      send_command_to_service
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.system_controller.system_controller.SystemController.start_all_services" class="md-nav__link">
    <span class="md-ellipsis">
      start_all_services
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.system_controller.system_controller.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicestiming_managertiming_manager" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.timing_manager.timing_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.timing_manager.timing_manager" class="md-nav__link">
    <span class="md-ellipsis">
      timing_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.timing_manager.timing_manager.TimingManager" class="md-nav__link">
    <span class="md-ellipsis">
      TimingManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TimingManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.timing_manager.timing_manager.TimingManager.required_clients" class="md-nav__link">
    <span class="md-ellipsis">
      required_clients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.timing_manager.timing_manager.TimingManager.service_type" class="md-nav__link">
    <span class="md-ellipsis">
      service_type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.timing_manager.timing_manager.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesworkerworker" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.worker.worker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.worker.worker" class="md-nav__link">
    <span class="md-ellipsis">
      worker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.worker.worker.Worker" class="md-nav__link">
    <span class="md-ellipsis">
      Worker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Worker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.worker.worker.Worker.required_clients" class="md-nav__link">
    <span class="md-ellipsis">
      required_clients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.worker.worker.Worker.service_type" class="md-nav__link">
    <span class="md-ellipsis">
      service_type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.worker.worker.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesworker_managerworker_manager" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.worker_manager.worker_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.worker_manager.worker_manager" class="md-nav__link">
    <span class="md-ellipsis">
      worker_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.worker_manager.worker_manager.WorkerManager" class="md-nav__link">
    <span class="md-ellipsis">
      WorkerManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WorkerManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.worker_manager.worker_manager.WorkerManager.service_type" class="md-nav__link">
    <span class="md-ellipsis">
      service_type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.worker_manager.worker_manager.WorkerProcess" class="md-nav__link">
    <span class="md-ellipsis">
      WorkerProcess
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.worker_manager.worker_manager.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsbase_test_component_service" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.base_test_component_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_component_service" class="md-nav__link">
    <span class="md-ellipsis">
      base_test_component_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_component_service.BaseTestComponentService" class="md-nav__link">
    <span class="md-ellipsis">
      BaseTestComponentService
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseTestComponentService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_component_service.BaseTestComponentService.service_class" class="md-nav__link">
    <span class="md-ellipsis">
      service_class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_component_service.BaseTestComponentService.test_service_heartbeat" class="md-nav__link">
    <span class="md-ellipsis">
      test_service_heartbeat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_component_service.BaseTestComponentService.test_service_registration" class="md-nav__link">
    <span class="md-ellipsis">
      test_service_registration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_component_service.BaseTestComponentService.test_service_status_update" class="md-nav__link">
    <span class="md-ellipsis">
      test_service_status_update
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsbase_test_controller_service" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.base_test_controller_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_controller_service" class="md-nav__link">
    <span class="md-ellipsis">
      base_test_controller_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_controller_service.BaseTestControllerService" class="md-nav__link">
    <span class="md-ellipsis">
      BaseTestControllerService
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseTestControllerService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_controller_service.BaseTestControllerService.test_controller_command_publishing" class="md-nav__link">
    <span class="md-ellipsis">
      test_controller_command_publishing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsbase_test_service" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.base_test_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service" class="md-nav__link">
    <span class="md-ellipsis">
      base_test_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService" class="md-nav__link">
    <span class="md-ellipsis">
      BaseTestService
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseTestService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService.initialized_service" class="md-nav__link">
    <span class="md-ellipsis">
      initialized_service
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService.no_sleep" class="md-nav__link">
    <span class="md-ellipsis">
      no_sleep
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService.patch_communication_factory" class="md-nav__link">
    <span class="md-ellipsis">
      patch_communication_factory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService.service_class" class="md-nav__link">
    <span class="md-ellipsis">
      service_class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService.service_config" class="md-nav__link">
    <span class="md-ellipsis">
      service_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService.test_service_initialization" class="md-nav__link">
    <span class="md-ellipsis">
      test_service_initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService.test_service_run_does_not_start" class="md-nav__link">
    <span class="md-ellipsis">
      test_service_run_does_not_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService.test_service_start_stop" class="md-nav__link">
    <span class="md-ellipsis">
      test_service_start_stop
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService.test_service_state_transitions" class="md-nav__link">
    <span class="md-ellipsis">
      test_service_state_transitions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService.uninitialized_service" class="md-nav__link">
    <span class="md-ellipsis">
      uninitialized_service
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestscommsmock_zmq" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.comms.mock_zmq
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.comms.mock_zmq" class="md-nav__link">
    <span class="md-ellipsis">
      mock_zmq
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.comms.mock_zmq.MockCommunicationData" class="md-nav__link">
    <span class="md-ellipsis">
      MockCommunicationData
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.comms.mock_zmq.mock_zmq_communication" class="md-nav__link">
    <span class="md-ellipsis">
      mock_zmq_communication
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestscommstest_zmq_communication" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.comms.test_zmq_communication
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication" class="md-nav__link">
    <span class="md-ellipsis">
      test_zmq_communication
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication" class="md-nav__link">
    <span class="md-ellipsis">
      TestZMQCommunication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TestZMQCommunication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.mock_config" class="md-nav__link">
    <span class="md-ellipsis">
      mock_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_create_clients" class="md-nav__link">
    <span class="md-ellipsis">
      test_create_clients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_initialization" class="md-nav__link">
    <span class="md-ellipsis">
      test_initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_initialization_failure" class="md-nav__link">
    <span class="md-ellipsis">
      test_initialization_failure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_message" class="md-nav__link">
    <span class="md-ellipsis">
      test_message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_publish_message" class="md-nav__link">
    <span class="md-ellipsis">
      test_publish_message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      test_shutdown
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_subscribe_to_topic" class="md-nav__link">
    <span class="md-ellipsis">
      test_subscribe_to_topic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.zmq_communication" class="md-nav__link">
    <span class="md-ellipsis">
      zmq_communication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsconftest" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.conftest
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.conftest" class="md-nav__link">
    <span class="md-ellipsis">
      conftest
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.conftest.mock_communication" class="md-nav__link">
    <span class="md-ellipsis">
      mock_communication
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.conftest.mock_zmq_context" class="md-nav__link">
    <span class="md-ellipsis">
      mock_zmq_context
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.conftest.mock_zmq_socket" class="md-nav__link">
    <span class="md-ellipsis">
      mock_zmq_socket
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsservicestest_dataset_manager" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.services.test_dataset_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_dataset_manager" class="md-nav__link">
    <span class="md-ellipsis">
      test_dataset_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_dataset_manager.DatasetManagerTestConfig" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetManagerTestConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_dataset_manager.TestDatasetManager" class="md-nav__link">
    <span class="md-ellipsis">
      TestDatasetManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TestDatasetManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_dataset_manager.TestDatasetManager.dataset_config" class="md-nav__link">
    <span class="md-ellipsis">
      dataset_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_dataset_manager.TestDatasetManager.service_class" class="md-nav__link">
    <span class="md-ellipsis">
      service_class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_dataset_manager.TestDatasetManager.test_dataset_manager_initialization" class="md-nav__link">
    <span class="md-ellipsis">
      test_dataset_manager_initialization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsservicestest_post_processor_manager" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.services.test_post_processor_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_post_processor_manager" class="md-nav__link">
    <span class="md-ellipsis">
      test_post_processor_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_post_processor_manager.PostProcessorTestConfig" class="md-nav__link">
    <span class="md-ellipsis">
      PostProcessorTestConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_post_processor_manager.TestPostProcessorManager" class="md-nav__link">
    <span class="md-ellipsis">
      TestPostProcessorManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TestPostProcessorManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_post_processor_manager.TestPostProcessorManager.processor_config" class="md-nav__link">
    <span class="md-ellipsis">
      processor_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_post_processor_manager.TestPostProcessorManager.service_class" class="md-nav__link">
    <span class="md-ellipsis">
      service_class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_post_processor_manager.TestPostProcessorManager.test_post_processor_manager_initialization" class="md-nav__link">
    <span class="md-ellipsis">
      test_post_processor_manager_initialization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsservicestest_records_manager" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.services.test_records_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_records_manager" class="md-nav__link">
    <span class="md-ellipsis">
      test_records_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_records_manager.RecordsManagerTestConfig" class="md-nav__link">
    <span class="md-ellipsis">
      RecordsManagerTestConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_records_manager.TestRecordsManager" class="md-nav__link">
    <span class="md-ellipsis">
      TestRecordsManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TestRecordsManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_records_manager.TestRecordsManager.records_config" class="md-nav__link">
    <span class="md-ellipsis">
      records_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_records_manager.TestRecordsManager.service_class" class="md-nav__link">
    <span class="md-ellipsis">
      service_class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_records_manager.TestRecordsManager.test_records_manager_initialization" class="md-nav__link">
    <span class="md-ellipsis">
      test_records_manager_initialization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsservicestest_system_controller" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.services.test_system_controller
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_system_controller" class="md-nav__link">
    <span class="md-ellipsis">
      test_system_controller
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_system_controller.SystemControllerTestConfig" class="md-nav__link">
    <span class="md-ellipsis">
      SystemControllerTestConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_system_controller.TestSystemController" class="md-nav__link">
    <span class="md-ellipsis">
      TestSystemController
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TestSystemController">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_system_controller.TestSystemController.controller_config" class="md-nav__link">
    <span class="md-ellipsis">
      controller_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_system_controller.TestSystemController.service_class" class="md-nav__link">
    <span class="md-ellipsis">
      service_class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_system_controller.TestSystemController.service_manager_with_multiprocess" class="md-nav__link">
    <span class="md-ellipsis">
      service_manager_with_multiprocess
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_system_controller.TestSystemController.test_controller_subscriptions" class="md-nav__link">
    <span class="md-ellipsis">
      test_controller_subscriptions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_system_controller.TestSystemController.test_service_run_does_start" class="md-nav__link">
    <span class="md-ellipsis">
      test_service_run_does_start
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsservicestest_timing_manager" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.services.test_timing_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_timing_manager" class="md-nav__link">
    <span class="md-ellipsis">
      test_timing_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_timing_manager.TestTimingManager" class="md-nav__link">
    <span class="md-ellipsis">
      TestTimingManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TestTimingManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_timing_manager.TestTimingManager.service_class" class="md-nav__link">
    <span class="md-ellipsis">
      service_class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_timing_manager.TestTimingManager.test_timing_manager_initialization" class="md-nav__link">
    <span class="md-ellipsis">
      test_timing_manager_initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_timing_manager.TestTimingManager.timing_config" class="md-nav__link">
    <span class="md-ellipsis">
      timing_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_timing_manager.TimingManagerTestConfig" class="md-nav__link">
    <span class="md-ellipsis">
      TimingManagerTestConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsservicestest_worker" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.services.test_worker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker" class="md-nav__link">
    <span class="md-ellipsis">
      test_worker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker.TestWorker" class="md-nav__link">
    <span class="md-ellipsis">
      TestWorker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TestWorker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker.TestWorker.service_class" class="md-nav__link">
    <span class="md-ellipsis">
      service_class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker.TestWorker.test_worker_initialization" class="md-nav__link">
    <span class="md-ellipsis">
      test_worker_initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker.TestWorker.worker_config" class="md-nav__link">
    <span class="md-ellipsis">
      worker_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker.WorkerTestConfig" class="md-nav__link">
    <span class="md-ellipsis">
      WorkerTestConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsservicestest_worker_manager" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.services.test_worker_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker_manager" class="md-nav__link">
    <span class="md-ellipsis">
      test_worker_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker_manager.TestWorkerManager" class="md-nav__link">
    <span class="md-ellipsis">
      TestWorkerManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TestWorkerManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker_manager.TestWorkerManager.service_class" class="md-nav__link">
    <span class="md-ellipsis">
      service_class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker_manager.TestWorkerManager.test_worker_manager_initialization" class="md-nav__link">
    <span class="md-ellipsis">
      test_worker_manager_initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker_manager.TestWorkerManager.worker_manager_config" class="md-nav__link">
    <span class="md-ellipsis">
      worker_manager_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker_manager.WorkerManagerTestConfig" class="md-nav__link">
    <span class="md-ellipsis">
      WorkerManagerTestConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfteststest_audio_generator" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.test_audio_generator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.test_audio_generator" class="md-nav__link">
    <span class="md-ellipsis">
      test_audio_generator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.test_audio_generator.decode_audio" class="md-nav__link">
    <span class="md-ellipsis">
      decode_audio
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfteststest_image_generator" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.test_image_generator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.test_image_generator" class="md-nav__link">
    <span class="md-ellipsis">
      test_image_generator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfteststest_prompt_generator" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.test_prompt_generator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.test_prompt_generator" class="md-nav__link">
    <span class="md-ellipsis">
      test_prompt_generator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfteststest_tokenizer" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.test_tokenizer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.test_tokenizer" class="md-nav__link">
    <span class="md-ellipsis">
      test_tokenizer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsutilsasync_test_utils" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.utils.async_test_utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.utils.async_test_utils" class="md-nav__link">
    <span class="md-ellipsis">
      async_test_utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.utils.async_test_utils.async_fixture" class="md-nav__link">
    <span class="md-ellipsis">
      async_fixture
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.utils.async_test_utils.async_noop" class="md-nav__link">
    <span class="md-ellipsis">
      async_noop
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#aiperfcli" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.cli
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.cli" class="md-nav__link">
    <span class="md-ellipsis">
      cli
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.cli.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonbase_metaclass" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.base_metaclass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.base_metaclass" class="md-nav__link">
    <span class="md-ellipsis">
      base_metaclass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.base_metaclass.BaseMetaclass" class="md-nav__link">
    <span class="md-ellipsis">
      BaseMetaclass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.base_metaclass.register_metaclass" class="md-nav__link">
    <span class="md-ellipsis">
      register_metaclass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonbootstrap" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.bootstrap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.bootstrap" class="md-nav__link">
    <span class="md-ellipsis">
      bootstrap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.bootstrap.bootstrap_and_run_service" class="md-nav__link">
    <span class="md-ellipsis">
      bootstrap_and_run_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommsbase" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.base
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.base" class="md-nav__link">
    <span class="md-ellipsis">
      base
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication" class="md-nav__link">
    <span class="md-ellipsis">
      BaseCommunication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseCommunication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.is_initialized" class="md-nav__link">
    <span class="md-ellipsis">
      is_initialized
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.is_shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      is_shutdown
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.create_clients" class="md-nav__link">
    <span class="md-ellipsis">
      create_clients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.initialize" class="md-nav__link">
    <span class="md-ellipsis">
      initialize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.publish" class="md-nav__link">
    <span class="md-ellipsis">
      publish
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.pull" class="md-nav__link">
    <span class="md-ellipsis">
      pull
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.push" class="md-nav__link">
    <span class="md-ellipsis">
      push
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.request" class="md-nav__link">
    <span class="md-ellipsis">
      request
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.respond" class="md-nav__link">
    <span class="md-ellipsis">
      respond
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      shutdown
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.BaseCommunication.subscribe" class="md-nav__link">
    <span class="md-ellipsis">
      subscribe
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.CommunicationFactory" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationFactory
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CommunicationFactory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.CommunicationFactory.create_communication" class="md-nav__link">
    <span class="md-ellipsis">
      create_communication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.base.CommunicationFactory.register" class="md-nav__link">
    <span class="md-ellipsis">
      register
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommsclient_enums" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.client_enums
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums" class="md-nav__link">
    <span class="md-ellipsis">
      client_enums
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.ClientType" class="md-nav__link">
    <span class="md-ellipsis">
      ClientType
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.PubClientType" class="md-nav__link">
    <span class="md-ellipsis">
      PubClientType
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PubClientType">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.PubClientType.from_topic" class="md-nav__link">
    <span class="md-ellipsis">
      from_topic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.PullClientType" class="md-nav__link">
    <span class="md-ellipsis">
      PullClientType
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PullClientType">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.PullClientType.from_topic" class="md-nav__link">
    <span class="md-ellipsis">
      from_topic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.PushClientType" class="md-nav__link">
    <span class="md-ellipsis">
      PushClientType
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PushClientType">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.PushClientType.from_topic" class="md-nav__link">
    <span class="md-ellipsis">
      from_topic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.RepClientType" class="md-nav__link">
    <span class="md-ellipsis">
      RepClientType
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RepClientType">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.RepClientType.from_topic" class="md-nav__link">
    <span class="md-ellipsis">
      from_topic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.ReqClientType" class="md-nav__link">
    <span class="md-ellipsis">
      ReqClientType
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ReqClientType">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.ReqClientType.from_topic" class="md-nav__link">
    <span class="md-ellipsis">
      from_topic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.SubClientType" class="md-nav__link">
    <span class="md-ellipsis">
      SubClientType
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SubClientType">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.client_enums.SubClientType.from_topic" class="md-nav__link">
    <span class="md-ellipsis">
      from_topic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommszmqclientsbase" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.zmq.clients.base
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.base" class="md-nav__link">
    <span class="md-ellipsis">
      base
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient" class="md-nav__link">
    <span class="md-ellipsis">
      BaseZMQClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseZMQClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.is_initialized" class="md-nav__link">
    <span class="md-ellipsis">
      is_initialized
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.is_shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      is_shutdown
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.socket" class="md-nav__link">
    <span class="md-ellipsis">
      socket
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.socket_type_name" class="md-nav__link">
    <span class="md-ellipsis">
      socket_type_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.initialize" class="md-nav__link">
    <span class="md-ellipsis">
      initialize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      shutdown
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommszmqclientsmetaclass" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.zmq.clients.metaclass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.metaclass" class="md-nav__link">
    <span class="md-ellipsis">
      metaclass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.metaclass.ZMQClientMetaclass" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQClientMetaclass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommszmqclientspub" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.zmq.clients.pub
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.pub" class="md-nav__link">
    <span class="md-ellipsis">
      pub
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.pub.ZMQPubClient" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQPubClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ZMQPubClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.pub.ZMQPubClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.pub.ZMQPubClient.publish" class="md-nav__link">
    <span class="md-ellipsis">
      publish
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommszmqclientspull" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.zmq.clients.pull
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.pull" class="md-nav__link">
    <span class="md-ellipsis">
      pull
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.pull.ZMQPullClient" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQPullClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ZMQPullClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.pull.ZMQPullClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.pull.ZMQPullClient.pull" class="md-nav__link">
    <span class="md-ellipsis">
      pull
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommszmqclientspush" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.zmq.clients.push
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.push" class="md-nav__link">
    <span class="md-ellipsis">
      push
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.push.ZMQPushClient" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQPushClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ZMQPushClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.push.ZMQPushClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.push.ZMQPushClient.push" class="md-nav__link">
    <span class="md-ellipsis">
      push
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommszmqclientsrep" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.zmq.clients.rep
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.rep" class="md-nav__link">
    <span class="md-ellipsis">
      rep
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.rep.ZMQRepClient" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQRepClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ZMQRepClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.rep.ZMQRepClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.rep.ZMQRepClient.respond" class="md-nav__link">
    <span class="md-ellipsis">
      respond
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.rep.ZMQRepClient.wait_for_request" class="md-nav__link">
    <span class="md-ellipsis">
      wait_for_request
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommszmqclientsreq" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.zmq.clients.req
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.req" class="md-nav__link">
    <span class="md-ellipsis">
      req
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.req.ZMQReqClient" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQReqClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ZMQReqClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.req.ZMQReqClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.req.ZMQReqClient.request" class="md-nav__link">
    <span class="md-ellipsis">
      request
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommszmqclientssub" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.zmq.clients.sub
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.sub" class="md-nav__link">
    <span class="md-ellipsis">
      sub
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.sub.ZMQSubClient" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQSubClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ZMQSubClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.sub.ZMQSubClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.clients.sub.ZMQSubClient.subscribe" class="md-nav__link">
    <span class="md-ellipsis">
      subscribe
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommoncommszmqzmq_comms" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.comms.zmq.zmq_comms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms" class="md-nav__link">
    <span class="md-ellipsis">
      zmq_comms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQCommunication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ZMQCommunication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.context" class="md-nav__link">
    <span class="md-ellipsis">
      context
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.is_initialized" class="md-nav__link">
    <span class="md-ellipsis">
      is_initialized
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.is_shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      is_shutdown
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.create_clients" class="md-nav__link">
    <span class="md-ellipsis">
      create_clients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.initialize" class="md-nav__link">
    <span class="md-ellipsis">
      initialize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.publish" class="md-nav__link">
    <span class="md-ellipsis">
      publish
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.pull" class="md-nav__link">
    <span class="md-ellipsis">
      pull
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.push" class="md-nav__link">
    <span class="md-ellipsis">
      push
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.request" class="md-nav__link">
    <span class="md-ellipsis">
      request
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.respond" class="md-nav__link">
    <span class="md-ellipsis">
      respond
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      shutdown
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.subscribe" class="md-nav__link">
    <span class="md-ellipsis">
      subscribe
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonconfigloader" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.config.loader
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.config.loader" class="md-nav__link">
    <span class="md-ellipsis">
      loader
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.config.loader.load_service_config" class="md-nav__link">
    <span class="md-ellipsis">
      load_service_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonconfigservice_config" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.config.service_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.config.service_config" class="md-nav__link">
    <span class="md-ellipsis">
      service_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.config.service_config.ServiceConfig" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommondecorators" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.decorators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators" class="md-nav__link">
    <span class="md-ellipsis">
      decorators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators.AIPerfHooks" class="md-nav__link">
    <span class="md-ellipsis">
      AIPerfHooks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators.aiperf_task" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf_task
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators.on_cleanup" class="md-nav__link">
    <span class="md-ellipsis">
      on_cleanup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators.on_comms_init" class="md-nav__link">
    <span class="md-ellipsis">
      on_comms_init
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators.on_configure" class="md-nav__link">
    <span class="md-ellipsis">
      on_configure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators.on_init" class="md-nav__link">
    <span class="md-ellipsis">
      on_init
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators.on_run" class="md-nav__link">
    <span class="md-ellipsis">
      on_run
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators.on_set_state" class="md-nav__link">
    <span class="md-ellipsis">
      on_set_state
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators.on_start" class="md-nav__link">
    <span class="md-ellipsis">
      on_start
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.decorators.on_stop" class="md-nav__link">
    <span class="md-ellipsis">
      on_stop
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonenums" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.enums
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums" class="md-nav__link">
    <span class="md-ellipsis">
      enums
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.TopicType" class="md-nav__link">
    <span class="md-ellipsis">
      TopicType
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.CommandType" class="md-nav__link">
    <span class="md-ellipsis">
      CommandType
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.CommunicationBackend" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationBackend
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CommunicationBackend">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.CommunicationBackend.ZMQ_TCP" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQ_TCP
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.DataTopic" class="md-nav__link">
    <span class="md-ellipsis">
      DataTopic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType" class="md-nav__link">
    <span class="md-ellipsis">
      MessageType
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MessageType">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType.COMMAND" class="md-nav__link">
    <span class="md-ellipsis">
      COMMAND
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType.CREDIT_DROP" class="md-nav__link">
    <span class="md-ellipsis">
      CREDIT_DROP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType.CREDIT_RETURN" class="md-nav__link">
    <span class="md-ellipsis">
      CREDIT_RETURN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType.DATA" class="md-nav__link">
    <span class="md-ellipsis">
      DATA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType.ERROR" class="md-nav__link">
    <span class="md-ellipsis">
      ERROR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType.HEARTBEAT" class="md-nav__link">
    <span class="md-ellipsis">
      HEARTBEAT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType.REGISTRATION" class="md-nav__link">
    <span class="md-ellipsis">
      REGISTRATION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType.RESPONSE" class="md-nav__link">
    <span class="md-ellipsis">
      RESPONSE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType.STATUS" class="md-nav__link">
    <span class="md-ellipsis">
      STATUS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.MessageType.UNKNOWN" class="md-nav__link">
    <span class="md-ellipsis">
      UNKNOWN
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceRegistrationStatus" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceRegistrationStatus
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ServiceRegistrationStatus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceRegistrationStatus.ERROR" class="md-nav__link">
    <span class="md-ellipsis">
      ERROR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceRegistrationStatus.REGISTERED" class="md-nav__link">
    <span class="md-ellipsis">
      REGISTERED
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceRegistrationStatus.TIMEOUT" class="md-nav__link">
    <span class="md-ellipsis">
      TIMEOUT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceRegistrationStatus.UNREGISTERED" class="md-nav__link">
    <span class="md-ellipsis">
      UNREGISTERED
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceRegistrationStatus.WAITING" class="md-nav__link">
    <span class="md-ellipsis">
      WAITING
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceRunType" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceRunType
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ServiceRunType">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceRunType.KUBERNETES" class="md-nav__link">
    <span class="md-ellipsis">
      KUBERNETES
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceRunType.MULTIPROCESSING" class="md-nav__link">
    <span class="md-ellipsis">
      MULTIPROCESSING
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceState" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceState
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ServiceState">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceState.ERROR" class="md-nav__link">
    <span class="md-ellipsis">
      ERROR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceState.INITIALIZING" class="md-nav__link">
    <span class="md-ellipsis">
      INITIALIZING
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceState.READY" class="md-nav__link">
    <span class="md-ellipsis">
      READY
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceState.STARTING" class="md-nav__link">
    <span class="md-ellipsis">
      STARTING
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceState.STOPPING" class="md-nav__link">
    <span class="md-ellipsis">
      STOPPING
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.ServiceType" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceType
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.StrEnum" class="md-nav__link">
    <span class="md-ellipsis">
      StrEnum
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.enums.Topic" class="md-nav__link">
    <span class="md-ellipsis">
      Topic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonexceptions" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.exceptions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      exceptions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.AIPerfError" class="md-nav__link">
    <span class="md-ellipsis">
      AIPerfError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.AIPerfMetaclassError" class="md-nav__link">
    <span class="md-ellipsis">
      AIPerfMetaclassError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.AIPerfMultiError" class="md-nav__link">
    <span class="md-ellipsis">
      AIPerfMultiError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationClientCreationError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationClientCreationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationClientNotFoundError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationClientNotFoundError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationCreateError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationCreateError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationInitializationError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationInitializationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationNotInitializedError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationNotInitializedError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationPublishError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationPublishError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationPullError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationPullError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationPushError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationPushError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationRequestError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationRequestError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationResponseError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationResponseError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationShutdownError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationShutdownError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationSubscribeError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationSubscribeError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationTypeAlreadyRegisteredError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationTypeAlreadyRegisteredError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.CommunicationTypeUnknownError" class="md-nav__link">
    <span class="md-ellipsis">
      CommunicationTypeUnknownError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ConfigError" class="md-nav__link">
    <span class="md-ellipsis">
      ConfigError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ConfigLoadError" class="md-nav__link">
    <span class="md-ellipsis">
      ConfigLoadError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ConfigParseError" class="md-nav__link">
    <span class="md-ellipsis">
      ConfigParseError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ConfigValidationError" class="md-nav__link">
    <span class="md-ellipsis">
      ConfigValidationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.GeneratorConfigurationError" class="md-nav__link">
    <span class="md-ellipsis">
      GeneratorConfigurationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.GeneratorError" class="md-nav__link">
    <span class="md-ellipsis">
      GeneratorError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.GeneratorInitializationError" class="md-nav__link">
    <span class="md-ellipsis">
      GeneratorInitializationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceCleanupError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceCleanupError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceConfigureError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceConfigureError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceHeartbeatError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceHeartbeatError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceInitializationError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceInitializationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceMessageProcessingError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceMessageProcessingError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceMetaclassError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceMetaclassError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceRegistrationError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceRegistrationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceRunError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceRunError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceStartError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceStartError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceStatusError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceStatusError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.ServiceStopError" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceStopError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.TokenizerError" class="md-nav__link">
    <span class="md-ellipsis">
      TokenizerError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.exceptions.TokenizerInitializationError" class="md-nav__link">
    <span class="md-ellipsis">
      TokenizerInitializationError
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonmodels" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models" class="md-nav__link">
    <span class="md-ellipsis">
      models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.Message" class="md-nav__link">
    <span class="md-ellipsis">
      Message
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.Payload" class="md-nav__link">
    <span class="md-ellipsis">
      Payload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.BaseMessage" class="md-nav__link">
    <span class="md-ellipsis">
      BaseMessage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.BasePayload" class="md-nav__link">
    <span class="md-ellipsis">
      BasePayload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.CommandMessage" class="md-nav__link">
    <span class="md-ellipsis">
      CommandMessage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.CommandPayload" class="md-nav__link">
    <span class="md-ellipsis">
      CommandPayload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.CreditDropMessage" class="md-nav__link">
    <span class="md-ellipsis">
      CreditDropMessage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.CreditDropPayload" class="md-nav__link">
    <span class="md-ellipsis">
      CreditDropPayload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.CreditReturnMessage" class="md-nav__link">
    <span class="md-ellipsis">
      CreditReturnMessage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.CreditReturnPayload" class="md-nav__link">
    <span class="md-ellipsis">
      CreditReturnPayload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.DataMessage" class="md-nav__link">
    <span class="md-ellipsis">
      DataMessage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.DataPayload" class="md-nav__link">
    <span class="md-ellipsis">
      DataPayload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.ErrorMessage" class="md-nav__link">
    <span class="md-ellipsis">
      ErrorMessage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.ErrorPayload" class="md-nav__link">
    <span class="md-ellipsis">
      ErrorPayload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.HeartbeatMessage" class="md-nav__link">
    <span class="md-ellipsis">
      HeartbeatMessage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.HeartbeatPayload" class="md-nav__link">
    <span class="md-ellipsis">
      HeartbeatPayload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.RegistrationMessage" class="md-nav__link">
    <span class="md-ellipsis">
      RegistrationMessage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.RegistrationPayload" class="md-nav__link">
    <span class="md-ellipsis">
      RegistrationPayload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.ServiceRunInfo" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceRunInfo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.StatusMessage" class="md-nav__link">
    <span class="md-ellipsis">
      StatusMessage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.StatusPayload" class="md-nav__link">
    <span class="md-ellipsis">
      StatusPayload
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.ZMQCommunicationConfig" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQCommunicationConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ZMQCommunicationConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.models.ZMQCommunicationConfig.component_pub_sub_address" class="md-nav__link">
    <span class="md-ellipsis">
      component_pub_sub_address
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.models.ZMQCommunicationConfig.controller_pub_sub_address" class="md-nav__link">
    <span class="md-ellipsis">
      controller_pub_sub_address
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.models.ZMQCommunicationConfig.conversation_data_address" class="md-nav__link">
    <span class="md-ellipsis">
      conversation_data_address
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.models.ZMQCommunicationConfig.credit_drop_address" class="md-nav__link">
    <span class="md-ellipsis">
      credit_drop_address
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.models.ZMQCommunicationConfig.credit_return_address" class="md-nav__link">
    <span class="md-ellipsis">
      credit_return_address
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.models.ZMQCommunicationConfig.inference_push_pull_address" class="md-nav__link">
    <span class="md-ellipsis">
      inference_push_pull_address
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.models.ZMQCommunicationConfig.records_address" class="md-nav__link">
    <span class="md-ellipsis">
      records_address
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.models.ZMQTCPTransportConfig" class="md-nav__link">
    <span class="md-ellipsis">
      ZMQTCPTransportConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonservicebase_component_service" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.service.base_component_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.service.base_component_service" class="md-nav__link">
    <span class="md-ellipsis">
      base_component_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.service.base_component_service.BaseComponentService" class="md-nav__link">
    <span class="md-ellipsis">
      BaseComponentService
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseComponentService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_component_service.BaseComponentService.required_clients" class="md-nav__link">
    <span class="md-ellipsis">
      required_clients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_component_service.BaseComponentService.create_heartbeat_message" class="md-nav__link">
    <span class="md-ellipsis">
      create_heartbeat_message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_component_service.BaseComponentService.create_registration_message" class="md-nav__link">
    <span class="md-ellipsis">
      create_registration_message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_component_service.BaseComponentService.create_status_message" class="md-nav__link">
    <span class="md-ellipsis">
      create_status_message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_component_service.BaseComponentService.process_command_message" class="md-nav__link">
    <span class="md-ellipsis">
      process_command_message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_component_service.BaseComponentService.register" class="md-nav__link">
    <span class="md-ellipsis">
      register
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_component_service.BaseComponentService.send_heartbeat" class="md-nav__link">
    <span class="md-ellipsis">
      send_heartbeat
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonservicebase_controller_service" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.service.base_controller_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.service.base_controller_service" class="md-nav__link">
    <span class="md-ellipsis">
      base_controller_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.service.base_controller_service.BaseControllerService" class="md-nav__link">
    <span class="md-ellipsis">
      BaseControllerService
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseControllerService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_controller_service.BaseControllerService.required_clients" class="md-nav__link">
    <span class="md-ellipsis">
      required_clients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_controller_service.BaseControllerService.create_command_message" class="md-nav__link">
    <span class="md-ellipsis">
      create_command_message
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonservicebase_service" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.service.base_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service" class="md-nav__link">
    <span class="md-ellipsis">
      base_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService" class="md-nav__link">
    <span class="md-ellipsis">
      BaseService
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.comms" class="md-nav__link">
    <span class="md-ellipsis">
      comms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.is_initialized" class="md-nav__link">
    <span class="md-ellipsis">
      is_initialized
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.is_shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      is_shutdown
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.state" class="md-nav__link">
    <span class="md-ellipsis">
      state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.configure" class="md-nav__link">
    <span class="md-ellipsis">
      configure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.create_message" class="md-nav__link">
    <span class="md-ellipsis">
      create_message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.initialize" class="md-nav__link">
    <span class="md-ellipsis">
      initialize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.run_forever" class="md-nav__link">
    <span class="md-ellipsis">
      run_forever
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.set_state" class="md-nav__link">
    <span class="md-ellipsis">
      set_state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.start" class="md-nav__link">
    <span class="md-ellipsis">
      start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service.BaseService.stop" class="md-nav__link">
    <span class="md-ellipsis">
      stop
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonservicebase_service_interface" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.service.base_service_interface
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service_interface" class="md-nav__link">
    <span class="md-ellipsis">
      base_service_interface
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service_interface.BaseServiceInterface" class="md-nav__link">
    <span class="md-ellipsis">
      BaseServiceInterface
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseServiceInterface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.required_clients" class="md-nav__link">
    <span class="md-ellipsis">
      required_clients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.service_type" class="md-nav__link">
    <span class="md-ellipsis">
      service_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.configure" class="md-nav__link">
    <span class="md-ellipsis">
      configure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.initialize" class="md-nav__link">
    <span class="md-ellipsis">
      initialize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.run_forever" class="md-nav__link">
    <span class="md-ellipsis">
      run_forever
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.set_state" class="md-nav__link">
    <span class="md-ellipsis">
      set_state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.start" class="md-nav__link">
    <span class="md-ellipsis">
      start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.stop" class="md-nav__link">
    <span class="md-ellipsis">
      stop
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonserviceservice_metaclass" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.service.service_metaclass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.service.service_metaclass" class="md-nav__link">
    <span class="md-ellipsis">
      service_metaclass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.service.service_metaclass.ServiceMetaclass" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceMetaclass
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommontokenizer" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.tokenizer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.tokenizer" class="md-nav__link">
    <span class="md-ellipsis">
      tokenizer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.tokenizer.Tokenizer" class="md-nav__link">
    <span class="md-ellipsis">
      Tokenizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tokenizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.common.tokenizer.Tokenizer.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.tokenizer.Tokenizer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.tokenizer.Tokenizer.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.tokenizer.Tokenizer.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.tokenizer.Tokenizer.bos_token_id" class="md-nav__link">
    <span class="md-ellipsis">
      bos_token_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.tokenizer.Tokenizer.decode" class="md-nav__link">
    <span class="md-ellipsis">
      decode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.tokenizer.Tokenizer.encode" class="md-nav__link">
    <span class="md-ellipsis">
      encode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.common.tokenizer.Tokenizer.from_pretrained" class="md-nav__link">
    <span class="md-ellipsis">
      from_pretrained
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfcommonutils" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.common.utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.utils" class="md-nav__link">
    <span class="md-ellipsis">
      utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.utils.call_all_functions" class="md-nav__link">
    <span class="md-ellipsis">
      call_all_functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.common.utils.call_all_functions_self" class="md-nav__link">
    <span class="md-ellipsis">
      call_all_functions_self
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesdatasetdataset_manager" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.dataset.dataset_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.dataset_manager" class="md-nav__link">
    <span class="md-ellipsis">
      dataset_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.dataset_manager.DatasetManager" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DatasetManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.dataset.dataset_manager.DatasetManager.service_type" class="md-nav__link">
    <span class="md-ellipsis">
      service_type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.dataset_manager.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesdatasetgeneratoraudio" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.dataset.generator.audio
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.audio" class="md-nav__link">
    <span class="md-ellipsis">
      audio
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.audio.AudioGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      AudioGenerator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AudioGenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.audio.AudioGenerator.create_synthetic_audio" class="md-nav__link">
    <span class="md-ellipsis">
      create_synthetic_audio
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesdatasetgeneratorimage" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.dataset.generator.image
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.image" class="md-nav__link">
    <span class="md-ellipsis">
      image
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.image.ImageGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      ImageGenerator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ImageGenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.image.ImageGenerator.create_synthetic_image" class="md-nav__link">
    <span class="md-ellipsis">
      create_synthetic_image
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesdatasetgeneratorprompt" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.dataset.generator.prompt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.prompt" class="md-nav__link">
    <span class="md-ellipsis">
      prompt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.prompt.PromptGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      PromptGenerator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PromptGenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.prompt.PromptGenerator.create_prefix_prompts_pool" class="md-nav__link">
    <span class="md-ellipsis">
      create_prefix_prompts_pool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.prompt.PromptGenerator.create_synthetic_prompt" class="md-nav__link">
    <span class="md-ellipsis">
      create_synthetic_prompt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.prompt.PromptGenerator.get_random_prefix_prompt" class="md-nav__link">
    <span class="md-ellipsis">
      get_random_prefix_prompt
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesdatasetgeneratorutils" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.dataset.generator.utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.utils" class="md-nav__link">
    <span class="md-ellipsis">
      utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.dataset.generator.utils.encode_image" class="md-nav__link">
    <span class="md-ellipsis">
      encode_image
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicespost_processor_managerpost_processor_manager" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.post_processor_manager.post_processor_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.post_processor_manager.post_processor_manager" class="md-nav__link">
    <span class="md-ellipsis">
      post_processor_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.post_processor_manager.post_processor_manager.PostProcessorManager" class="md-nav__link">
    <span class="md-ellipsis">
      PostProcessorManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PostProcessorManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.post_processor_manager.post_processor_manager.PostProcessorManager.service_type" class="md-nav__link">
    <span class="md-ellipsis">
      service_type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.post_processor_manager.post_processor_manager.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesrecords_managerrecords_manager" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.records_manager.records_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.records_manager.records_manager" class="md-nav__link">
    <span class="md-ellipsis">
      records_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.records_manager.records_manager.RecordsManager" class="md-nav__link">
    <span class="md-ellipsis">
      RecordsManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RecordsManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.records_manager.records_manager.RecordsManager.service_type" class="md-nav__link">
    <span class="md-ellipsis">
      service_type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.records_manager.records_manager.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesservice_managerbase" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.service_manager.base
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.base" class="md-nav__link">
    <span class="md-ellipsis">
      base
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.base.BaseServiceManager" class="md-nav__link">
    <span class="md-ellipsis">
      BaseServiceManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseServiceManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.base.BaseServiceManager.initialize_all_services" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_all_services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.base.BaseServiceManager.stop_all_services" class="md-nav__link">
    <span class="md-ellipsis">
      stop_all_services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.base.BaseServiceManager.wait_for_all_services_registration" class="md-nav__link">
    <span class="md-ellipsis">
      wait_for_all_services_registration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.base.BaseServiceManager.wait_for_all_services_start" class="md-nav__link">
    <span class="md-ellipsis">
      wait_for_all_services_start
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesservice_managerkubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.service_manager.kubernetes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      kubernetes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.kubernetes.KubernetesServiceManager" class="md-nav__link">
    <span class="md-ellipsis">
      KubernetesServiceManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KubernetesServiceManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.kubernetes.KubernetesServiceManager.initialize_all_services" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_all_services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.kubernetes.KubernetesServiceManager.stop_all_services" class="md-nav__link">
    <span class="md-ellipsis">
      stop_all_services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.kubernetes.KubernetesServiceManager.wait_for_all_services_registration" class="md-nav__link">
    <span class="md-ellipsis">
      wait_for_all_services_registration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.kubernetes.KubernetesServiceManager.wait_for_all_services_start" class="md-nav__link">
    <span class="md-ellipsis">
      wait_for_all_services_start
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.kubernetes.ServiceKubernetesRunInfo" class="md-nav__link">
    <span class="md-ellipsis">
      ServiceKubernetesRunInfo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesservice_managermultiprocess" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.service_manager.multiprocess
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.multiprocess" class="md-nav__link">
    <span class="md-ellipsis">
      multiprocess
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.multiprocess.MultiProcessRunInfo" class="md-nav__link">
    <span class="md-ellipsis">
      MultiProcessRunInfo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.multiprocess.MultiProcessServiceManager" class="md-nav__link">
    <span class="md-ellipsis">
      MultiProcessServiceManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MultiProcessServiceManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.multiprocess.MultiProcessServiceManager.initialize_all_services" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_all_services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.multiprocess.MultiProcessServiceManager.stop_all_services" class="md-nav__link">
    <span class="md-ellipsis">
      stop_all_services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.multiprocess.MultiProcessServiceManager.wait_for_all_services_registration" class="md-nav__link">
    <span class="md-ellipsis">
      wait_for_all_services_registration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.service_manager.multiprocess.MultiProcessServiceManager.wait_for_all_services_start" class="md-nav__link">
    <span class="md-ellipsis">
      wait_for_all_services_start
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicessystem_controllersystem_controller" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.system_controller.system_controller
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.system_controller.system_controller" class="md-nav__link">
    <span class="md-ellipsis">
      system_controller
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.system_controller.system_controller.SystemController" class="md-nav__link">
    <span class="md-ellipsis">
      SystemController
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SystemController">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.system_controller.system_controller.SystemController.service_type" class="md-nav__link">
    <span class="md-ellipsis">
      service_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.system_controller.system_controller.SystemController.send_command_to_service" class="md-nav__link">
    <span class="md-ellipsis">
      send_command_to_service
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.system_controller.system_controller.SystemController.start_all_services" class="md-nav__link">
    <span class="md-ellipsis">
      start_all_services
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.system_controller.system_controller.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicestiming_managertiming_manager" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.timing_manager.timing_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.timing_manager.timing_manager" class="md-nav__link">
    <span class="md-ellipsis">
      timing_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.timing_manager.timing_manager.TimingManager" class="md-nav__link">
    <span class="md-ellipsis">
      TimingManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TimingManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.timing_manager.timing_manager.TimingManager.required_clients" class="md-nav__link">
    <span class="md-ellipsis">
      required_clients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.timing_manager.timing_manager.TimingManager.service_type" class="md-nav__link">
    <span class="md-ellipsis">
      service_type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.timing_manager.timing_manager.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesworkerworker" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.worker.worker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.worker.worker" class="md-nav__link">
    <span class="md-ellipsis">
      worker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.worker.worker.Worker" class="md-nav__link">
    <span class="md-ellipsis">
      Worker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Worker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.worker.worker.Worker.required_clients" class="md-nav__link">
    <span class="md-ellipsis">
      required_clients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.services.worker.worker.Worker.service_type" class="md-nav__link">
    <span class="md-ellipsis">
      service_type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.worker.worker.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfservicesworker_managerworker_manager" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.services.worker_manager.worker_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.worker_manager.worker_manager" class="md-nav__link">
    <span class="md-ellipsis">
      worker_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.worker_manager.worker_manager.WorkerManager" class="md-nav__link">
    <span class="md-ellipsis">
      WorkerManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WorkerManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.services.worker_manager.worker_manager.WorkerManager.service_type" class="md-nav__link">
    <span class="md-ellipsis">
      service_type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.worker_manager.worker_manager.WorkerProcess" class="md-nav__link">
    <span class="md-ellipsis">
      WorkerProcess
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.services.worker_manager.worker_manager.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsbase_test_component_service" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.base_test_component_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_component_service" class="md-nav__link">
    <span class="md-ellipsis">
      base_test_component_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_component_service.BaseTestComponentService" class="md-nav__link">
    <span class="md-ellipsis">
      BaseTestComponentService
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseTestComponentService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_component_service.BaseTestComponentService.service_class" class="md-nav__link">
    <span class="md-ellipsis">
      service_class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_component_service.BaseTestComponentService.test_service_heartbeat" class="md-nav__link">
    <span class="md-ellipsis">
      test_service_heartbeat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_component_service.BaseTestComponentService.test_service_registration" class="md-nav__link">
    <span class="md-ellipsis">
      test_service_registration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_component_service.BaseTestComponentService.test_service_status_update" class="md-nav__link">
    <span class="md-ellipsis">
      test_service_status_update
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsbase_test_controller_service" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.base_test_controller_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_controller_service" class="md-nav__link">
    <span class="md-ellipsis">
      base_test_controller_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_controller_service.BaseTestControllerService" class="md-nav__link">
    <span class="md-ellipsis">
      BaseTestControllerService
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseTestControllerService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_controller_service.BaseTestControllerService.test_controller_command_publishing" class="md-nav__link">
    <span class="md-ellipsis">
      test_controller_command_publishing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsbase_test_service" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.base_test_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service" class="md-nav__link">
    <span class="md-ellipsis">
      base_test_service
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService" class="md-nav__link">
    <span class="md-ellipsis">
      BaseTestService
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseTestService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService.initialized_service" class="md-nav__link">
    <span class="md-ellipsis">
      initialized_service
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService.no_sleep" class="md-nav__link">
    <span class="md-ellipsis">
      no_sleep
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService.patch_communication_factory" class="md-nav__link">
    <span class="md-ellipsis">
      patch_communication_factory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService.service_class" class="md-nav__link">
    <span class="md-ellipsis">
      service_class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService.service_config" class="md-nav__link">
    <span class="md-ellipsis">
      service_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService.test_service_initialization" class="md-nav__link">
    <span class="md-ellipsis">
      test_service_initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService.test_service_run_does_not_start" class="md-nav__link">
    <span class="md-ellipsis">
      test_service_run_does_not_start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService.test_service_start_stop" class="md-nav__link">
    <span class="md-ellipsis">
      test_service_start_stop
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService.test_service_state_transitions" class="md-nav__link">
    <span class="md-ellipsis">
      test_service_state_transitions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.base_test_service.BaseTestService.uninitialized_service" class="md-nav__link">
    <span class="md-ellipsis">
      uninitialized_service
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestscommsmock_zmq" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.comms.mock_zmq
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.comms.mock_zmq" class="md-nav__link">
    <span class="md-ellipsis">
      mock_zmq
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.comms.mock_zmq.MockCommunicationData" class="md-nav__link">
    <span class="md-ellipsis">
      MockCommunicationData
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.comms.mock_zmq.mock_zmq_communication" class="md-nav__link">
    <span class="md-ellipsis">
      mock_zmq_communication
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestscommstest_zmq_communication" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.comms.test_zmq_communication
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication" class="md-nav__link">
    <span class="md-ellipsis">
      test_zmq_communication
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication" class="md-nav__link">
    <span class="md-ellipsis">
      TestZMQCommunication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TestZMQCommunication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.mock_config" class="md-nav__link">
    <span class="md-ellipsis">
      mock_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_create_clients" class="md-nav__link">
    <span class="md-ellipsis">
      test_create_clients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_initialization" class="md-nav__link">
    <span class="md-ellipsis">
      test_initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_initialization_failure" class="md-nav__link">
    <span class="md-ellipsis">
      test_initialization_failure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_message" class="md-nav__link">
    <span class="md-ellipsis">
      test_message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_publish_message" class="md-nav__link">
    <span class="md-ellipsis">
      test_publish_message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_shutdown" class="md-nav__link">
    <span class="md-ellipsis">
      test_shutdown
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_subscribe_to_topic" class="md-nav__link">
    <span class="md-ellipsis">
      test_subscribe_to_topic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.zmq_communication" class="md-nav__link">
    <span class="md-ellipsis">
      zmq_communication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsconftest" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.conftest
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.conftest" class="md-nav__link">
    <span class="md-ellipsis">
      conftest
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.conftest.mock_communication" class="md-nav__link">
    <span class="md-ellipsis">
      mock_communication
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.conftest.mock_zmq_context" class="md-nav__link">
    <span class="md-ellipsis">
      mock_zmq_context
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.conftest.mock_zmq_socket" class="md-nav__link">
    <span class="md-ellipsis">
      mock_zmq_socket
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsservicestest_dataset_manager" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.services.test_dataset_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_dataset_manager" class="md-nav__link">
    <span class="md-ellipsis">
      test_dataset_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_dataset_manager.DatasetManagerTestConfig" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetManagerTestConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_dataset_manager.TestDatasetManager" class="md-nav__link">
    <span class="md-ellipsis">
      TestDatasetManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TestDatasetManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_dataset_manager.TestDatasetManager.dataset_config" class="md-nav__link">
    <span class="md-ellipsis">
      dataset_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_dataset_manager.TestDatasetManager.service_class" class="md-nav__link">
    <span class="md-ellipsis">
      service_class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_dataset_manager.TestDatasetManager.test_dataset_manager_initialization" class="md-nav__link">
    <span class="md-ellipsis">
      test_dataset_manager_initialization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsservicestest_post_processor_manager" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.services.test_post_processor_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_post_processor_manager" class="md-nav__link">
    <span class="md-ellipsis">
      test_post_processor_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_post_processor_manager.PostProcessorTestConfig" class="md-nav__link">
    <span class="md-ellipsis">
      PostProcessorTestConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_post_processor_manager.TestPostProcessorManager" class="md-nav__link">
    <span class="md-ellipsis">
      TestPostProcessorManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TestPostProcessorManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_post_processor_manager.TestPostProcessorManager.processor_config" class="md-nav__link">
    <span class="md-ellipsis">
      processor_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_post_processor_manager.TestPostProcessorManager.service_class" class="md-nav__link">
    <span class="md-ellipsis">
      service_class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_post_processor_manager.TestPostProcessorManager.test_post_processor_manager_initialization" class="md-nav__link">
    <span class="md-ellipsis">
      test_post_processor_manager_initialization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsservicestest_records_manager" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.services.test_records_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_records_manager" class="md-nav__link">
    <span class="md-ellipsis">
      test_records_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_records_manager.RecordsManagerTestConfig" class="md-nav__link">
    <span class="md-ellipsis">
      RecordsManagerTestConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_records_manager.TestRecordsManager" class="md-nav__link">
    <span class="md-ellipsis">
      TestRecordsManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TestRecordsManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_records_manager.TestRecordsManager.records_config" class="md-nav__link">
    <span class="md-ellipsis">
      records_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_records_manager.TestRecordsManager.service_class" class="md-nav__link">
    <span class="md-ellipsis">
      service_class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_records_manager.TestRecordsManager.test_records_manager_initialization" class="md-nav__link">
    <span class="md-ellipsis">
      test_records_manager_initialization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsservicestest_system_controller" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.services.test_system_controller
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_system_controller" class="md-nav__link">
    <span class="md-ellipsis">
      test_system_controller
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_system_controller.SystemControllerTestConfig" class="md-nav__link">
    <span class="md-ellipsis">
      SystemControllerTestConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_system_controller.TestSystemController" class="md-nav__link">
    <span class="md-ellipsis">
      TestSystemController
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TestSystemController">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_system_controller.TestSystemController.controller_config" class="md-nav__link">
    <span class="md-ellipsis">
      controller_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_system_controller.TestSystemController.service_class" class="md-nav__link">
    <span class="md-ellipsis">
      service_class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_system_controller.TestSystemController.service_manager_with_multiprocess" class="md-nav__link">
    <span class="md-ellipsis">
      service_manager_with_multiprocess
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_system_controller.TestSystemController.test_controller_subscriptions" class="md-nav__link">
    <span class="md-ellipsis">
      test_controller_subscriptions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_system_controller.TestSystemController.test_service_run_does_start" class="md-nav__link">
    <span class="md-ellipsis">
      test_service_run_does_start
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsservicestest_timing_manager" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.services.test_timing_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_timing_manager" class="md-nav__link">
    <span class="md-ellipsis">
      test_timing_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_timing_manager.TestTimingManager" class="md-nav__link">
    <span class="md-ellipsis">
      TestTimingManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TestTimingManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_timing_manager.TestTimingManager.service_class" class="md-nav__link">
    <span class="md-ellipsis">
      service_class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_timing_manager.TestTimingManager.test_timing_manager_initialization" class="md-nav__link">
    <span class="md-ellipsis">
      test_timing_manager_initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_timing_manager.TestTimingManager.timing_config" class="md-nav__link">
    <span class="md-ellipsis">
      timing_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_timing_manager.TimingManagerTestConfig" class="md-nav__link">
    <span class="md-ellipsis">
      TimingManagerTestConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsservicestest_worker" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.services.test_worker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker" class="md-nav__link">
    <span class="md-ellipsis">
      test_worker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker.TestWorker" class="md-nav__link">
    <span class="md-ellipsis">
      TestWorker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TestWorker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker.TestWorker.service_class" class="md-nav__link">
    <span class="md-ellipsis">
      service_class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker.TestWorker.test_worker_initialization" class="md-nav__link">
    <span class="md-ellipsis">
      test_worker_initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker.TestWorker.worker_config" class="md-nav__link">
    <span class="md-ellipsis">
      worker_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker.WorkerTestConfig" class="md-nav__link">
    <span class="md-ellipsis">
      WorkerTestConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsservicestest_worker_manager" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.services.test_worker_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker_manager" class="md-nav__link">
    <span class="md-ellipsis">
      test_worker_manager
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker_manager.TestWorkerManager" class="md-nav__link">
    <span class="md-ellipsis">
      TestWorkerManager
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TestWorkerManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker_manager.TestWorkerManager.service_class" class="md-nav__link">
    <span class="md-ellipsis">
      service_class
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker_manager.TestWorkerManager.test_worker_manager_initialization" class="md-nav__link">
    <span class="md-ellipsis">
      test_worker_manager_initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker_manager.TestWorkerManager.worker_manager_config" class="md-nav__link">
    <span class="md-ellipsis">
      worker_manager_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.services.test_worker_manager.WorkerManagerTestConfig" class="md-nav__link">
    <span class="md-ellipsis">
      WorkerManagerTestConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfteststest_audio_generator" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.test_audio_generator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.test_audio_generator" class="md-nav__link">
    <span class="md-ellipsis">
      test_audio_generator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.test_audio_generator.decode_audio" class="md-nav__link">
    <span class="md-ellipsis">
      decode_audio
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfteststest_image_generator" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.test_image_generator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.test_image_generator" class="md-nav__link">
    <span class="md-ellipsis">
      test_image_generator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfteststest_prompt_generator" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.test_prompt_generator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.test_prompt_generator" class="md-nav__link">
    <span class="md-ellipsis">
      test_prompt_generator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperfteststest_tokenizer" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.test_tokenizer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.test_tokenizer" class="md-nav__link">
    <span class="md-ellipsis">
      test_tokenizer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperftestsutilsasync_test_utils" class="md-nav__link">
    <span class="md-ellipsis">
      aiperf.tests.utils.async_test_utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.utils.async_test_utils" class="md-nav__link">
    <span class="md-ellipsis">
      async_test_utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.utils.async_test_utils.async_fixture" class="md-nav__link">
    <span class="md-ellipsis">
      async_fixture
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aiperf.tests.utils.async_test_utils.async_noop" class="md-nav__link">
    <span class="md-ellipsis">
      async_noop
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h1>
<p>This page contains the API documentation for all Python modules in the codebase (excluding <strong>init</strong>.py files).</p>
<h2 id="aiperfcli">aiperf.cli<a class="headerlink" href="#aiperfcli" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.cli"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="aiperf.cli.main" class="doc doc-heading">
            <code class=" language-python"><span class="n">main</span><span class="p">()</span></code>

<a href="#aiperf.cli.main" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Main entry point for the AIPerf system.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/cli.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Main entry point for the AIPerf system.&quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;AIPerf Benchmarking System&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--config&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path to configuration file&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--log-level&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;INFO&quot;</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DEBUG&quot;</span><span class="p">,</span> <span class="s2">&quot;INFO&quot;</span><span class="p">,</span> <span class="s2">&quot;WARNING&quot;</span><span class="p">,</span> <span class="s2">&quot;ERROR&quot;</span><span class="p">,</span> <span class="s2">&quot;CRITICAL&quot;</span><span class="p">],</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Set the logging level&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--run-type&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;process&quot;</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;process&quot;</span><span class="p">,</span> <span class="s2">&quot;k8s&quot;</span><span class="p">],</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Process manager backend to use &quot;</span>
        <span class="s2">&quot;(multiprocessing: &#39;process&#39;, or kubernetes: &#39;k8s&#39;)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="c1"># Set logging level for the root logger (affects all loggers)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">logging</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">log_level</span><span class="p">))</span>

    <span class="c1"># Set up logging to use Rich</span>
    <span class="n">handler</span> <span class="o">=</span> <span class="n">RichHandler</span><span class="p">(</span>
        <span class="n">rich_tracebacks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">show_path</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">console</span><span class="o">=</span><span class="n">Console</span><span class="p">(),</span>
        <span class="n">tracebacks_show_locals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>

    <span class="c1"># Load configuration</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">ServiceConfig</span><span class="p">(</span>
        <span class="n">service_run_type</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">run_type</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">config</span><span class="p">:</span>
        <span class="c1"># In a real implementation, this would load from the specified file</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Loading configuration from </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
        <span class="c1"># config.load_from_file(args.config)</span>

    <span class="c1"># Create and start the system controller</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting AIPerf System&quot;</span><span class="p">)</span>
    <span class="n">bootstrap_and_run_service</span><span class="p">(</span><span class="n">SystemController</span><span class="p">,</span> <span class="n">service_config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;AIPerf System exited&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="aiperfcommonbase_metaclass">aiperf.common.base_metaclass<a class="headerlink" href="#aiperfcommonbase_metaclass" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.base_metaclass"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.common.base_metaclass.BaseMetaclass" class="doc doc-heading">
            <code>BaseMetaclass</code>


<a href="#aiperf.common.base_metaclass.BaseMetaclass" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABCMeta">ABCMeta</span></code></p>


        <p>Base metaclass for all AIPerf metaclasses that support hooks.</p>
<p>This metaclass is used to collect the hooks for a service. All of the logic
for the hooks is implemented here, and other metaclasses should inherit from
this one, and specify the supported hook types via the <code>register_metaclass</code>
decorator.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/base_metaclass.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BaseMetaclass</span><span class="p">(</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base metaclass for all AIPerf metaclasses that support hooks.</span>

<span class="sd">    This metaclass is used to collect the hooks for a service. All of the logic</span>
<span class="sd">    for the hooks is implemented here, and other metaclasses should inherit from</span>
<span class="sd">    this one, and specify the supported hook types via the `register_metaclass`</span>
<span class="sd">    decorator.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_supported_hook_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">AIPerfHooks</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">_strict_hook_types</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__new__</span><span class="p">(</span><span class="n">mcs</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">bases</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">type</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">namespace</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
        <span class="n">_aiperf_hooks</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callable</span><span class="p">]]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

        <span class="c1"># Add hooks from the current class by looking through each element</span>
        <span class="c1"># in the namespace and checking if it has a hook type attribute.</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">attr_value</span> <span class="ow">in</span> <span class="n">namespace</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">hook_type</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">attr_value</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">HOOK_TYPE</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">hook_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="c1"># If strict hook types are enabled, and the hook type is not in the</span>
            <span class="c1"># list of supported hook types, raise an error. This is to prevent</span>
            <span class="c1"># issues that arise from using a hook type that is not supported,</span>
            <span class="c1"># and wondering why it is not working.</span>
            <span class="k">if</span> <span class="n">mcs</span><span class="o">.</span><span class="n">_strict_hook_types</span> <span class="ow">and</span> <span class="n">hook_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mcs</span><span class="o">.</span><span class="n">_supported_hook_types</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">AIPerfMetaclassError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid hook type: </span><span class="si">{</span><span class="n">hook_type</span><span class="si">}</span><span class="s2"> for </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">attr_value</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="p">)</span>

            <span class="n">_aiperf_hooks</span><span class="p">[</span><span class="n">hook_type</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attr_value</span><span class="p">)</span>

        <span class="c1"># Add hooks from all base classes. This is done to allow for hooks to be</span>
        <span class="c1"># defined in base classes and still be inherited by derived classes.</span>
        <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="n">bases</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="s2">&quot;_aiperf_hooks&quot;</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">hook_type</span><span class="p">,</span> <span class="n">hooks</span> <span class="ow">in</span> <span class="n">base</span><span class="o">.</span><span class="n">_aiperf_hooks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">_aiperf_hooks</span><span class="p">[</span><span class="n">hook_type</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">hooks</span><span class="p">)</span>

        <span class="n">namespace</span><span class="p">[</span><span class="s2">&quot;_aiperf_hooks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_aiperf_hooks</span>

        <span class="bp">cls</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">mcs</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="aiperf.common.base_metaclass.register_metaclass" class="doc doc-heading">
            <code class=" language-python"><span class="n">register_metaclass</span><span class="p">(</span><span class="o">*</span><span class="n">supported_hook_types</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#aiperf.common.base_metaclass.register_metaclass" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Decorator to register a metaclass with the AIPerf framework.</p>
<p>It will add the supported hook types to the metaclass and set whether the
hook types are strict or not.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>supported_hook_types</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="AIPerfHooks (aiperf.common.decorators.AIPerfHooks)" href="#aiperf.common.decorators.AIPerfHooks">AIPerfHooks</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The hook types that the metaclass supports.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strict</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the hook types are strict or not. If strict is True
(default: True), then the metaclass will raise an error if an invalid
hook type is used. This is to prevent issues that arise from using
a hook type that is not supported, and wondering why it is not
working.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Callable">Callable</span>[[<span title="type">type</span>], <span title="type">type</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The decorated metaclass.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/base_metaclass.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">register_metaclass</span><span class="p">(</span>
    <span class="o">*</span><span class="n">supported_hook_types</span><span class="p">:</span> <span class="n">AIPerfHooks</span><span class="p">,</span>
    <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">type</span><span class="p">],</span> <span class="nb">type</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator to register a metaclass with the AIPerf framework.</span>

<span class="sd">    It will add the supported hook types to the metaclass and set whether the</span>
<span class="sd">    hook types are strict or not.</span>

<span class="sd">    Args:</span>
<span class="sd">        supported_hook_types: The hook types that the metaclass supports.</span>
<span class="sd">        strict: Whether the hook types are strict or not. If strict is True</span>
<span class="sd">            (default: True), then the metaclass will raise an error if an invalid</span>
<span class="sd">            hook type is used. This is to prevent issues that arise from using</span>
<span class="sd">            a hook type that is not supported, and wondering why it is not</span>
<span class="sd">            working.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The decorated metaclass.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">decorator</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseMetaclass</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseMetaclass</span><span class="p">]:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_supported_hook_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">supported_hook_types</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_strict_hook_types</span> <span class="o">=</span> <span class="n">strict</span>
        <span class="k">return</span> <span class="bp">cls</span>

    <span class="k">return</span> <span class="n">decorator</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="aiperfcommonbootstrap">aiperf.common.bootstrap<a class="headerlink" href="#aiperfcommonbootstrap" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.bootstrap"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="aiperf.common.bootstrap.bootstrap_and_run_service" class="doc doc-heading">
            <code class=" language-python"><span class="n">bootstrap_and_run_service</span><span class="p">(</span><span class="n">service_class</span><span class="p">,</span> <span class="n">service_config</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#aiperf.common.bootstrap.bootstrap_and_run_service" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Bootstrap the service and run it.</p>
<p>This function will load the service configuration,
create an instance of the service, and run it.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>service_class</code>
            </td>
            <td>
                  <code><span title="type">type</span>[<a class="autorefs autorefs-internal" title="BaseService (aiperf.common.service.base_service.BaseService)" href="#aiperf.common.service.base_service.BaseService">BaseService</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The service class of the service to run</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>service_config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ServiceConfig (aiperf.common.config.service_config.ServiceConfig)" href="#aiperf.common.config.service_config.ServiceConfig">ServiceConfig</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The service configuration to use, if not provided, the service
configuration will be loaded from the config file</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/bootstrap.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bootstrap_and_run_service</span><span class="p">(</span>
    <span class="n">service_class</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">],</span> <span class="n">service_config</span><span class="p">:</span> <span class="n">ServiceConfig</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Bootstrap the service and run it.</span>

<span class="sd">    This function will load the service configuration,</span>
<span class="sd">    create an instance of the service, and run it.</span>

<span class="sd">    Args:</span>
<span class="sd">        service_class: The service class of the service to run</span>
<span class="sd">        service_config: The service configuration to use, if not provided, the service</span>
<span class="sd">            configuration will be loaded from the config file</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">uvloop</span>

    <span class="c1"># Load the service configuration</span>
    <span class="k">if</span> <span class="n">service_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">aiperf.common.config.loader</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_service_config</span>

        <span class="n">service_config</span> <span class="o">=</span> <span class="n">load_service_config</span><span class="p">()</span>

    <span class="c1"># Create the service instance and run it</span>
    <span class="n">service</span> <span class="o">=</span> <span class="n">service_class</span><span class="p">(</span><span class="n">service_config</span><span class="o">=</span><span class="n">service_config</span><span class="p">)</span>
    <span class="n">uvloop</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">service</span><span class="o">.</span><span class="n">run_forever</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="aiperfcommoncommsbase">aiperf.common.comms.base<a class="headerlink" href="#aiperfcommoncommsbase" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.comms.base"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.common.comms.base.BaseCommunication" class="doc doc-heading">
            <code>BaseCommunication</code>


<a href="#aiperf.common.comms.base.BaseCommunication" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>


        <p>Base class for specifying the base communication layer for AIPerf components.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/comms/base.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BaseCommunication</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for specifying the base communication layer for AIPerf components.&quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize communication channels.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_initialized</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if communication channels are initialized.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if communication channels are initialized, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if communication channels are shutdown.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if communication channels are shutdown, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gracefully shutdown communication channels.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">create_clients</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">client_types</span><span class="p">:</span> <span class="n">ClientType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the communication clients.</span>

<span class="sd">        Args:</span>
<span class="sd">            *client_types: The client types to create</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">publish</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Publish a response to a topic.</span>

<span class="sd">        Args:</span>
<span class="sd">            topic: Topic to publish to</span>
<span class="sd">            message: Message to publish</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">subscribe</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Message</span><span class="p">],</span> <span class="n">Coroutine</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Subscribe to a topic.</span>

<span class="sd">        Args:</span>
<span class="sd">            topic: Topic to subscribe to</span>
<span class="sd">            callback: Function to call when a response is received</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">request_data</span><span class="p">:</span> <span class="n">Message</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Message</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Send a request and wait for a response.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Target component to send request to</span>
<span class="sd">            request_data: Request data</span>
<span class="sd">            timeout: Timeout in seconds</span>

<span class="sd">        Returns:</span>
<span class="sd">            Response message if successful</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">respond</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Send a response to a request.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Target component to send response to</span>
<span class="sd">            response: Response message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Push data to a target.</span>

<span class="sd">        Args:</span>
<span class="sd">            topic: Topic to push to</span>
<span class="sd">            message: Message to be pushed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">pull</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Message</span><span class="p">],</span> <span class="n">Coroutine</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pull data from a source.</span>

<span class="sd">        Args:</span>
<span class="sd">            topic: Topic to pull from</span>
<span class="sd">            callback: function to call when data is received.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.comms.base.BaseCommunication.is_initialized" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_initialized</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.comms.base.BaseCommunication.is_initialized" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if communication channels are initialized.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if communication channels are initialized, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.comms.base.BaseCommunication.is_shutdown" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_shutdown</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.comms.base.BaseCommunication.is_shutdown" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if communication channels are shutdown.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if communication channels are shutdown, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.base.BaseCommunication.create_clients" class="doc doc-heading">
            <code class=" language-python"><span class="n">create_clients</span><span class="p">(</span><span class="o">*</span><span class="n">client_types</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.base.BaseCommunication.create_clients" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create the communication clients.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>*client_types</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ClientType = Union[PubClientType, SubClientType, PushClientType, PullClientType, ReqClientType, RepClientType]

  
      module-attribute
   (aiperf.common.comms.client_enums.ClientType)" href="#aiperf.common.comms.client_enums.ClientType">ClientType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The client types to create</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/base.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">create_clients</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">client_types</span><span class="p">:</span> <span class="n">ClientType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create the communication clients.</span>

<span class="sd">    Args:</span>
<span class="sd">        *client_types: The client types to create</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.base.BaseCommunication.initialize" class="doc doc-heading">
            <code class=" language-python"><span class="n">initialize</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.base.BaseCommunication.initialize" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize communication channels.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/base.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize communication channels.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.base.BaseCommunication.publish" class="doc doc-heading">
            <code class=" language-python"><span class="n">publish</span><span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.base.BaseCommunication.publish" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Publish a response to a topic.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>topic</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TopicType = Topic | DataTopic

  
      module-attribute
   (aiperf.common.enums.TopicType)" href="#aiperf.common.enums.TopicType">TopicType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Topic to publish to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Message to publish</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/base.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">publish</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Publish a response to a topic.</span>

<span class="sd">    Args:</span>
<span class="sd">        topic: Topic to publish to</span>
<span class="sd">        message: Message to publish</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.base.BaseCommunication.pull" class="doc doc-heading">
            <code class=" language-python"><span class="n">pull</span><span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.base.BaseCommunication.pull" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Pull data from a source.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>topic</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TopicType = Topic | DataTopic

  
      module-attribute
   (aiperf.common.enums.TopicType)" href="#aiperf.common.enums.TopicType">TopicType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Topic to pull from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>callback</code>
            </td>
            <td>
                  <code><span title="collections.abc.Callable">Callable</span>[[<a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a>], <span title="collections.abc.Coroutine">Coroutine</span>[<span title="typing.Any">Any</span>, <span title="typing.Any">Any</span>, None]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>function to call when data is received.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/base.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">pull</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">,</span>
    <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Message</span><span class="p">],</span> <span class="n">Coroutine</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pull data from a source.</span>

<span class="sd">    Args:</span>
<span class="sd">        topic: Topic to pull from</span>
<span class="sd">        callback: function to call when data is received.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.base.BaseCommunication.push" class="doc doc-heading">
            <code class=" language-python"><span class="n">push</span><span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.base.BaseCommunication.push" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Push data to a target.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>topic</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TopicType = Topic | DataTopic

  
      module-attribute
   (aiperf.common.enums.TopicType)" href="#aiperf.common.enums.TopicType">TopicType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Topic to push to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Message to be pushed</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/base.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Push data to a target.</span>

<span class="sd">    Args:</span>
<span class="sd">        topic: Topic to push to</span>
<span class="sd">        message: Message to be pushed</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.base.BaseCommunication.request" class="doc doc-heading">
            <code class=" language-python"><span class="n">request</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">request_data</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.base.BaseCommunication.request" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Send a request and wait for a response.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>target</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target component to send request to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>request_data</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Request data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timeout</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timeout in seconds</p>
              </div>
            </td>
            <td>
                  <code>5.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Response message if successful</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/base.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">request</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">request_data</span><span class="p">:</span> <span class="n">Message</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Message</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Send a request and wait for a response.</span>

<span class="sd">    Args:</span>
<span class="sd">        target: Target component to send request to</span>
<span class="sd">        request_data: Request data</span>
<span class="sd">        timeout: Timeout in seconds</span>

<span class="sd">    Returns:</span>
<span class="sd">        Response message if successful</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.base.BaseCommunication.respond" class="doc doc-heading">
            <code class=" language-python"><span class="n">respond</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.base.BaseCommunication.respond" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Send a response to a request.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>target</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target component to send response to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>response</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Response message</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/base.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">respond</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Send a response to a request.</span>

<span class="sd">    Args:</span>
<span class="sd">        target: Target component to send response to</span>
<span class="sd">        response: Response message</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.base.BaseCommunication.shutdown" class="doc doc-heading">
            <code class=" language-python"><span class="n">shutdown</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.base.BaseCommunication.shutdown" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Gracefully shutdown communication channels.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/base.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gracefully shutdown communication channels.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.base.BaseCommunication.subscribe" class="doc doc-heading">
            <code class=" language-python"><span class="n">subscribe</span><span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.base.BaseCommunication.subscribe" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Subscribe to a topic.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>topic</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TopicType = Topic | DataTopic

  
      module-attribute
   (aiperf.common.enums.TopicType)" href="#aiperf.common.enums.TopicType">TopicType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Topic to subscribe to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>callback</code>
            </td>
            <td>
                  <code><span title="collections.abc.Callable">Callable</span>[[<a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a>], <span title="collections.abc.Coroutine">Coroutine</span>[<span title="typing.Any">Any</span>, <span title="typing.Any">Any</span>, None]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to call when a response is received</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/base.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">subscribe</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">,</span>
    <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Message</span><span class="p">],</span> <span class="n">Coroutine</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Subscribe to a topic.</span>

<span class="sd">    Args:</span>
<span class="sd">        topic: Topic to subscribe to</span>
<span class="sd">        callback: Function to call when a response is received</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.comms.base.CommunicationFactory" class="doc doc-heading">
            <code>CommunicationFactory</code>


<a href="#aiperf.common.comms.base.CommunicationFactory" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Factory for creating communication instances. Provides a registry of communication types and
methods for registering new communication types and creating communication instances from existing
registered types.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/comms/base.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CommunicationFactory</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Factory for creating communication instances. Provides a registry of communication types and</span>
<span class="sd">    methods for registering new communication types and creating communication instances from existing</span>
<span class="sd">    registered types.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Registry of communication types</span>
    <span class="n">_comm_registry</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">CommunicationBackend</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseCommunication</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">comm_type</span><span class="p">:</span> <span class="n">CommunicationBackend</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a new communication type.</span>

<span class="sd">        Args:</span>
<span class="sd">            comm_type: String representation of the communication type</span>

<span class="sd">        Returns:</span>
<span class="sd">            Decorator for the communication class</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationTypeAlreadyRegisteredError: If the communication type is already registered</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">decorator</span><span class="p">(</span><span class="n">comm_cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseCommunication</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseCommunication</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">comm_type</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_comm_registry</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CommunicationTypeAlreadyRegisteredError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Communication type </span><span class="si">{</span><span class="n">comm_type</span><span class="si">}</span><span class="s2"> already registered&quot;</span>
                <span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_comm_registry</span><span class="p">[</span><span class="n">comm_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">comm_cls</span>
            <span class="k">return</span> <span class="n">comm_cls</span>

        <span class="k">return</span> <span class="n">decorator</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_communication</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">service_config</span><span class="p">:</span> <span class="n">ServiceConfig</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseCommunication</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a communication instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            service_config: Service configuration containing the communication type</span>
<span class="sd">            **kwargs: Additional arguments for the communication class</span>

<span class="sd">        Returns:</span>
<span class="sd">            BaseCommunication instance</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationTypeUnknownError: If the communication type is not registered</span>
<span class="sd">            CommunicationCreateError: If there was an error creating the communication instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">service_config</span><span class="o">.</span><span class="n">comm_backend</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_comm_registry</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CommunicationTypeUnknownError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unknown communication type: </span><span class="si">{</span><span class="n">service_config</span><span class="o">.</span><span class="n">comm_backend</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">comm_class</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_comm_registry</span><span class="p">[</span><span class="n">service_config</span><span class="o">.</span><span class="n">comm_backend</span><span class="p">]</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;config&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ZMQCommunicationConfig</span><span class="p">(</span>
                <span class="n">protocol_config</span><span class="o">=</span><span class="n">ZMQTCPTransportConfig</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">config</span>

            <span class="k">return</span> <span class="n">comm_class</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CommunicationCreateError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.base.CommunicationFactory.create_communication" class="doc doc-heading">
            <code class=" language-python"><span class="n">create_communication</span><span class="p">(</span><span class="n">service_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#aiperf.common.comms.base.CommunicationFactory.create_communication" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create a communication instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>service_config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ServiceConfig (aiperf.common.config.service_config.ServiceConfig)" href="#aiperf.common.config.service_config.ServiceConfig">ServiceConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Service configuration containing the communication type</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments for the communication class</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="BaseCommunication (aiperf.common.comms.base.BaseCommunication)" href="#aiperf.common.comms.base.BaseCommunication">BaseCommunication</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>BaseCommunication instance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationTypeUnknownError (aiperf.common.exceptions.CommunicationTypeUnknownError)" href="#aiperf.common.exceptions.CommunicationTypeUnknownError">CommunicationTypeUnknownError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the communication type is not registered</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationCreateError (aiperf.common.exceptions.CommunicationCreateError)" href="#aiperf.common.exceptions.CommunicationCreateError">CommunicationCreateError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there was an error creating the communication instance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/base.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_communication</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span> <span class="n">service_config</span><span class="p">:</span> <span class="n">ServiceConfig</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseCommunication</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a communication instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        service_config: Service configuration containing the communication type</span>
<span class="sd">        **kwargs: Additional arguments for the communication class</span>

<span class="sd">    Returns:</span>
<span class="sd">        BaseCommunication instance</span>

<span class="sd">    Raises:</span>
<span class="sd">        CommunicationTypeUnknownError: If the communication type is not registered</span>
<span class="sd">        CommunicationCreateError: If there was an error creating the communication instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">service_config</span><span class="o">.</span><span class="n">comm_backend</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_comm_registry</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CommunicationTypeUnknownError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Unknown communication type: </span><span class="si">{</span><span class="n">service_config</span><span class="o">.</span><span class="n">comm_backend</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">comm_class</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_comm_registry</span><span class="p">[</span><span class="n">service_config</span><span class="o">.</span><span class="n">comm_backend</span><span class="p">]</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;config&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ZMQCommunicationConfig</span><span class="p">(</span>
            <span class="n">protocol_config</span><span class="o">=</span><span class="n">ZMQTCPTransportConfig</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">config</span>

        <span class="k">return</span> <span class="n">comm_class</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CommunicationCreateError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.base.CommunicationFactory.register" class="doc doc-heading">
            <code class=" language-python"><span class="n">register</span><span class="p">(</span><span class="n">comm_type</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#aiperf.common.comms.base.CommunicationFactory.register" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Register a new communication type.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>comm_type</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationBackend (aiperf.common.enums.CommunicationBackend)" href="#aiperf.common.enums.CommunicationBackend">CommunicationBackend</a> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String representation of the communication type</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Decorator for the communication class</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationTypeAlreadyRegisteredError (aiperf.common.exceptions.CommunicationTypeAlreadyRegisteredError)" href="#aiperf.common.exceptions.CommunicationTypeAlreadyRegisteredError">CommunicationTypeAlreadyRegisteredError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the communication type is already registered</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/base.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">comm_type</span><span class="p">:</span> <span class="n">CommunicationBackend</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Register a new communication type.</span>

<span class="sd">    Args:</span>
<span class="sd">        comm_type: String representation of the communication type</span>

<span class="sd">    Returns:</span>
<span class="sd">        Decorator for the communication class</span>

<span class="sd">    Raises:</span>
<span class="sd">        CommunicationTypeAlreadyRegisteredError: If the communication type is already registered</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">decorator</span><span class="p">(</span><span class="n">comm_cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseCommunication</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseCommunication</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">comm_type</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_comm_registry</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CommunicationTypeAlreadyRegisteredError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Communication type </span><span class="si">{</span><span class="n">comm_type</span><span class="si">}</span><span class="s2"> already registered&quot;</span>
            <span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_comm_registry</span><span class="p">[</span><span class="n">comm_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">comm_cls</span>
        <span class="k">return</span> <span class="n">comm_cls</span>

    <span class="k">return</span> <span class="n">decorator</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommoncommsclient_enums">aiperf.common.comms.client_enums<a class="headerlink" href="#aiperfcommoncommsclient_enums" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.comms.client_enums"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="aiperf.common.comms.client_enums.ClientType" class="doc doc-heading">
            <code class=" language-python"><span class="n">ClientType</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">PubClientType</span><span class="p">,</span> <span class="n">SubClientType</span><span class="p">,</span> <span class="n">PushClientType</span><span class="p">,</span> <span class="n">PullClientType</span><span class="p">,</span> <span class="n">ReqClientType</span><span class="p">,</span> <span class="n">RepClientType</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#aiperf.common.comms.client_enums.ClientType" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Union of all client types.</p>

    </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="aiperf.common.comms.client_enums.PubClientType" class="doc doc-heading">
            <code>PubClientType</code>


<a href="#aiperf.common.comms.client_enums.PubClientType" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StrEnum (aiperf.common.enums.StrEnum)" href="#aiperf.common.enums.StrEnum">StrEnum</a></code></p>


        <p>Enum for specifying the client type for publishing messages. Includes a helper method
for retrieving the appropriate client type based on the topic.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/comms/client_enums.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PubClientType</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enum for specifying the client type for publishing messages. Includes a helper method</span>
<span class="sd">    for retrieving the appropriate client type based on the topic.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLLER</span> <span class="o">=</span> <span class="s2">&quot;controller_pub&quot;</span>
    <span class="n">COMPONENT</span> <span class="o">=</span> <span class="s2">&quot;component_pub&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_topic</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PubClientType&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine the appropriate ClientType based on topic.</span>

<span class="sd">        Args:</span>
<span class="sd">            topic: The topic to communicate on</span>

<span class="sd">        Returns:</span>
<span class="sd">            The appropriate ClientType for the given topic</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">match</span> <span class="n">topic</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">Topic</span><span class="o">.</span><span class="n">HEARTBEAT</span> <span class="o">|</span> <span class="n">Topic</span><span class="o">.</span><span class="n">REGISTRATION</span> <span class="o">|</span> <span class="n">Topic</span><span class="o">.</span><span class="n">STATUS</span> <span class="o">|</span> <span class="n">Topic</span><span class="o">.</span><span class="n">RESPONSE</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">COMPONENT</span>
            <span class="k">case</span> <span class="n">Topic</span><span class="o">.</span><span class="n">COMMAND</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CONTROLLER</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CommunicationClientNotFoundError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;No client type found for topic </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.client_enums.PubClientType.from_topic" class="doc doc-heading">
            <code class=" language-python"><span class="n">from_topic</span><span class="p">(</span><span class="n">topic</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#aiperf.common.comms.client_enums.PubClientType.from_topic" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Determine the appropriate ClientType based on topic.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>topic</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TopicType = Topic | DataTopic

  
      module-attribute
   (aiperf.common.enums.TopicType)" href="#aiperf.common.enums.TopicType">TopicType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The topic to communicate on</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="PubClientType (aiperf.common.comms.client_enums.PubClientType)" href="#aiperf.common.comms.client_enums.PubClientType">PubClientType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The appropriate ClientType for the given topic</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/client_enums.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_topic</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PubClientType&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine the appropriate ClientType based on topic.</span>

<span class="sd">    Args:</span>
<span class="sd">        topic: The topic to communicate on</span>

<span class="sd">    Returns:</span>
<span class="sd">        The appropriate ClientType for the given topic</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">match</span> <span class="n">topic</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">Topic</span><span class="o">.</span><span class="n">HEARTBEAT</span> <span class="o">|</span> <span class="n">Topic</span><span class="o">.</span><span class="n">REGISTRATION</span> <span class="o">|</span> <span class="n">Topic</span><span class="o">.</span><span class="n">STATUS</span> <span class="o">|</span> <span class="n">Topic</span><span class="o">.</span><span class="n">RESPONSE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">COMPONENT</span>
        <span class="k">case</span> <span class="n">Topic</span><span class="o">.</span><span class="n">COMMAND</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CONTROLLER</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CommunicationClientNotFoundError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No client type found for topic </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.comms.client_enums.PullClientType" class="doc doc-heading">
            <code>PullClientType</code>


<a href="#aiperf.common.comms.client_enums.PullClientType" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StrEnum (aiperf.common.enums.StrEnum)" href="#aiperf.common.enums.StrEnum">StrEnum</a></code></p>


        <p>Enum for specifying the client type for pulling messages. Includes a helper method
for retrieving the appropriate client type based on the topic.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/comms/client_enums.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PullClientType</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enum for specifying the client type for pulling messages. Includes a helper method</span>
<span class="sd">    for retrieving the appropriate client type based on the topic.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">RECORDS</span> <span class="o">=</span> <span class="s2">&quot;records_pull&quot;</span>
    <span class="n">INFERENCE_RESULTS</span> <span class="o">=</span> <span class="s2">&quot;inference_results_pull&quot;</span>
    <span class="n">CREDIT_DROP</span> <span class="o">=</span> <span class="s2">&quot;credit_drop_pull&quot;</span>
    <span class="n">CREDIT_RETURN</span> <span class="o">=</span> <span class="s2">&quot;credit_return_pull&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_topic</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PullClientType&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine the appropriate ClientType based on topic.</span>

<span class="sd">        Args:</span>
<span class="sd">            topic: The topic to communicate on</span>

<span class="sd">        Returns:</span>
<span class="sd">            The appropriate ClientType for the given topic</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">match</span> <span class="n">topic</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">Topic</span><span class="o">.</span><span class="n">CREDIT_DROP</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CREDIT_DROP</span>
            <span class="k">case</span> <span class="n">Topic</span><span class="o">.</span><span class="n">CREDIT_RETURN</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CREDIT_RETURN</span>
            <span class="k">case</span> <span class="n">DataTopic</span><span class="o">.</span><span class="n">RECORDS</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">RECORDS</span>
            <span class="k">case</span> <span class="n">DataTopic</span><span class="o">.</span><span class="n">RESULTS</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">INFERENCE_RESULTS</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CommunicationClientNotFoundError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;No client type found for topic </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.client_enums.PullClientType.from_topic" class="doc doc-heading">
            <code class=" language-python"><span class="n">from_topic</span><span class="p">(</span><span class="n">topic</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#aiperf.common.comms.client_enums.PullClientType.from_topic" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Determine the appropriate ClientType based on topic.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>topic</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TopicType = Topic | DataTopic

  
      module-attribute
   (aiperf.common.enums.TopicType)" href="#aiperf.common.enums.TopicType">TopicType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The topic to communicate on</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="PullClientType (aiperf.common.comms.client_enums.PullClientType)" href="#aiperf.common.comms.client_enums.PullClientType">PullClientType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The appropriate ClientType for the given topic</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/client_enums.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_topic</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PullClientType&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine the appropriate ClientType based on topic.</span>

<span class="sd">    Args:</span>
<span class="sd">        topic: The topic to communicate on</span>

<span class="sd">    Returns:</span>
<span class="sd">        The appropriate ClientType for the given topic</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">match</span> <span class="n">topic</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">Topic</span><span class="o">.</span><span class="n">CREDIT_DROP</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CREDIT_DROP</span>
        <span class="k">case</span> <span class="n">Topic</span><span class="o">.</span><span class="n">CREDIT_RETURN</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CREDIT_RETURN</span>
        <span class="k">case</span> <span class="n">DataTopic</span><span class="o">.</span><span class="n">RECORDS</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">RECORDS</span>
        <span class="k">case</span> <span class="n">DataTopic</span><span class="o">.</span><span class="n">RESULTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">INFERENCE_RESULTS</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CommunicationClientNotFoundError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No client type found for topic </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.comms.client_enums.PushClientType" class="doc doc-heading">
            <code>PushClientType</code>


<a href="#aiperf.common.comms.client_enums.PushClientType" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StrEnum (aiperf.common.enums.StrEnum)" href="#aiperf.common.enums.StrEnum">StrEnum</a></code></p>


        <p>Enum for specifying the client type for pushing messages. Includes a helper method
for retrieving the appropriate client type based on the topic.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/comms/client_enums.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PushClientType</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enum for specifying the client type for pushing messages. Includes a helper method</span>
<span class="sd">    for retrieving the appropriate client type based on the topic.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">RECORDS</span> <span class="o">=</span> <span class="s2">&quot;records_push&quot;</span>
    <span class="n">INFERENCE_RESULTS</span> <span class="o">=</span> <span class="s2">&quot;inference_results_push&quot;</span>
    <span class="n">CREDIT_DROP</span> <span class="o">=</span> <span class="s2">&quot;credit_drop_push&quot;</span>
    <span class="n">CREDIT_RETURN</span> <span class="o">=</span> <span class="s2">&quot;credit_return_push&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_topic</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PushClientType&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine the appropriate ClientType based on communication type and topic.</span>

<span class="sd">        Args:</span>
<span class="sd">            topic: The topic to communicate on</span>

<span class="sd">        Returns:</span>
<span class="sd">            The appropriate ClientType for the given topic</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">match</span> <span class="n">topic</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">Topic</span><span class="o">.</span><span class="n">CREDIT_DROP</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CREDIT_DROP</span>
            <span class="k">case</span> <span class="n">Topic</span><span class="o">.</span><span class="n">CREDIT_RETURN</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CREDIT_RETURN</span>
            <span class="k">case</span> <span class="n">DataTopic</span><span class="o">.</span><span class="n">RECORDS</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">RECORDS</span>
            <span class="k">case</span> <span class="n">DataTopic</span><span class="o">.</span><span class="n">RESULTS</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">INFERENCE_RESULTS</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CommunicationClientNotFoundError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;No client type found for topic </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.client_enums.PushClientType.from_topic" class="doc doc-heading">
            <code class=" language-python"><span class="n">from_topic</span><span class="p">(</span><span class="n">topic</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#aiperf.common.comms.client_enums.PushClientType.from_topic" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Determine the appropriate ClientType based on communication type and topic.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>topic</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TopicType = Topic | DataTopic

  
      module-attribute
   (aiperf.common.enums.TopicType)" href="#aiperf.common.enums.TopicType">TopicType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The topic to communicate on</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="PushClientType (aiperf.common.comms.client_enums.PushClientType)" href="#aiperf.common.comms.client_enums.PushClientType">PushClientType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The appropriate ClientType for the given topic</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/client_enums.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_topic</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;PushClientType&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine the appropriate ClientType based on communication type and topic.</span>

<span class="sd">    Args:</span>
<span class="sd">        topic: The topic to communicate on</span>

<span class="sd">    Returns:</span>
<span class="sd">        The appropriate ClientType for the given topic</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">match</span> <span class="n">topic</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">Topic</span><span class="o">.</span><span class="n">CREDIT_DROP</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CREDIT_DROP</span>
        <span class="k">case</span> <span class="n">Topic</span><span class="o">.</span><span class="n">CREDIT_RETURN</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CREDIT_RETURN</span>
        <span class="k">case</span> <span class="n">DataTopic</span><span class="o">.</span><span class="n">RECORDS</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">RECORDS</span>
        <span class="k">case</span> <span class="n">DataTopic</span><span class="o">.</span><span class="n">RESULTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">INFERENCE_RESULTS</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CommunicationClientNotFoundError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No client type found for topic </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.comms.client_enums.RepClientType" class="doc doc-heading">
            <code>RepClientType</code>


<a href="#aiperf.common.comms.client_enums.RepClientType" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StrEnum (aiperf.common.enums.StrEnum)" href="#aiperf.common.enums.StrEnum">StrEnum</a></code></p>


        <p>Enum for specifying the client type for responding to messages. Includes a helper method
for retrieving the appropriate client type based on the topic.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/comms/client_enums.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RepClientType</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enum for specifying the client type for responding to messages. Includes a helper method</span>
<span class="sd">    for retrieving the appropriate client type based on the topic.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONVERSATION_DATA</span> <span class="o">=</span> <span class="s2">&quot;conversation_data_rep&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_topic</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;RepClientType&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine the appropriate ClientType based on topic.</span>

<span class="sd">        Args:</span>
<span class="sd">            topic: The topic to communicate on</span>

<span class="sd">        Returns:</span>
<span class="sd">            The appropriate ClientType for the given topic</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">match</span> <span class="n">topic</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">DataTopic</span><span class="o">.</span><span class="n">CONVERSATION</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CONVERSATION_DATA</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CommunicationClientNotFoundError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;No client type found for topic </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.client_enums.RepClientType.from_topic" class="doc doc-heading">
            <code class=" language-python"><span class="n">from_topic</span><span class="p">(</span><span class="n">topic</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#aiperf.common.comms.client_enums.RepClientType.from_topic" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Determine the appropriate ClientType based on topic.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>topic</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TopicType = Topic | DataTopic

  
      module-attribute
   (aiperf.common.enums.TopicType)" href="#aiperf.common.enums.TopicType">TopicType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The topic to communicate on</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RepClientType (aiperf.common.comms.client_enums.RepClientType)" href="#aiperf.common.comms.client_enums.RepClientType">RepClientType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The appropriate ClientType for the given topic</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/client_enums.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_topic</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;RepClientType&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine the appropriate ClientType based on topic.</span>

<span class="sd">    Args:</span>
<span class="sd">        topic: The topic to communicate on</span>

<span class="sd">    Returns:</span>
<span class="sd">        The appropriate ClientType for the given topic</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">match</span> <span class="n">topic</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">DataTopic</span><span class="o">.</span><span class="n">CONVERSATION</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CONVERSATION_DATA</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CommunicationClientNotFoundError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No client type found for topic </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.comms.client_enums.ReqClientType" class="doc doc-heading">
            <code>ReqClientType</code>


<a href="#aiperf.common.comms.client_enums.ReqClientType" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StrEnum (aiperf.common.enums.StrEnum)" href="#aiperf.common.enums.StrEnum">StrEnum</a></code></p>


        <p>Enum for specifying the client type for requesting messages. Includes a helper method
for retrieving the appropriate client type based on the topic.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/comms/client_enums.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ReqClientType</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enum for specifying the client type for requesting messages. Includes a helper method</span>
<span class="sd">    for retrieving the appropriate client type based on the topic.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONVERSATION_DATA</span> <span class="o">=</span> <span class="s2">&quot;conversation_data_req&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_topic</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ReqClientType&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine the appropriate ClientType based on topic.</span>

<span class="sd">        Args:</span>
<span class="sd">            topic: The topic to communicate on</span>

<span class="sd">        Returns:</span>
<span class="sd">            The appropriate ClientType for the given topic</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">match</span> <span class="n">topic</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">DataTopic</span><span class="o">.</span><span class="n">CONVERSATION</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CONVERSATION_DATA</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CommunicationClientNotFoundError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;No client type found for topic </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.client_enums.ReqClientType.from_topic" class="doc doc-heading">
            <code class=" language-python"><span class="n">from_topic</span><span class="p">(</span><span class="n">topic</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#aiperf.common.comms.client_enums.ReqClientType.from_topic" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Determine the appropriate ClientType based on topic.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>topic</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TopicType = Topic | DataTopic

  
      module-attribute
   (aiperf.common.enums.TopicType)" href="#aiperf.common.enums.TopicType">TopicType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The topic to communicate on</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ReqClientType (aiperf.common.comms.client_enums.ReqClientType)" href="#aiperf.common.comms.client_enums.ReqClientType">ReqClientType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The appropriate ClientType for the given topic</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/client_enums.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_topic</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ReqClientType&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine the appropriate ClientType based on topic.</span>

<span class="sd">    Args:</span>
<span class="sd">        topic: The topic to communicate on</span>

<span class="sd">    Returns:</span>
<span class="sd">        The appropriate ClientType for the given topic</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">match</span> <span class="n">topic</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">DataTopic</span><span class="o">.</span><span class="n">CONVERSATION</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CONVERSATION_DATA</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CommunicationClientNotFoundError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No client type found for topic </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.comms.client_enums.SubClientType" class="doc doc-heading">
            <code>SubClientType</code>


<a href="#aiperf.common.comms.client_enums.SubClientType" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StrEnum (aiperf.common.enums.StrEnum)" href="#aiperf.common.enums.StrEnum">StrEnum</a></code></p>


        <p>Enum for specifying the client type for subscribing to messages. Includes a helper method
for retrieving the appropriate client type based on the topic.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/comms/client_enums.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SubClientType</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enum for specifying the client type for subscribing to messages. Includes a helper method</span>
<span class="sd">    for retrieving the appropriate client type based on the topic.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">CONTROLLER</span> <span class="o">=</span> <span class="s2">&quot;controller_sub&quot;</span>
    <span class="n">COMPONENT</span> <span class="o">=</span> <span class="s2">&quot;component_sub&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_topic</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SubClientType&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine the appropriate ClientType based on topic.</span>

<span class="sd">        Args:</span>
<span class="sd">            topic: The topic to communicate on</span>

<span class="sd">        Returns:</span>
<span class="sd">            The appropriate ClientType for the given topic</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">match</span> <span class="n">topic</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">Topic</span><span class="o">.</span><span class="n">HEARTBEAT</span> <span class="o">|</span> <span class="n">Topic</span><span class="o">.</span><span class="n">REGISTRATION</span> <span class="o">|</span> <span class="n">Topic</span><span class="o">.</span><span class="n">STATUS</span> <span class="o">|</span> <span class="n">Topic</span><span class="o">.</span><span class="n">RESPONSE</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">COMPONENT</span>
            <span class="k">case</span> <span class="n">Topic</span><span class="o">.</span><span class="n">COMMAND</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CONTROLLER</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CommunicationClientNotFoundError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;No client type found for topic </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.client_enums.SubClientType.from_topic" class="doc doc-heading">
            <code class=" language-python"><span class="n">from_topic</span><span class="p">(</span><span class="n">topic</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#aiperf.common.comms.client_enums.SubClientType.from_topic" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Determine the appropriate ClientType based on topic.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>topic</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TopicType = Topic | DataTopic

  
      module-attribute
   (aiperf.common.enums.TopicType)" href="#aiperf.common.enums.TopicType">TopicType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The topic to communicate on</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="SubClientType (aiperf.common.comms.client_enums.SubClientType)" href="#aiperf.common.comms.client_enums.SubClientType">SubClientType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The appropriate ClientType for the given topic</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/client_enums.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_topic</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SubClientType&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine the appropriate ClientType based on topic.</span>

<span class="sd">    Args:</span>
<span class="sd">        topic: The topic to communicate on</span>

<span class="sd">    Returns:</span>
<span class="sd">        The appropriate ClientType for the given topic</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">match</span> <span class="n">topic</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">Topic</span><span class="o">.</span><span class="n">HEARTBEAT</span> <span class="o">|</span> <span class="n">Topic</span><span class="o">.</span><span class="n">REGISTRATION</span> <span class="o">|</span> <span class="n">Topic</span><span class="o">.</span><span class="n">STATUS</span> <span class="o">|</span> <span class="n">Topic</span><span class="o">.</span><span class="n">RESPONSE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">COMPONENT</span>
        <span class="k">case</span> <span class="n">Topic</span><span class="o">.</span><span class="n">COMMAND</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">CONTROLLER</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CommunicationClientNotFoundError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No client type found for topic </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommoncommszmqclientsbase">aiperf.common.comms.zmq.clients.base<a class="headerlink" href="#aiperfcommoncommszmqclientsbase" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.comms.zmq.clients.base"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.common.comms.zmq.clients.base.BaseZMQClient" class="doc doc-heading">
            <code>BaseZMQClient</code>


<a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>


        <p>Base class for all ZMQ clients.</p>
<p>This class provides a common interface for all ZMQ clients in the AIPerf
framework. It inherits from the ZMQClientMetaclass, allowing derived
classes to implement specific hooks.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/comms/zmq/clients/base.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BaseZMQClient</span><span class="p">(</span><span class="n">ABC</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ZMQClientMetaclass</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for all ZMQ clients.</span>

<span class="sd">    This class provides a common interface for all ZMQ clients in the AIPerf</span>
<span class="sd">    framework. It inherits from the ZMQClientMetaclass, allowing derived</span>
<span class="sd">    classes to implement specific hooks.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_aiperf_hooks</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callable</span><span class="p">]]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span>
        <span class="n">socket_type</span><span class="p">:</span> <span class="n">SocketType</span><span class="p">,</span>
        <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">bind</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">socket_ops</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the ZMQ Base class.</span>

<span class="sd">        Args:</span>
<span class="sd">            context (zmq.asyncio.Context): The ZMQ context.</span>
<span class="sd">            address (str): The address to bind or connect to.</span>
<span class="sd">            bind (bool): Whether to bind or connect the socket.</span>
<span class="sd">            socket_type (SocketType): The type of ZMQ socket (PUB or SUB).</span>
<span class="sd">            socket_ops (dict, optional): Additional socket options to set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialized_event</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">:</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span> <span class="o">=</span> <span class="n">context</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">address</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">bind</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">socket_type</span><span class="p">:</span> <span class="n">SocketType</span> <span class="o">=</span> <span class="n">socket_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_socket</span><span class="p">:</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Socket</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">socket_ops</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">socket_ops</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">socket_type</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_client_</span><span class="si">{</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_task_registry</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_initialized</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the client is initialized.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the client is shutdown.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">socket_type_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the name of the socket type.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket_type</span><span class="o">.</span><span class="n">name</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">socket</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Socket</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the zmq socket for the client.</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationNotInitializedError: If the client is not initialized</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_socket</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CommunicationNotInitializedError</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_socket</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hook_type</span><span class="p">:</span> <span class="n">AIPerfHooks</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callable</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the hooks for the given hook type.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Getting hooks for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">hook_type</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_aiperf_hooks</span><span class="p">[</span><span class="n">hook_type</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aiperf_hooks</span><span class="p">[</span><span class="n">hook_type</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_run_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hook_type</span><span class="p">:</span> <span class="n">AIPerfHooks</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run the hooks for the given hook type.</span>

<span class="sd">        Args:</span>
<span class="sd">            hook_type: The type of hook to run</span>
<span class="sd">            *args: The arguments to pass to the hooks</span>
<span class="sd">            **kwargs: The keyword arguments to pass to the hooks</span>

<span class="sd">        Raises:</span>
<span class="sd">            AIPerfMultiError: If any of the hooks raise an exception</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="n">call_all_functions_self</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_hooks</span><span class="p">(</span><span class="n">hook_type</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_ensure_initialized</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Ensure the communication channels are initialized and not shutdown.</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationNotInitializedError: If the communication channels are not initialized.</span>
<span class="sd">            CommunicationShutdownError: If the communication channels are shutdown.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CommunicationNotInitializedError</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_shutdown</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CommunicationShutdownError</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the communication, and start the tasks.</span>

<span class="sd">        This method will:</span>
<span class="sd">        - Create the zmq socket</span>
<span class="sd">        - Bind or connect the socket to the address</span>
<span class="sd">        - Set the socket options</span>
<span class="sd">        - Run the AIPerfHooks.INIT hooks</span>
<span class="sd">        - Start the tasks registered with the AIPerfHooks.TASK hooks</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_socket</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">socket_type</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="s2">&quot;ZMQ </span><span class="si">%s</span><span class="s2"> socket initialized and bound to </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">socket_type_name</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="s2">&quot;ZMQ </span><span class="si">%s</span><span class="s2"> socket initialized and connected to </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">socket_type_name</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">)</span>

            <span class="c1"># Set safe timeouts for send and receive operations</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_socket</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">zmq</span><span class="o">.</span><span class="n">RCVTIMEO</span><span class="p">,</span> <span class="mi">30</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_socket</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">zmq</span><span class="o">.</span><span class="n">SNDTIMEO</span><span class="p">,</span> <span class="mi">30</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>

            <span class="c1"># Set additional socket options requested by the caller</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket_ops</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_socket</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">INIT</span><span class="p">)</span>

            <span class="c1"># Start all registered tasks</span>
            <span class="k">for</span> <span class="n">hook</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">TASK</span><span class="p">):</span>
                <span class="c1"># TODO: support task intervals</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_task_registry</span><span class="p">[</span><span class="n">hook</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">hook</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;ZMQ </span><span class="si">%s</span><span class="s2"> socket initialized and connected to </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">socket_type_name</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Exception initializing ZMQ socket: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationInitializationError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Shutdown the communication.</span>

<span class="sd">        This method will:</span>
<span class="sd">        - Close the zmq socket</span>
<span class="sd">        - Run the AIPerfHooks.CLEANUP hooks</span>
<span class="sd">        - Cancel all registered tasks</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_shutdown</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_socket</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="s2">&quot;ZMQ </span><span class="si">%s</span><span class="s2"> socket closed (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket_type_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span>
                <span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s2">&quot;Exception shutting down ZMQ socket: </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationShutdownError</span><span class="p">(</span><span class="s2">&quot;Failed to shutdown ZMQ socket&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_socket</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">CLEANUP</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s2">&quot;Exception cleaning up ZMQ socket: </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationError</span><span class="p">(</span><span class="s2">&quot;Failed to cleanup ZMQ socket&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="c1"># Cancel all registered tasks</span>
        <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_task_registry</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>

        <span class="c1"># Wait for all tasks to complete</span>
        <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">suppress</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">):</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_task_registry</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_task_registry</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.comms.zmq.clients.base.BaseZMQClient.is_initialized" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_initialized</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.is_initialized" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if the client is initialized.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.comms.zmq.clients.base.BaseZMQClient.is_shutdown" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_shutdown</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.is_shutdown" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if the client is shutdown.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.comms.zmq.clients.base.BaseZMQClient.socket" class="doc doc-heading">
            <code class=" language-python"><span class="n">socket</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.socket" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the zmq socket for the client.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationNotInitializedError (aiperf.common.exceptions.CommunicationNotInitializedError)" href="#aiperf.common.exceptions.CommunicationNotInitializedError">CommunicationNotInitializedError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the client is not initialized</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.comms.zmq.clients.base.BaseZMQClient.socket_type_name" class="doc doc-heading">
            <code class=" language-python"><span class="n">socket_type_name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.socket_type_name" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the name of the socket type.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.clients.base.BaseZMQClient.__init__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">socket_type</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="n">socket_ops</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize the ZMQ Base class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><span title="zmq.asyncio.Context">Context</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ZMQ context.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>address</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The address to bind or connect to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bind</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to bind or connect the socket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>socket_type</code>
            </td>
            <td>
                  <code><span title="zmq.SocketType">SocketType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of ZMQ socket (PUB or SUB).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>socket_ops</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional socket options to set.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/clients/base.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span>
    <span class="n">socket_type</span><span class="p">:</span> <span class="n">SocketType</span><span class="p">,</span>
    <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">bind</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">socket_ops</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the ZMQ Base class.</span>

<span class="sd">    Args:</span>
<span class="sd">        context (zmq.asyncio.Context): The ZMQ context.</span>
<span class="sd">        address (str): The address to bind or connect to.</span>
<span class="sd">        bind (bool): Whether to bind or connect the socket.</span>
<span class="sd">        socket_type (SocketType): The type of ZMQ socket (PUB or SUB).</span>
<span class="sd">        socket_ops (dict, optional): Additional socket options to set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">initialized_event</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">:</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span> <span class="o">=</span> <span class="n">context</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">address</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">bind</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">socket_type</span><span class="p">:</span> <span class="n">SocketType</span> <span class="o">=</span> <span class="n">socket_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_socket</span><span class="p">:</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Socket</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">socket_ops</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">socket_ops</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">socket_type</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_client_</span><span class="si">{</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_task_registry</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.clients.base.BaseZMQClient.initialize" class="doc doc-heading">
            <code class=" language-python"><span class="n">initialize</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.initialize" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize the communication, and start the tasks.</p>
<p>This method will:
- Create the zmq socket
- Bind or connect the socket to the address
- Set the socket options
- Run the AIPerfHooks.INIT hooks
- Start the tasks registered with the AIPerfHooks.TASK hooks</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/clients/base.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the communication, and start the tasks.</span>

<span class="sd">    This method will:</span>
<span class="sd">    - Create the zmq socket</span>
<span class="sd">    - Bind or connect the socket to the address</span>
<span class="sd">    - Set the socket options</span>
<span class="sd">    - Run the AIPerfHooks.INIT hooks</span>
<span class="sd">    - Start the tasks registered with the AIPerfHooks.TASK hooks</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_socket</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">socket_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;ZMQ </span><span class="si">%s</span><span class="s2"> socket initialized and bound to </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">socket_type_name</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;ZMQ </span><span class="si">%s</span><span class="s2"> socket initialized and connected to </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">socket_type_name</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">)</span>

        <span class="c1"># Set safe timeouts for send and receive operations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_socket</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">zmq</span><span class="o">.</span><span class="n">RCVTIMEO</span><span class="p">,</span> <span class="mi">30</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_socket</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">zmq</span><span class="o">.</span><span class="n">SNDTIMEO</span><span class="p">,</span> <span class="mi">30</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>

        <span class="c1"># Set additional socket options requested by the caller</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket_ops</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_socket</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">INIT</span><span class="p">)</span>

        <span class="c1"># Start all registered tasks</span>
        <span class="k">for</span> <span class="n">hook</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">TASK</span><span class="p">):</span>
            <span class="c1"># TODO: support task intervals</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_task_registry</span><span class="p">[</span><span class="n">hook</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">hook</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;ZMQ </span><span class="si">%s</span><span class="s2"> socket initialized and connected to </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">socket_type_name</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Exception initializing ZMQ socket: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">CommunicationInitializationError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.clients.base.BaseZMQClient.shutdown" class="doc doc-heading">
            <code class=" language-python"><span class="n">shutdown</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient.shutdown" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Shutdown the communication.</p>
<p>This method will:
- Close the zmq socket
- Run the AIPerfHooks.CLEANUP hooks
- Cancel all registered tasks</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/clients/base.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Shutdown the communication.</span>

<span class="sd">    This method will:</span>
<span class="sd">    - Close the zmq socket</span>
<span class="sd">    - Run the AIPerfHooks.CLEANUP hooks</span>
<span class="sd">    - Cancel all registered tasks</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_shutdown</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_socket</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;ZMQ </span><span class="si">%s</span><span class="s2"> socket closed (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket_type_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span>
            <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="s2">&quot;Exception shutting down ZMQ socket: </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="n">CommunicationShutdownError</span><span class="p">(</span><span class="s2">&quot;Failed to shutdown ZMQ socket&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">finally</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_socket</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">CLEANUP</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="s2">&quot;Exception cleaning up ZMQ socket: </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="n">CommunicationError</span><span class="p">(</span><span class="s2">&quot;Failed to cleanup ZMQ socket&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="c1"># Cancel all registered tasks</span>
    <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_task_registry</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>

    <span class="c1"># Wait for all tasks to complete</span>
    <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">suppress</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">):</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_task_registry</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_task_registry</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommoncommszmqclientsmetaclass">aiperf.common.comms.zmq.clients.metaclass<a class="headerlink" href="#aiperfcommoncommszmqclientsmetaclass" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.comms.zmq.clients.metaclass"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.common.comms.zmq.clients.metaclass.ZMQClientMetaclass" class="doc doc-heading">
            <code>ZMQClientMetaclass</code>


<a href="#aiperf.common.comms.zmq.clients.metaclass.ZMQClientMetaclass" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseMetaclass (aiperf.common.base_metaclass.BaseMetaclass)" href="#aiperf.common.base_metaclass.BaseMetaclass">BaseMetaclass</a></code></p>


        <p>Meta class for ZMQ clients.</p>
<p>This meta class is used to specify the supported hooks for ZMQ clients.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/comms/zmq/clients/metaclass.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@register_metaclass</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">INIT</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">CLEANUP</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">TASK</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ZMQClientMetaclass</span><span class="p">(</span><span class="n">BaseMetaclass</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Meta class for ZMQ clients.</span>

<span class="sd">    This meta class is used to specify the supported hooks for ZMQ clients.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommoncommszmqclientspub">aiperf.common.comms.zmq.clients.pub<a class="headerlink" href="#aiperfcommoncommszmqclientspub" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.comms.zmq.clients.pub"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.common.comms.zmq.clients.pub.ZMQPubClient" class="doc doc-heading">
            <code>ZMQPubClient</code>


<a href="#aiperf.common.comms.zmq.clients.pub.ZMQPubClient" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseZMQClient (aiperf.common.comms.zmq.clients.base.BaseZMQClient)" href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient">BaseZMQClient</a></code></p>








              <details class="quote">
                <summary>Source code in <code>aiperf/common/comms/zmq/clients/pub.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ZMQPubClient</span><span class="p">(</span><span class="n">BaseZMQClient</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span>
        <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">bind</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">socket_ops</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the ZMQ Publisher class.</span>

<span class="sd">        Args:</span>
<span class="sd">            context (zmq.asyncio.Context): The ZMQ context.</span>
<span class="sd">            address (str): The address to bind or connect to.</span>
<span class="sd">            bind (bool): Whether to bind or connect the socket.</span>
<span class="sd">            socket_ops (dict, optional): Additional socket options to set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">SocketType</span><span class="o">.</span><span class="n">PUB</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="n">socket_ops</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">publish</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Publish a message to a topic.</span>

<span class="sd">        Args:</span>
<span class="sd">            topic: Topic to publish to</span>
<span class="sd">            message: Message to publish (must be a Pydantic model)</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationNotInitializedError: If the client is not initialized</span>
<span class="sd">            CommunicationPublishError: If the message was not published successfully</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Serialize message using Pydantic&#39;s built-in method</span>
            <span class="n">message_json</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">()</span>

            <span class="c1"># Publish message</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">send_multipart</span><span class="p">([</span><span class="n">topic</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">message_json</span><span class="o">.</span><span class="n">encode</span><span class="p">()])</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Exception publishing message to topic </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">topic</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationPublishError</span><span class="p">(</span>
                <span class="s2">&quot;Failed to publish message to topic </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">topic</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.clients.pub.ZMQPubClient.__init__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="n">socket_ops</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#aiperf.common.comms.zmq.clients.pub.ZMQPubClient.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize the ZMQ Publisher class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><span title="zmq.asyncio.Context">Context</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ZMQ context.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>address</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The address to bind or connect to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bind</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to bind or connect the socket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>socket_ops</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional socket options to set.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/clients/pub.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span>
    <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">bind</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">socket_ops</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the ZMQ Publisher class.</span>

<span class="sd">    Args:</span>
<span class="sd">        context (zmq.asyncio.Context): The ZMQ context.</span>
<span class="sd">        address (str): The address to bind or connect to.</span>
<span class="sd">        bind (bool): Whether to bind or connect the socket.</span>
<span class="sd">        socket_ops (dict, optional): Additional socket options to set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">SocketType</span><span class="o">.</span><span class="n">PUB</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="n">socket_ops</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.clients.pub.ZMQPubClient.publish" class="doc doc-heading">
            <code class=" language-python"><span class="n">publish</span><span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.clients.pub.ZMQPubClient.publish" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Publish a message to a topic.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>topic</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Topic to publish to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Message to publish (must be a Pydantic model)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="CommunicationNotInitializedError">CommunicationNotInitializedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the client is not initialized</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationPublishError (aiperf.common.exceptions.CommunicationPublishError)" href="#aiperf.common.exceptions.CommunicationPublishError">CommunicationPublishError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the message was not published successfully</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/clients/pub.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">publish</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Publish a message to a topic.</span>

<span class="sd">    Args:</span>
<span class="sd">        topic: Topic to publish to</span>
<span class="sd">        message: Message to publish (must be a Pydantic model)</span>

<span class="sd">    Raises:</span>
<span class="sd">        CommunicationNotInitializedError: If the client is not initialized</span>
<span class="sd">        CommunicationPublishError: If the message was not published successfully</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Serialize message using Pydantic&#39;s built-in method</span>
        <span class="n">message_json</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">()</span>

        <span class="c1"># Publish message</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">send_multipart</span><span class="p">([</span><span class="n">topic</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">message_json</span><span class="o">.</span><span class="n">encode</span><span class="p">()])</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Exception publishing message to topic </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">topic</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">CommunicationPublishError</span><span class="p">(</span>
            <span class="s2">&quot;Failed to publish message to topic </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">topic</span>
        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommoncommszmqclientspull">aiperf.common.comms.zmq.clients.pull<a class="headerlink" href="#aiperfcommoncommszmqclientspull" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.comms.zmq.clients.pull"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.common.comms.zmq.clients.pull.ZMQPullClient" class="doc doc-heading">
            <code>ZMQPullClient</code>


<a href="#aiperf.common.comms.zmq.clients.pull.ZMQPullClient" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseZMQClient (aiperf.common.comms.zmq.clients.base.BaseZMQClient)" href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient">BaseZMQClient</a></code></p>








              <details class="quote">
                <summary>Source code in <code>aiperf/common/comms/zmq/clients/pull.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ZMQPullClient</span><span class="p">(</span><span class="n">BaseZMQClient</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span>
        <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">bind</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">socket_ops</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the ZMQ Puller class.</span>

<span class="sd">        Args:</span>
<span class="sd">            context (zmq.asyncio.Context): The ZMQ context.</span>
<span class="sd">            address (str): The address to bind or connect to.</span>
<span class="sd">            bind (bool): Whether to bind or connect the socket.</span>
<span class="sd">            socket_ops (dict, optional): Additional socket options to set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">SocketType</span><span class="o">.</span><span class="n">PULL</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="n">socket_ops</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pull_callbacks</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Message</span><span class="p">],</span> <span class="kc">None</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="nd">@aiperf_task</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_pull_receiver</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Background task for receiving data from the pull socket.</span>

<span class="sd">        This method is a coroutine that will run indefinitely until the client is</span>
<span class="sd">        shutdown. It will wait for messages from the socket and handle them.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_shutdown</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">:</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>

                <span class="c1"># Receive data</span>
                <span class="n">message_bytes</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
                <span class="n">message_json</span> <span class="o">=</span> <span class="n">message_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>

                <span class="c1"># Parse JSON into a BaseMessage object</span>
                <span class="n">message</span> <span class="o">=</span> <span class="n">BaseMessage</span><span class="o">.</span><span class="n">model_validate_json</span><span class="p">(</span><span class="n">message_json</span><span class="p">)</span>
                <span class="n">topic</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">message_type</span>

                <span class="c1"># Call callbacks with BaseMessage object</span>
                <span class="k">if</span> <span class="n">topic</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pull_callbacks</span><span class="p">:</span>
                    <span class="k">await</span> <span class="n">call_all_functions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pull_callbacks</span><span class="p">[</span><span class="n">topic</span><span class="p">],</span> <span class="n">message</span><span class="p">)</span>

            <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception receiving data from pull socket: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">pull</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">topic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Message</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a ZMQ Pull data callback from a source (topic).</span>

<span class="sd">        Args:</span>
<span class="sd">            topic: Topic (source) to pull data from</span>
<span class="sd">            callback: function to call when data is received.</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationNotInitializedError: If the client is not initialized</span>
<span class="sd">            CommunicationPullError: If an exception occurred registering the pull callback</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

        <span class="c1"># Register callback</span>
        <span class="k">if</span> <span class="n">topic</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pull_callbacks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pull_callbacks</span><span class="p">[</span><span class="n">topic</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pull_callbacks</span><span class="p">[</span><span class="n">topic</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.clients.pull.ZMQPullClient.__init__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="n">socket_ops</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#aiperf.common.comms.zmq.clients.pull.ZMQPullClient.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize the ZMQ Puller class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><span title="zmq.asyncio.Context">Context</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ZMQ context.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>address</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The address to bind or connect to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bind</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to bind or connect the socket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>socket_ops</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional socket options to set.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/clients/pull.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span>
    <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">bind</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">socket_ops</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the ZMQ Puller class.</span>

<span class="sd">    Args:</span>
<span class="sd">        context (zmq.asyncio.Context): The ZMQ context.</span>
<span class="sd">        address (str): The address to bind or connect to.</span>
<span class="sd">        bind (bool): Whether to bind or connect the socket.</span>
<span class="sd">        socket_ops (dict, optional): Additional socket options to set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">SocketType</span><span class="o">.</span><span class="n">PULL</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="n">socket_ops</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_pull_callbacks</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Message</span><span class="p">],</span> <span class="kc">None</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.clients.pull.ZMQPullClient.pull" class="doc doc-heading">
            <code class=" language-python"><span class="n">pull</span><span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.clients.pull.ZMQPullClient.pull" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Register a ZMQ Pull data callback from a source (topic).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>topic</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Topic (source) to pull data from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>callback</code>
            </td>
            <td>
                  <code><span title="collections.abc.Callable">Callable</span>[[<a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a>], None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>function to call when data is received.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="CommunicationNotInitializedError">CommunicationNotInitializedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the client is not initialized</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="CommunicationPullError">CommunicationPullError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If an exception occurred registering the pull callback</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/clients/pull.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">pull</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">topic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Message</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Register a ZMQ Pull data callback from a source (topic).</span>

<span class="sd">    Args:</span>
<span class="sd">        topic: Topic (source) to pull data from</span>
<span class="sd">        callback: function to call when data is received.</span>

<span class="sd">    Raises:</span>
<span class="sd">        CommunicationNotInitializedError: If the client is not initialized</span>
<span class="sd">        CommunicationPullError: If an exception occurred registering the pull callback</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

    <span class="c1"># Register callback</span>
    <span class="k">if</span> <span class="n">topic</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pull_callbacks</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pull_callbacks</span><span class="p">[</span><span class="n">topic</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_pull_callbacks</span><span class="p">[</span><span class="n">topic</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommoncommszmqclientspush">aiperf.common.comms.zmq.clients.push<a class="headerlink" href="#aiperfcommoncommszmqclientspush" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.comms.zmq.clients.push"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.common.comms.zmq.clients.push.ZMQPushClient" class="doc doc-heading">
            <code>ZMQPushClient</code>


<a href="#aiperf.common.comms.zmq.clients.push.ZMQPushClient" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseZMQClient (aiperf.common.comms.zmq.clients.base.BaseZMQClient)" href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient">BaseZMQClient</a></code></p>








              <details class="quote">
                <summary>Source code in <code>aiperf/common/comms/zmq/clients/push.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ZMQPushClient</span><span class="p">(</span><span class="n">BaseZMQClient</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span>
        <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">bind</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">socket_ops</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the ZMQ Pusher class.</span>

<span class="sd">        Args:</span>
<span class="sd">            context (zmq.asyncio.Context): The ZMQ context.</span>
<span class="sd">            address (str): The address to bind or connect to.</span>
<span class="sd">            bind (bool): Whether to bind or connect the socket.</span>
<span class="sd">            socket_ops (dict, optional): Additional socket options to set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">SocketType</span><span class="o">.</span><span class="n">PUSH</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="n">socket_ops</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Push data to a target.</span>

<span class="sd">        Args:</span>
<span class="sd">            message: Message to be sent must be a Message object</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationNotInitializedError: If the client is not initialized</span>
<span class="sd">            CommunicationPushError: If the data was not pushed successfully</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Serialize data directly using Pydantic&#39;s built-in method</span>
            <span class="n">data_json</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">()</span>

            <span class="c1"># Send data</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">send_string</span><span class="p">(</span><span class="n">data_json</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Pushed json data: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data_json</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception pushing data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationPushError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.clients.push.ZMQPushClient.__init__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="n">socket_ops</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#aiperf.common.comms.zmq.clients.push.ZMQPushClient.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize the ZMQ Pusher class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><span title="zmq.asyncio.Context">Context</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ZMQ context.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>address</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The address to bind or connect to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bind</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to bind or connect the socket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>socket_ops</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional socket options to set.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/clients/push.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span>
    <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">bind</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">socket_ops</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the ZMQ Pusher class.</span>

<span class="sd">    Args:</span>
<span class="sd">        context (zmq.asyncio.Context): The ZMQ context.</span>
<span class="sd">        address (str): The address to bind or connect to.</span>
<span class="sd">        bind (bool): Whether to bind or connect the socket.</span>
<span class="sd">        socket_ops (dict, optional): Additional socket options to set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">SocketType</span><span class="o">.</span><span class="n">PUSH</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="n">socket_ops</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.clients.push.ZMQPushClient.push" class="doc doc-heading">
            <code class=" language-python"><span class="n">push</span><span class="p">(</span><span class="n">message</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.clients.push.ZMQPushClient.push" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Push data to a target.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Message to be sent must be a Message object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="CommunicationNotInitializedError">CommunicationNotInitializedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the client is not initialized</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationPushError (aiperf.common.exceptions.CommunicationPushError)" href="#aiperf.common.exceptions.CommunicationPushError">CommunicationPushError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the data was not pushed successfully</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/clients/push.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Push data to a target.</span>

<span class="sd">    Args:</span>
<span class="sd">        message: Message to be sent must be a Message object</span>

<span class="sd">    Raises:</span>
<span class="sd">        CommunicationNotInitializedError: If the client is not initialized</span>
<span class="sd">        CommunicationPushError: If the data was not pushed successfully</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Serialize data directly using Pydantic&#39;s built-in method</span>
        <span class="n">data_json</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">()</span>

        <span class="c1"># Send data</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">send_string</span><span class="p">(</span><span class="n">data_json</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Pushed json data: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data_json</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception pushing data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">CommunicationPushError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommoncommszmqclientsrep">aiperf.common.comms.zmq.clients.rep<a class="headerlink" href="#aiperfcommoncommszmqclientsrep" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.comms.zmq.clients.rep"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.common.comms.zmq.clients.rep.ZMQRepClient" class="doc doc-heading">
            <code>ZMQRepClient</code>


<a href="#aiperf.common.comms.zmq.clients.rep.ZMQRepClient" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseZMQClient (aiperf.common.comms.zmq.clients.base.BaseZMQClient)" href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient">BaseZMQClient</a></code></p>








              <details class="quote">
                <summary>Source code in <code>aiperf/common/comms/zmq/clients/rep.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ZMQRepClient</span><span class="p">(</span><span class="n">BaseZMQClient</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span>
        <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">bind</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">socket_ops</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the ZMQ REP class.</span>

<span class="sd">        Args:</span>
<span class="sd">            context (zmq.asyncio.Context): The ZMQ context.</span>
<span class="sd">            address (str): The address to bind or connect to.</span>
<span class="sd">            bind (bool): Whether to bind or connect the socket.</span>
<span class="sd">            socket_ops (dict, optional): Additional socket options to set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">SocketType</span><span class="o">.</span><span class="n">REP</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="n">socket_ops</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_data</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="nd">@on_cleanup</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clean up any pending futures.&quot;&quot;&quot;</span>
        <span class="c1"># Resolve any pending futures with errors</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">future</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">future</span><span class="o">.</span><span class="n">done</span><span class="p">():</span>
                <span class="n">future</span><span class="o">.</span><span class="n">set_exception</span><span class="p">(</span><span class="ne">ConnectionError</span><span class="p">(</span><span class="s2">&quot;Socket was shut down&quot;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_data</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">wait_for_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Message</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait for a request to arrive.</span>

<span class="sd">        Args:</span>
<span class="sd">            timeout: Timeout in seconds or None for no timeout</span>

<span class="sd">        Returns:</span>
<span class="sd">            Message or Exception if request was not received successfully</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationNotInitializedError: If the client is not initialized</span>
<span class="sd">            CommunicationResponseError: If the request was not received successfully</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Create a future for the next request</span>
            <span class="n">request_id</span> <span class="o">=</span> <span class="s2">&quot;next_request&quot;</span>  <span class="c1"># Special ID for the next request</span>
            <span class="n">future</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span><span class="p">[</span><span class="n">request_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">future</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Wait for the request with optional timeout</span>
                <span class="k">if</span> <span class="n">timeout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">request_json</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">future</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">request_json</span> <span class="o">=</span> <span class="k">await</span> <span class="n">future</span>

                <span class="c1"># Parse the request</span>
                <span class="n">request</span> <span class="o">=</span> <span class="n">BaseMessage</span><span class="o">.</span><span class="n">model_validate_json</span><span class="p">(</span><span class="n">request_json</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">request</span>

            <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Timeout waiting for request&quot;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">CommunicationResponseError</span><span class="p">(</span><span class="s2">&quot;Timeout waiting for request&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception waiting for request: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">CommunicationResponseError</span><span class="p">(</span><span class="s2">&quot;Exception waiting for request&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

            <span class="k">finally</span><span class="p">:</span>
                <span class="c1"># Clean up future</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">request_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception waiting for request: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationResponseError</span><span class="p">(</span><span class="s2">&quot;Exception waiting for request&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">respond</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Send a response to a request.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Target component to send response to</span>
<span class="sd">            response: Response message (must be a Message instance)</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationNotInitializedError: If the client is not initialized</span>
<span class="sd">            CommunicationResponseError: If the response was not sent successfully</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Serialize response using Pydantic&#39;s built-in method</span>
            <span class="n">response_json</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">()</span>

            <span class="c1"># Send response</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">send_string</span><span class="p">(</span><span class="n">response_json</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception sending response to </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationResponseError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Exception sending response to </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="nd">@aiperf_task</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_rep_receiver</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Background task for receiving requests and sending responses.</span>

<span class="sd">        This method is a coroutine that will run indefinitely until the client is</span>
<span class="sd">        shutdown. It will wait for requests from the socket and send responses.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_shutdown</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">:</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>

                <span class="c1"># Receive request</span>
                <span class="n">request_json</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">recv_string</span><span class="p">()</span>

                <span class="c1"># Parse JSON to create RequestData object</span>
                <span class="n">request</span> <span class="o">=</span> <span class="n">BaseMessage</span><span class="o">.</span><span class="n">model_validate_json</span><span class="p">(</span><span class="n">request_json</span><span class="p">)</span>
                <span class="n">request_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">request_id</span>

                <span class="c1"># Store request data</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_response_data</span><span class="p">[</span><span class="n">request_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">request</span>

                <span class="c1"># Check for special &quot;next_request&quot; future</span>
                <span class="k">if</span> <span class="s2">&quot;next_request&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span><span class="p">:</span>
                    <span class="n">future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;next_request&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">future</span><span class="o">.</span><span class="n">done</span><span class="p">():</span>
                        <span class="n">future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="n">request_json</span><span class="p">)</span>
                <span class="c1"># Resolve future if it exists for the specific request ID</span>
                <span class="k">elif</span> <span class="n">request_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span><span class="p">:</span>
                    <span class="n">future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span><span class="p">[</span><span class="n">request_id</span><span class="p">]</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">future</span><span class="o">.</span><span class="n">done</span><span class="p">():</span>
                        <span class="n">future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="n">request_json</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception receiving request: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.clients.rep.ZMQRepClient.__init__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="n">socket_ops</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#aiperf.common.comms.zmq.clients.rep.ZMQRepClient.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize the ZMQ REP class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><span title="zmq.asyncio.Context">Context</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ZMQ context.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>address</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The address to bind or connect to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bind</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to bind or connect the socket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>socket_ops</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional socket options to set.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/clients/rep.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span>
    <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">bind</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">socket_ops</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the ZMQ REP class.</span>

<span class="sd">    Args:</span>
<span class="sd">        context (zmq.asyncio.Context): The ZMQ context.</span>
<span class="sd">        address (str): The address to bind or connect to.</span>
<span class="sd">        bind (bool): Whether to bind or connect the socket.</span>
<span class="sd">        socket_ops (dict, optional): Additional socket options to set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">SocketType</span><span class="o">.</span><span class="n">REP</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="n">socket_ops</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_response_data</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.clients.rep.ZMQRepClient.respond" class="doc doc-heading">
            <code class=" language-python"><span class="n">respond</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.clients.rep.ZMQRepClient.respond" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Send a response to a request.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>target</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target component to send response to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>response</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Response message (must be a Message instance)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="CommunicationNotInitializedError">CommunicationNotInitializedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the client is not initialized</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationResponseError (aiperf.common.exceptions.CommunicationResponseError)" href="#aiperf.common.exceptions.CommunicationResponseError">CommunicationResponseError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the response was not sent successfully</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/clients/rep.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">respond</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Send a response to a request.</span>

<span class="sd">    Args:</span>
<span class="sd">        target: Target component to send response to</span>
<span class="sd">        response: Response message (must be a Message instance)</span>

<span class="sd">    Raises:</span>
<span class="sd">        CommunicationNotInitializedError: If the client is not initialized</span>
<span class="sd">        CommunicationResponseError: If the response was not sent successfully</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Serialize response using Pydantic&#39;s built-in method</span>
        <span class="n">response_json</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">()</span>

        <span class="c1"># Send response</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">send_string</span><span class="p">(</span><span class="n">response_json</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception sending response to </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">CommunicationResponseError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Exception sending response to </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.clients.rep.ZMQRepClient.wait_for_request" class="doc doc-heading">
            <code class=" language-python"><span class="n">wait_for_request</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.clients.rep.ZMQRepClient.wait_for_request" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Wait for a request to arrive.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>timeout</code>
            </td>
            <td>
                  <code><span title="float">float</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timeout in seconds or None for no timeout</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Message or Exception if request was not received successfully</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="CommunicationNotInitializedError">CommunicationNotInitializedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the client is not initialized</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationResponseError (aiperf.common.exceptions.CommunicationResponseError)" href="#aiperf.common.exceptions.CommunicationResponseError">CommunicationResponseError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the request was not received successfully</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/clients/rep.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">wait_for_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Message</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wait for a request to arrive.</span>

<span class="sd">    Args:</span>
<span class="sd">        timeout: Timeout in seconds or None for no timeout</span>

<span class="sd">    Returns:</span>
<span class="sd">        Message or Exception if request was not received successfully</span>

<span class="sd">    Raises:</span>
<span class="sd">        CommunicationNotInitializedError: If the client is not initialized</span>
<span class="sd">        CommunicationResponseError: If the request was not received successfully</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Create a future for the next request</span>
        <span class="n">request_id</span> <span class="o">=</span> <span class="s2">&quot;next_request&quot;</span>  <span class="c1"># Special ID for the next request</span>
        <span class="n">future</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span><span class="p">[</span><span class="n">request_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">future</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Wait for the request with optional timeout</span>
            <span class="k">if</span> <span class="n">timeout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">request_json</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">future</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">request_json</span> <span class="o">=</span> <span class="k">await</span> <span class="n">future</span>

            <span class="c1"># Parse the request</span>
            <span class="n">request</span> <span class="o">=</span> <span class="n">BaseMessage</span><span class="o">.</span><span class="n">model_validate_json</span><span class="p">(</span><span class="n">request_json</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">request</span>

        <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Timeout waiting for request&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationResponseError</span><span class="p">(</span><span class="s2">&quot;Timeout waiting for request&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception waiting for request: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationResponseError</span><span class="p">(</span><span class="s2">&quot;Exception waiting for request&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="c1"># Clean up future</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">request_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception waiting for request: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">CommunicationResponseError</span><span class="p">(</span><span class="s2">&quot;Exception waiting for request&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommoncommszmqclientsreq">aiperf.common.comms.zmq.clients.req<a class="headerlink" href="#aiperfcommoncommszmqclientsreq" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.comms.zmq.clients.req"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.common.comms.zmq.clients.req.ZMQReqClient" class="doc doc-heading">
            <code>ZMQReqClient</code>


<a href="#aiperf.common.comms.zmq.clients.req.ZMQReqClient" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseZMQClient (aiperf.common.comms.zmq.clients.base.BaseZMQClient)" href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient">BaseZMQClient</a></code></p>








              <details class="quote">
                <summary>Source code in <code>aiperf/common/comms/zmq/clients/req.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ZMQReqClient</span><span class="p">(</span><span class="n">BaseZMQClient</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span>
        <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">bind</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">socket_ops</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the ZMQ Req class.</span>

<span class="sd">        Args:</span>
<span class="sd">            context (zmq.asyncio.Context): The ZMQ context.</span>
<span class="sd">            address (str): The address to bind or connect to.</span>
<span class="sd">            bind (bool): Whether to bind or connect the socket.</span>
<span class="sd">            socket_ops (dict, optional): Additional socket options to set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">SocketType</span><span class="o">.</span><span class="n">REQ</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="n">socket_ops</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="nd">@aiperf_task</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_process_messages</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process incoming response messages in the background.</span>

<span class="sd">        This method is a coroutine that will run indefinitely until the client is</span>
<span class="sd">        shutdown. It will wait for messages from the socket and handle them.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_shutdown</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">:</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>

                <span class="n">response_json</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">recv_string</span><span class="p">()</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_response</span><span class="p">(</span><span class="n">response_json</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception processing messages: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_handle_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response_json</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle a response message.</span>

<span class="sd">        Args:</span>
<span class="sd">            response_json: The JSON response string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">BaseMessage</span><span class="o">.</span><span class="n">model_validate_json</span><span class="p">(</span><span class="n">response_json</span><span class="p">)</span>
            <span class="n">request_id</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">request_id</span>

            <span class="k">if</span> <span class="n">request_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span><span class="p">:</span>
                <span class="n">future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span><span class="p">[</span><span class="n">request_id</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">future</span><span class="o">.</span><span class="n">done</span><span class="p">():</span>
                    <span class="n">future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="n">response_json</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Received response for unknown request ID: </span><span class="si">{</span><span class="n">request_id</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception handling response: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationRequestError</span><span class="p">(</span><span class="s2">&quot;Exception handling response&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="nd">@on_cleanup</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clean up any pending futures.&quot;&quot;&quot;</span>
        <span class="c1"># Resolve any pending futures with errors</span>
        <span class="k">for</span> <span class="n">request_id</span><span class="p">,</span> <span class="n">future</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">future</span><span class="o">.</span><span class="n">done</span><span class="p">():</span>
                <span class="n">error_response</span> <span class="o">=</span> <span class="n">BaseMessage</span><span class="p">(</span>
                    <span class="n">request_id</span><span class="o">=</span><span class="n">request_id</span><span class="p">,</span>
                    <span class="n">payload</span><span class="o">=</span><span class="n">ErrorPayload</span><span class="p">(</span>
                        <span class="n">error_message</span><span class="o">=</span><span class="s2">&quot;Socket was shut down&quot;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">)</span>
                <span class="n">future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="n">error_response</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">request_data</span><span class="p">:</span> <span class="n">Message</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Message</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Send a request and wait for a response.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Target component to send request to</span>
<span class="sd">            request_data: Request data (must be a RequestData instance)</span>
<span class="sd">            timeout: Timeout in seconds</span>

<span class="sd">        Returns:</span>
<span class="sd">            ResponseData object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Set target if not already set</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">request_data</span><span class="o">.</span><span class="n">target</span><span class="p">:</span>
                <span class="n">request_data</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="n">target</span>

            <span class="c1"># Ensure client_id is set</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">request_data</span><span class="o">.</span><span class="n">client_id</span><span class="p">:</span>
                <span class="n">request_data</span><span class="o">.</span><span class="n">client_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span>

            <span class="c1"># Generate request ID if not provided</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">request_data</span><span class="o">.</span><span class="n">request_id</span><span class="p">:</span>
                <span class="n">request_data</span><span class="o">.</span><span class="n">request_id</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span>

            <span class="c1"># Serialize request</span>
            <span class="n">request_json</span> <span class="o">=</span> <span class="n">request_data</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">()</span>

            <span class="c1"># Create future for response</span>
            <span class="n">future</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span><span class="p">[</span><span class="n">request_data</span><span class="o">.</span><span class="n">request_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">future</span>

            <span class="c1"># Send request</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">send_string</span><span class="p">(</span><span class="n">request_json</span><span class="p">)</span>

            <span class="c1"># Wait for response with timeout</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">response_json</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">future</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
                <span class="n">response</span> <span class="o">=</span> <span class="n">BaseMessage</span><span class="o">.</span><span class="n">model_validate_json</span><span class="p">(</span><span class="n">response_json</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">response</span>

            <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Timeout waiting for response to request </span><span class="si">{</span><span class="n">request_data</span><span class="o">.</span><span class="n">request_id</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="k">raise</span> <span class="n">CommunicationRequestError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Timeout waiting for response to request </span><span class="si">{</span><span class="n">request_data</span><span class="o">.</span><span class="n">request_id</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

            <span class="k">finally</span><span class="p">:</span>
                <span class="c1"># Clean up future</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">request_data</span><span class="o">.</span><span class="n">request_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception sending request to </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationRequestError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Exception sending request to </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.clients.req.ZMQReqClient.__init__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="n">socket_ops</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#aiperf.common.comms.zmq.clients.req.ZMQReqClient.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize the ZMQ Req class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><span title="zmq.asyncio.Context">Context</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ZMQ context.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>address</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The address to bind or connect to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bind</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to bind or connect the socket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>socket_ops</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional socket options to set.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/clients/req.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span>
    <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">bind</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">socket_ops</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the ZMQ Req class.</span>

<span class="sd">    Args:</span>
<span class="sd">        context (zmq.asyncio.Context): The ZMQ context.</span>
<span class="sd">        address (str): The address to bind or connect to.</span>
<span class="sd">        bind (bool): Whether to bind or connect the socket.</span>
<span class="sd">        socket_ops (dict, optional): Additional socket options to set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">SocketType</span><span class="o">.</span><span class="n">REQ</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="n">socket_ops</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.clients.req.ZMQReqClient.request" class="doc doc-heading">
            <code class=" language-python"><span class="n">request</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">request_data</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.clients.req.ZMQReqClient.request" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Send a request and wait for a response.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>target</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target component to send request to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>request_data</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Request data (must be a RequestData instance)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timeout</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timeout in seconds</p>
              </div>
            </td>
            <td>
                  <code>5.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ResponseData object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/clients/req.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">request</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">request_data</span><span class="p">:</span> <span class="n">Message</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Message</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Send a request and wait for a response.</span>

<span class="sd">    Args:</span>
<span class="sd">        target: Target component to send request to</span>
<span class="sd">        request_data: Request data (must be a RequestData instance)</span>
<span class="sd">        timeout: Timeout in seconds</span>

<span class="sd">    Returns:</span>
<span class="sd">        ResponseData object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Set target if not already set</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">request_data</span><span class="o">.</span><span class="n">target</span><span class="p">:</span>
            <span class="n">request_data</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="n">target</span>

        <span class="c1"># Ensure client_id is set</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">request_data</span><span class="o">.</span><span class="n">client_id</span><span class="p">:</span>
            <span class="n">request_data</span><span class="o">.</span><span class="n">client_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span>

        <span class="c1"># Generate request ID if not provided</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">request_data</span><span class="o">.</span><span class="n">request_id</span><span class="p">:</span>
            <span class="n">request_data</span><span class="o">.</span><span class="n">request_id</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span>

        <span class="c1"># Serialize request</span>
        <span class="n">request_json</span> <span class="o">=</span> <span class="n">request_data</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">()</span>

        <span class="c1"># Create future for response</span>
        <span class="n">future</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span><span class="p">[</span><span class="n">request_data</span><span class="o">.</span><span class="n">request_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">future</span>

        <span class="c1"># Send request</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">send_string</span><span class="p">(</span><span class="n">request_json</span><span class="p">)</span>

        <span class="c1"># Wait for response with timeout</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response_json</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">future</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">BaseMessage</span><span class="o">.</span><span class="n">model_validate_json</span><span class="p">(</span><span class="n">response_json</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span>

        <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Timeout waiting for response to request </span><span class="si">{</span><span class="n">request_data</span><span class="o">.</span><span class="n">request_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationRequestError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Timeout waiting for response to request </span><span class="si">{</span><span class="n">request_data</span><span class="o">.</span><span class="n">request_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="c1"># Clean up future</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_response_futures</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">request_data</span><span class="o">.</span><span class="n">request_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception sending request to </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">CommunicationRequestError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Exception sending request to </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommoncommszmqclientssub">aiperf.common.comms.zmq.clients.sub<a class="headerlink" href="#aiperfcommoncommszmqclientssub" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.comms.zmq.clients.sub"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.common.comms.zmq.clients.sub.ZMQSubClient" class="doc doc-heading">
            <code>ZMQSubClient</code>


<a href="#aiperf.common.comms.zmq.clients.sub.ZMQSubClient" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseZMQClient (aiperf.common.comms.zmq.clients.base.BaseZMQClient)" href="#aiperf.common.comms.zmq.clients.base.BaseZMQClient">BaseZMQClient</a></code></p>








              <details class="quote">
                <summary>Source code in <code>aiperf/common/comms/zmq/clients/sub.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ZMQSubClient</span><span class="p">(</span><span class="n">BaseZMQClient</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span>
        <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">bind</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">socket_ops</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the ZMQ Subscriber class.</span>

<span class="sd">        Args:</span>
<span class="sd">            context (zmq.asyncio.Context): The ZMQ context.</span>
<span class="sd">            address (str): The address to bind or connect to.</span>
<span class="sd">            bind (bool): Whether to bind or connect the socket.</span>
<span class="sd">            socket_ops (dict, optional): Additional socket options to set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">SocketType</span><span class="o">.</span><span class="n">SUB</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="n">socket_ops</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_subscribers</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Message</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">subscribe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Message</span><span class="p">],</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Subscribe to a topic.</span>

<span class="sd">        Args:</span>
<span class="sd">            topic: Topic to subscribe to</span>
<span class="sd">            callback: Function to call when a response is received (receives Message object)</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception if subscription was not successful, None otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Subscribe to topic</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">topic</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>

            <span class="c1"># Register callback</span>
            <span class="k">if</span> <span class="n">topic</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subscribers</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_subscribers</span><span class="p">[</span><span class="n">topic</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_subscribers</span><span class="p">[</span><span class="n">topic</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Subscribed to topic: </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">topic</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subscribers</span><span class="p">[</span><span class="n">topic</span><span class="p">])</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Exception subscribing to topic </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">topic</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationSubscribeError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="nd">@aiperf_task</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_sub_receiver</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Background task for receiving messages from subscribed topics.</span>

<span class="sd">        This method is a coroutine that will run indefinitely until the client is</span>
<span class="sd">        shutdown. It will wait for messages from the socket and handle them.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_shutdown</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                        <span class="s2">&quot;Sub client </span><span class="si">%s</span><span class="s2"> waiting for initialization&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span>
                    <span class="p">)</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Sub client </span><span class="si">%s</span><span class="s2"> initialized&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">)</span>

                <span class="c1"># Receive response</span>
                <span class="p">(</span>
                    <span class="n">topic_bytes</span><span class="p">,</span>
                    <span class="n">message_bytes</span><span class="p">,</span>
                <span class="p">)</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">recv_multipart</span><span class="p">()</span>
                <span class="n">topic</span> <span class="o">=</span> <span class="n">topic_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
                <span class="n">message_json</span> <span class="o">=</span> <span class="n">message_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="s2">&quot;Client </span><span class="si">%s</span><span class="s2"> received message from topic: &#39;</span><span class="si">%s</span><span class="s2">&#39;, message: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span>
                    <span class="n">topic</span><span class="p">,</span>
                    <span class="n">message_json</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="n">message</span> <span class="o">=</span> <span class="n">BaseMessage</span><span class="o">.</span><span class="n">model_validate_json</span><span class="p">(</span><span class="n">message_json</span><span class="p">)</span>

                <span class="c1"># Call callbacks with the parsed response object</span>
                <span class="k">if</span> <span class="n">topic</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subscribers</span><span class="p">:</span>
                    <span class="k">await</span> <span class="n">call_all_functions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_subscribers</span><span class="p">[</span><span class="n">topic</span><span class="p">],</span> <span class="n">message</span><span class="p">)</span>

            <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="n">zmq</span><span class="o">.</span><span class="n">Again</span><span class="p">:</span>
                <span class="c1"># Handle ZMQ timeout or interruption</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="s2">&quot;ZMQ recv timeout due to no messages. trying again @ </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="s2">&quot;Exception receiving response from subscription: </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">e</span><span class="p">,</span>
                    <span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.clients.sub.ZMQSubClient.__init__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="n">socket_ops</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#aiperf.common.comms.zmq.clients.sub.ZMQSubClient.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize the ZMQ Subscriber class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><span title="zmq.asyncio.Context">Context</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ZMQ context.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>address</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The address to bind or connect to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bind</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to bind or connect the socket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>socket_ops</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional socket options to set.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/clients/sub.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span>
    <span class="n">address</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">bind</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">socket_ops</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the ZMQ Subscriber class.</span>

<span class="sd">    Args:</span>
<span class="sd">        context (zmq.asyncio.Context): The ZMQ context.</span>
<span class="sd">        address (str): The address to bind or connect to.</span>
<span class="sd">        bind (bool): Whether to bind or connect the socket.</span>
<span class="sd">        socket_ops (dict, optional): Additional socket options to set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">SocketType</span><span class="o">.</span><span class="n">SUB</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">bind</span><span class="p">,</span> <span class="n">socket_ops</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_subscribers</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Message</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.clients.sub.ZMQSubClient.subscribe" class="doc doc-heading">
            <code class=" language-python"><span class="n">subscribe</span><span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.clients.sub.ZMQSubClient.subscribe" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Subscribe to a topic.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>topic</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Topic to subscribe to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>callback</code>
            </td>
            <td>
                  <code><span title="collections.abc.Callable">Callable</span>[[<a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a>], <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to call when a response is received (receives Message object)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/clients/sub.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">subscribe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Message</span><span class="p">],</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Subscribe to a topic.</span>

<span class="sd">    Args:</span>
<span class="sd">        topic: Topic to subscribe to</span>
<span class="sd">        callback: Function to call when a response is received (receives Message object)</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception if subscription was not successful, None otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Subscribe to topic</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">topic</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>

        <span class="c1"># Register callback</span>
        <span class="k">if</span> <span class="n">topic</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subscribers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_subscribers</span><span class="p">[</span><span class="n">topic</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_subscribers</span><span class="p">[</span><span class="n">topic</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Subscribed to topic: </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">topic</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subscribers</span><span class="p">[</span><span class="n">topic</span><span class="p">])</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Exception subscribing to topic </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">topic</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">CommunicationSubscribeError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommoncommszmqzmq_comms">aiperf.common.comms.zmq.zmq_comms<a class="headerlink" href="#aiperfcommoncommszmqzmq_comms" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.comms.zmq.zmq_comms"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.common.comms.zmq.zmq_comms.ZMQCommunication" class="doc doc-heading">
            <code>ZMQCommunication</code>


<a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseCommunication (aiperf.common.comms.base.BaseCommunication)" href="#aiperf.common.comms.base.BaseCommunication">BaseCommunication</a></code></p>


        <p>ZeroMQ-based implementation of the Communication interface.</p>
<p>Uses ZeroMQ for publish/subscribe and request/reply patterns to
facilitate communication between AIPerf components.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/comms/zmq/zmq_comms.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@CommunicationFactory</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">CommunicationBackend</span><span class="o">.</span><span class="n">ZMQ_TCP</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ZMQCommunication</span><span class="p">(</span><span class="n">BaseCommunication</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ZeroMQ-based implementation of the Communication interface.</span>

<span class="sd">    Uses ZeroMQ for publish/subscribe and request/reply patterns to</span>
<span class="sd">    facilitate communication between AIPerf components.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">config</span><span class="p">:</span> <span class="n">ZMQCommunicationConfig</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize ZMQ communication.</span>

<span class="sd">        Args:</span>
<span class="sd">            config: ZMQCommunicationConfig object with configuration parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialized_event</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span> <span class="ow">or</span> <span class="n">ZMQCommunicationConfig</span><span class="p">()</span>

        <span class="c1"># Generate client_id if not provided</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">client_id</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">client_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;client_</span><span class="si">{</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="p">:</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">ClientType</span><span class="p">,</span> <span class="n">ZMQClient</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;ZMQ communication using protocol: </span><span class="si">%s</span><span class="s2"> with client ID: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">protocol_config</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">context</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the ZeroMQ context.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ZeroMQ context</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CommunicationNotInitializedError</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_context</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_initialized</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if communication channels are initialized.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if communication channels are initialized, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if communication channels are shutdown.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if communication channels are shutdown, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize communication channels.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if initialization was successful, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_context</span> <span class="o">=</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gracefully shutdown communication channels.</span>

<span class="sd">        This method will wait for all clients to shutdown before shutting down</span>
<span class="sd">        the context.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if shutdown was successful, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_shutdown</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;ZMQ communication already shutdown&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Shutting down ZMQ communication for client </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">client_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
                <span class="o">*</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span> <span class="k">for</span> <span class="n">client</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">term</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_context</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;ZMQ communication shutdown successfully&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception shutting down ZMQ communication: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationShutdownError</span><span class="p">(</span>
                <span class="s2">&quot;Failed to shutdown ZMQ communication&quot;</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clients</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_context</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_ensure_initialized</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Ensure the communication channels are initialized.</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationNotInitializedError: If the communication channels are not</span>
<span class="sd">                initialized</span>
<span class="sd">            CommunicationShutdownError: If the communication channels are shutdown</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CommunicationNotInitializedError</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_shutdown</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CommunicationShutdownError</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_pub_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client_type</span><span class="p">:</span> <span class="n">PubClientType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ZMQPubClient</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a ZMQ publisher client based on the client type.</span>

<span class="sd">        Args:</span>
<span class="sd">            client_type: The type of client to create</span>

<span class="sd">        Returns:</span>
<span class="sd">            ZMQPubClient instance</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationClientCreationError: If the client type is invalid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">match</span> <span class="n">client_type</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">PubClientType</span><span class="o">.</span><span class="n">CONTROLLER</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ZMQPubClient</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">controller_pub_sub_address</span><span class="p">,</span>
                    <span class="n">bind</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">case</span> <span class="n">PubClientType</span><span class="o">.</span><span class="n">COMPONENT</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ZMQPubClient</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">component_pub_sub_address</span><span class="p">,</span>
                    <span class="n">bind</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CommunicationClientCreationError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid client type: </span><span class="si">{</span><span class="n">client_type</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_sub_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client_type</span><span class="p">:</span> <span class="n">SubClientType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ZMQSubClient</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a ZMQ subscriber client based on the client type.</span>

<span class="sd">        Args:</span>
<span class="sd">            client_type: The type of client to create</span>

<span class="sd">        Returns:</span>
<span class="sd">            ZMQSubClient instance</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationClientCreationError: If the client type is invalid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">match</span> <span class="n">client_type</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">SubClientType</span><span class="o">.</span><span class="n">CONTROLLER</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ZMQSubClient</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">controller_pub_sub_address</span><span class="p">,</span>
                    <span class="n">bind</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">case</span> <span class="n">SubClientType</span><span class="o">.</span><span class="n">COMPONENT</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ZMQSubClient</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">component_pub_sub_address</span><span class="p">,</span>
                    <span class="n">bind</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CommunicationClientCreationError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid client type: </span><span class="si">{</span><span class="n">client_type</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_push_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client_type</span><span class="p">:</span> <span class="n">PushClientType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ZMQPushClient</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a ZMQ push client based on the client type.</span>

<span class="sd">        Args:</span>
<span class="sd">            client_type: The type of client to create</span>

<span class="sd">        Returns:</span>
<span class="sd">            ZMQPushClient instance</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationClientCreationError: If the client type is invalid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">match</span> <span class="n">client_type</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">PushClientType</span><span class="o">.</span><span class="n">INFERENCE_RESULTS</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ZMQPushClient</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">inference_push_pull_address</span><span class="p">,</span>
                    <span class="n">bind</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Workers are the pushers</span>
                <span class="p">)</span>

            <span class="k">case</span> <span class="n">PushClientType</span><span class="o">.</span><span class="n">CREDIT_DROP</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ZMQPushClient</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">credit_drop_address</span><span class="p">,</span>
                    <span class="n">bind</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">case</span> <span class="n">PushClientType</span><span class="o">.</span><span class="n">CREDIT_RETURN</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ZMQPushClient</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">credit_return_address</span><span class="p">,</span>
                    <span class="n">bind</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">case</span> <span class="n">PushClientType</span><span class="o">.</span><span class="n">RECORDS</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ZMQPushClient</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">records_address</span><span class="p">,</span>
                    <span class="n">bind</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CommunicationClientCreationError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid client type: </span><span class="si">{</span><span class="n">client_type</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_pull_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client_type</span><span class="p">:</span> <span class="n">PullClientType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ZMQPullClient</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a ZMQ pull client based on the client type.</span>

<span class="sd">        Args:</span>
<span class="sd">            client_type: The type of client to create</span>

<span class="sd">        Returns:</span>
<span class="sd">            ZMQPullClient instance</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationClientCreationError: If the client type is invalid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">match</span> <span class="n">client_type</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">PullClientType</span><span class="o">.</span><span class="n">INFERENCE_RESULTS</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ZMQPullClient</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">inference_push_pull_address</span><span class="p">,</span>
                    <span class="n">bind</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Records manager is the pull</span>
                <span class="p">)</span>

            <span class="k">case</span> <span class="n">PullClientType</span><span class="o">.</span><span class="n">CREDIT_DROP</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ZMQPullClient</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">credit_drop_address</span><span class="p">,</span>
                    <span class="n">bind</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">case</span> <span class="n">PullClientType</span><span class="o">.</span><span class="n">CREDIT_RETURN</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ZMQPullClient</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">credit_return_address</span><span class="p">,</span>
                    <span class="n">bind</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">case</span> <span class="n">PushClientType</span><span class="o">.</span><span class="n">RECORDS</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ZMQPullClient</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">records_address</span><span class="p">,</span>
                    <span class="n">bind</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CommunicationClientCreationError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid client type: </span><span class="si">{</span><span class="n">client_type</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_req_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client_type</span><span class="p">:</span> <span class="n">ReqClientType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ZMQReqClient</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a ZMQ request client based on the client type.</span>

<span class="sd">        Args:</span>
<span class="sd">            client_type: The type of client to create</span>

<span class="sd">        Returns:</span>
<span class="sd">            ZMQReqClient instance</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationClientCreationError: If the client type is invalid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">match</span> <span class="n">client_type</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">ReqClientType</span><span class="o">.</span><span class="n">CONVERSATION_DATA</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ZMQReqClient</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">conversation_data_address</span><span class="p">,</span>
                    <span class="n">bind</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Worker manager is the request</span>
                <span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CommunicationClientCreationError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid client type: </span><span class="si">{</span><span class="n">client_type</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_rep_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client_type</span><span class="p">:</span> <span class="n">RepClientType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ZMQRepClient</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a ZMQ reply client based on the client type.</span>

<span class="sd">        Args:</span>
<span class="sd">            client_type: The type of client to create</span>

<span class="sd">        Returns:</span>
<span class="sd">            ZMQRepClient instance</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationClientCreationError: If the client type is invalid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">match</span> <span class="n">client_type</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">RepClientType</span><span class="o">.</span><span class="n">CONVERSATION_DATA</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ZMQRepClient</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">conversation_data_address</span><span class="p">,</span>
                    <span class="n">bind</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Data manager is the reply</span>
                <span class="p">)</span>

            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CommunicationClientCreationError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid client type: </span><span class="si">{</span><span class="n">client_type</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">create_clients</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">types</span><span class="p">:</span> <span class="n">ClientType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create and initialize ZMQ clients based on the client types.</span>

<span class="sd">        Args:</span>
<span class="sd">            types: List of ClientType enums indicating the types of clients to</span>
<span class="sd">            create and initialize</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationClientCreationError: If the clients were not created</span>
<span class="sd">                successfully</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">client_type</span> <span class="ow">in</span> <span class="n">types</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">client_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">client_type</span><span class="p">,</span> <span class="n">PubClientType</span><span class="p">):</span>
                <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_pub_client</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">client_type</span><span class="p">,</span> <span class="n">SubClientType</span><span class="p">):</span>
                <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_sub_client</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">client_type</span><span class="p">,</span> <span class="n">PushClientType</span><span class="p">):</span>
                <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_push_client</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">client_type</span><span class="p">,</span> <span class="n">PullClientType</span><span class="p">):</span>
                <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_pull_client</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">client_type</span><span class="p">,</span> <span class="n">ReqClientType</span><span class="p">):</span>
                <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_req_client</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">client_type</span><span class="p">,</span> <span class="n">RepClientType</span><span class="p">):</span>
                <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_rep_client</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">CommunicationClientCreationError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Invalid client type: </span><span class="si">{</span><span class="n">client_type</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">[</span><span class="n">client_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">client</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">publish</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Publish a message to a topic. If the client type is not found, it will</span>
<span class="sd">        be created.</span>

<span class="sd">        Args:</span>
<span class="sd">            topic: The topic to publish the message to</span>
<span class="sd">            message: The message to publish</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationPublishError: If the message was not published successfully</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>
        <span class="n">client_type</span> <span class="o">=</span> <span class="n">PubClientType</span><span class="o">.</span><span class="n">from_topic</span><span class="p">(</span><span class="n">topic</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">client_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Client type </span><span class="si">%s</span><span class="s2"> not found for pub topic </span><span class="si">%s</span><span class="s2">, creating client&quot;</span><span class="p">,</span>
                <span class="n">client_type</span><span class="p">,</span>
                <span class="n">topic</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_clients</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">[</span><span class="n">client_type</span><span class="p">]</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s2">&quot;Exception publishing message to topic: </span><span class="si">%s</span><span class="s2">, message: </span><span class="si">%s</span><span class="s2">, error: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">topic</span><span class="p">,</span>
                <span class="n">message</span><span class="p">,</span>
                <span class="n">e</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationPublishError</span><span class="p">()</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">subscribe</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Message</span><span class="p">],</span> <span class="n">Coroutine</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Subscribe to a topic. If the proper ZMQ client type is not found, it</span>
<span class="sd">        will be created.</span>

<span class="sd">        Args:</span>
<span class="sd">            topic: The topic to subscribe to</span>
<span class="sd">            callback: The callback to call when a message is received</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationSubscribeError: If there was an error subscribing to the</span>
<span class="sd">                topic</span>
<span class="sd">            CommunicationNotInitializedError: If the communication channels are not</span>
<span class="sd">                initialized</span>
<span class="sd">            CommunicationShutdownError: If the communication channels are shutdown</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

        <span class="n">client_type</span> <span class="o">=</span> <span class="n">SubClientType</span><span class="o">.</span><span class="n">from_topic</span><span class="p">(</span><span class="n">topic</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">client_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;Client type </span><span class="si">%s</span><span class="s2"> not found for sub topic </span><span class="si">%s</span><span class="s2">, creating client&quot;</span><span class="p">,</span>
                <span class="n">client_type</span><span class="p">,</span>
                <span class="n">topic</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_clients</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">[</span><span class="n">client_type</span><span class="p">]</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception subscribing to topic: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationSubscribeError</span><span class="p">()</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">request_data</span><span class="p">:</span> <span class="n">Message</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Message</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Request a message from a target. If the proper ZMQ client type is not</span>
<span class="sd">        found, it will be created.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: The target to request from</span>
<span class="sd">            request_data: The data to request</span>
<span class="sd">            timeout: The timeout for the request</span>

<span class="sd">        Returns:</span>
<span class="sd">            The response from the target</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationRequestError: If there was an error requesting from the</span>
<span class="sd">                target</span>
<span class="sd">            CommunicationNotInitializedError: If the communication channels are not</span>
<span class="sd">                initialized</span>
<span class="sd">            CommunicationShutdownError: If the communication channels are shutdown</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

        <span class="n">client_type</span> <span class="o">=</span> <span class="n">ReqClientType</span><span class="o">.</span><span class="n">from_topic</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">client_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Client type </span><span class="si">%s</span><span class="s2"> not found for req topic </span><span class="si">%s</span><span class="s2">, creating client&quot;</span><span class="p">,</span>
                <span class="n">client_type</span><span class="p">,</span>
                <span class="n">target</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_clients</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">[</span><span class="n">client_type</span><span class="p">]</span><span class="o">.</span><span class="n">request</span><span class="p">(</span>
                <span class="n">target</span><span class="p">,</span> <span class="n">request_data</span><span class="p">,</span> <span class="n">timeout</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception requesting from </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationRequestError</span><span class="p">()</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">respond</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Respond to a request. If the proper ZMQ client type is not found, it</span>
<span class="sd">        will be created.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: The target to respond to</span>
<span class="sd">            response: The response to send</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationRespondError: If there was an error responding to the</span>
<span class="sd">                target</span>
<span class="sd">            CommunicationNotInitializedError: If the communication channels are not</span>
<span class="sd">                initialized</span>
<span class="sd">            CommunicationShutdownError: If the communication channels are shutdown</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

        <span class="n">client_type</span> <span class="o">=</span> <span class="n">RepClientType</span><span class="o">.</span><span class="n">from_topic</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">client_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Client type </span><span class="si">%s</span><span class="s2"> not found for rep topic </span><span class="si">%s</span><span class="s2">, creating client&quot;</span><span class="p">,</span>
                <span class="n">client_type</span><span class="p">,</span>
                <span class="n">target</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_clients</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">[</span><span class="n">client_type</span><span class="p">]</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception responding to </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationResponseError</span><span class="p">()</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Push a message to a topic. If the proper ZMQ client type is not found,</span>
<span class="sd">        it will be created.</span>

<span class="sd">        Args:</span>
<span class="sd">            topic: The topic to push the message to</span>
<span class="sd">            message: The message to push</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationPushError: If there was an error pushing the message</span>
<span class="sd">            CommunicationNotInitializedError: If the communication channels are not</span>
<span class="sd">                initialized</span>
<span class="sd">            CommunicationShutdownError: If the communication channels are shutdown</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

        <span class="n">client_type</span> <span class="o">=</span> <span class="n">PushClientType</span><span class="o">.</span><span class="n">from_topic</span><span class="p">(</span><span class="n">topic</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">client_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Client type </span><span class="si">%s</span><span class="s2"> not found for push, creating client&quot;</span><span class="p">,</span>
                <span class="n">client_type</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_clients</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">[</span><span class="n">client_type</span><span class="p">]</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception pushing data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationPushError</span><span class="p">()</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">pull</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Message</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pull a message from a topic. If the proper ZMQ client type is not found,</span>
<span class="sd">        it will be created.</span>

<span class="sd">        Args:</span>
<span class="sd">            topic: The topic to pull the message from</span>
<span class="sd">            callback: The callback to call when a message is received</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationPullError: If there was an error pulling the message</span>
<span class="sd">            CommunicationNotInitializedError: If the communication channels are not</span>
<span class="sd">                initialized</span>
<span class="sd">            CommunicationShutdownError: If the communication channels are shutdown</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pulling data from </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

        <span class="n">client_type</span> <span class="o">=</span> <span class="n">PullClientType</span><span class="o">.</span><span class="n">from_topic</span><span class="p">(</span><span class="n">topic</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">client_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Client type </span><span class="si">%s</span><span class="s2"> not found for pull, creating client&quot;</span><span class="p">,</span>
                <span class="n">client_type</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_clients</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

        <span class="c1"># Only adds to the callback list, does not block, and does not raise an exception</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">[</span><span class="n">client_type</span><span class="p">]</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.context" class="doc doc-heading">
            <code class=" language-python"><span class="n">context</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.context" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the ZeroMQ context.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="zmq.asyncio.Context">Context</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ZeroMQ context</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.is_initialized" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_initialized</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.is_initialized" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if communication channels are initialized.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if communication channels are initialized, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.is_shutdown" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_shutdown</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.is_shutdown" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if communication channels are shutdown.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if communication channels are shutdown, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.__init__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize ZMQ communication.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ZMQCommunicationConfig (aiperf.common.models.ZMQCommunicationConfig)" href="#aiperf.common.models.ZMQCommunicationConfig">ZMQCommunicationConfig</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ZMQCommunicationConfig object with configuration parameters</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/zmq_comms.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">ZMQCommunicationConfig</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize ZMQ communication.</span>

<span class="sd">    Args:</span>
<span class="sd">        config: ZMQCommunicationConfig object with configuration parameters</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">initialized_event</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span> <span class="ow">or</span> <span class="n">ZMQCommunicationConfig</span><span class="p">()</span>

    <span class="c1"># Generate client_id if not provided</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">client_id</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">client_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;client_</span><span class="si">{</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="p">:</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">ClientType</span><span class="p">,</span> <span class="n">ZMQClient</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="s2">&quot;ZMQ communication using protocol: </span><span class="si">%s</span><span class="s2"> with client ID: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">protocol_config</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.create_clients" class="doc doc-heading">
            <code class=" language-python"><span class="n">create_clients</span><span class="p">(</span><span class="o">*</span><span class="n">types</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.create_clients" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create and initialize ZMQ clients based on the client types.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>types</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ClientType = Union[PubClientType, SubClientType, PushClientType, PullClientType, ReqClientType, RepClientType]

  
      module-attribute
   (aiperf.common.comms.client_enums.ClientType)" href="#aiperf.common.comms.client_enums.ClientType">ClientType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of ClientType enums indicating the types of clients to</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationClientCreationError (aiperf.common.exceptions.CommunicationClientCreationError)" href="#aiperf.common.exceptions.CommunicationClientCreationError">CommunicationClientCreationError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the clients were not created
successfully</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/zmq_comms.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">create_clients</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">types</span><span class="p">:</span> <span class="n">ClientType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create and initialize ZMQ clients based on the client types.</span>

<span class="sd">    Args:</span>
<span class="sd">        types: List of ClientType enums indicating the types of clients to</span>
<span class="sd">        create and initialize</span>

<span class="sd">    Raises:</span>
<span class="sd">        CommunicationClientCreationError: If the clients were not created</span>
<span class="sd">            successfully</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">client_type</span> <span class="ow">in</span> <span class="n">types</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">client_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">client_type</span><span class="p">,</span> <span class="n">PubClientType</span><span class="p">):</span>
            <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_pub_client</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">client_type</span><span class="p">,</span> <span class="n">SubClientType</span><span class="p">):</span>
            <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_sub_client</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">client_type</span><span class="p">,</span> <span class="n">PushClientType</span><span class="p">):</span>
            <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_push_client</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">client_type</span><span class="p">,</span> <span class="n">PullClientType</span><span class="p">):</span>
            <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_pull_client</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">client_type</span><span class="p">,</span> <span class="n">ReqClientType</span><span class="p">):</span>
            <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_req_client</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">client_type</span><span class="p">,</span> <span class="n">RepClientType</span><span class="p">):</span>
            <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_rep_client</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CommunicationClientCreationError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid client type: </span><span class="si">{</span><span class="n">client_type</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">await</span> <span class="n">client</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">[</span><span class="n">client_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">client</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.initialize" class="doc doc-heading">
            <code class=" language-python"><span class="n">initialize</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.initialize" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize communication channels.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if initialization was successful, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/zmq_comms.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize communication channels.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if initialization was successful, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_context</span> <span class="o">=</span> <span class="n">zmq</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Context</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.publish" class="doc doc-heading">
            <code class=" language-python"><span class="n">publish</span><span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.publish" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Publish a message to a topic. If the client type is not found, it will
be created.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>topic</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TopicType = Topic | DataTopic

  
      module-attribute
   (aiperf.common.enums.TopicType)" href="#aiperf.common.enums.TopicType">TopicType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The topic to publish the message to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The message to publish</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationPublishError (aiperf.common.exceptions.CommunicationPublishError)" href="#aiperf.common.exceptions.CommunicationPublishError">CommunicationPublishError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the message was not published successfully</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/zmq_comms.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">publish</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Publish a message to a topic. If the client type is not found, it will</span>
<span class="sd">    be created.</span>

<span class="sd">    Args:</span>
<span class="sd">        topic: The topic to publish the message to</span>
<span class="sd">        message: The message to publish</span>

<span class="sd">    Raises:</span>
<span class="sd">        CommunicationPublishError: If the message was not published successfully</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>
    <span class="n">client_type</span> <span class="o">=</span> <span class="n">PubClientType</span><span class="o">.</span><span class="n">from_topic</span><span class="p">(</span><span class="n">topic</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">client_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Client type </span><span class="si">%s</span><span class="s2"> not found for pub topic </span><span class="si">%s</span><span class="s2">, creating client&quot;</span><span class="p">,</span>
            <span class="n">client_type</span><span class="p">,</span>
            <span class="n">topic</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_clients</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">[</span><span class="n">client_type</span><span class="p">]</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="s2">&quot;Exception publishing message to topic: </span><span class="si">%s</span><span class="s2">, message: </span><span class="si">%s</span><span class="s2">, error: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">topic</span><span class="p">,</span>
            <span class="n">message</span><span class="p">,</span>
            <span class="n">e</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="n">CommunicationPublishError</span><span class="p">()</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.pull" class="doc doc-heading">
            <code class=" language-python"><span class="n">pull</span><span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.pull" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Pull a message from a topic. If the proper ZMQ client type is not found,
it will be created.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>topic</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TopicType = Topic | DataTopic

  
      module-attribute
   (aiperf.common.enums.TopicType)" href="#aiperf.common.enums.TopicType">TopicType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The topic to pull the message from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>callback</code>
            </td>
            <td>
                  <code><span title="collections.abc.Callable">Callable</span>[[<a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a>], None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The callback to call when a message is received</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="CommunicationPullError">CommunicationPullError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there was an error pulling the message</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationNotInitializedError (aiperf.common.exceptions.CommunicationNotInitializedError)" href="#aiperf.common.exceptions.CommunicationNotInitializedError">CommunicationNotInitializedError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the communication channels are not
initialized</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationShutdownError (aiperf.common.exceptions.CommunicationShutdownError)" href="#aiperf.common.exceptions.CommunicationShutdownError">CommunicationShutdownError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the communication channels are shutdown</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/zmq_comms.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">pull</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">,</span>
    <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Message</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pull a message from a topic. If the proper ZMQ client type is not found,</span>
<span class="sd">    it will be created.</span>

<span class="sd">    Args:</span>
<span class="sd">        topic: The topic to pull the message from</span>
<span class="sd">        callback: The callback to call when a message is received</span>

<span class="sd">    Raises:</span>
<span class="sd">        CommunicationPullError: If there was an error pulling the message</span>
<span class="sd">        CommunicationNotInitializedError: If the communication channels are not</span>
<span class="sd">            initialized</span>
<span class="sd">        CommunicationShutdownError: If the communication channels are shutdown</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pulling data from </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

    <span class="n">client_type</span> <span class="o">=</span> <span class="n">PullClientType</span><span class="o">.</span><span class="n">from_topic</span><span class="p">(</span><span class="n">topic</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">client_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Client type </span><span class="si">%s</span><span class="s2"> not found for pull, creating client&quot;</span><span class="p">,</span>
            <span class="n">client_type</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_clients</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

    <span class="c1"># Only adds to the callback list, does not block, and does not raise an exception</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">[</span><span class="n">client_type</span><span class="p">]</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.push" class="doc doc-heading">
            <code class=" language-python"><span class="n">push</span><span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.push" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Push a message to a topic. If the proper ZMQ client type is not found,
it will be created.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>topic</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TopicType = Topic | DataTopic

  
      module-attribute
   (aiperf.common.enums.TopicType)" href="#aiperf.common.enums.TopicType">TopicType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The topic to push the message to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The message to push</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationPushError (aiperf.common.exceptions.CommunicationPushError)" href="#aiperf.common.exceptions.CommunicationPushError">CommunicationPushError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there was an error pushing the message</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationNotInitializedError (aiperf.common.exceptions.CommunicationNotInitializedError)" href="#aiperf.common.exceptions.CommunicationNotInitializedError">CommunicationNotInitializedError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the communication channels are not
initialized</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationShutdownError (aiperf.common.exceptions.CommunicationShutdownError)" href="#aiperf.common.exceptions.CommunicationShutdownError">CommunicationShutdownError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the communication channels are shutdown</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/zmq_comms.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Push a message to a topic. If the proper ZMQ client type is not found,</span>
<span class="sd">    it will be created.</span>

<span class="sd">    Args:</span>
<span class="sd">        topic: The topic to push the message to</span>
<span class="sd">        message: The message to push</span>

<span class="sd">    Raises:</span>
<span class="sd">        CommunicationPushError: If there was an error pushing the message</span>
<span class="sd">        CommunicationNotInitializedError: If the communication channels are not</span>
<span class="sd">            initialized</span>
<span class="sd">        CommunicationShutdownError: If the communication channels are shutdown</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

    <span class="n">client_type</span> <span class="o">=</span> <span class="n">PushClientType</span><span class="o">.</span><span class="n">from_topic</span><span class="p">(</span><span class="n">topic</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">client_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Client type </span><span class="si">%s</span><span class="s2"> not found for push, creating client&quot;</span><span class="p">,</span>
            <span class="n">client_type</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_clients</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">[</span><span class="n">client_type</span><span class="p">]</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception pushing data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">CommunicationPushError</span><span class="p">()</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.request" class="doc doc-heading">
            <code class=" language-python"><span class="n">request</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">request_data</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.request" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Request a message from a target. If the proper ZMQ client type is not
found, it will be created.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>target</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target to request from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>request_data</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data to request</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timeout</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The timeout for the request</p>
              </div>
            </td>
            <td>
                  <code>5.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The response from the target</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationRequestError (aiperf.common.exceptions.CommunicationRequestError)" href="#aiperf.common.exceptions.CommunicationRequestError">CommunicationRequestError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there was an error requesting from the
target</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationNotInitializedError (aiperf.common.exceptions.CommunicationNotInitializedError)" href="#aiperf.common.exceptions.CommunicationNotInitializedError">CommunicationNotInitializedError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the communication channels are not
initialized</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationShutdownError (aiperf.common.exceptions.CommunicationShutdownError)" href="#aiperf.common.exceptions.CommunicationShutdownError">CommunicationShutdownError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the communication channels are shutdown</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/zmq_comms.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">request</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">request_data</span><span class="p">:</span> <span class="n">Message</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Message</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Request a message from a target. If the proper ZMQ client type is not</span>
<span class="sd">    found, it will be created.</span>

<span class="sd">    Args:</span>
<span class="sd">        target: The target to request from</span>
<span class="sd">        request_data: The data to request</span>
<span class="sd">        timeout: The timeout for the request</span>

<span class="sd">    Returns:</span>
<span class="sd">        The response from the target</span>

<span class="sd">    Raises:</span>
<span class="sd">        CommunicationRequestError: If there was an error requesting from the</span>
<span class="sd">            target</span>
<span class="sd">        CommunicationNotInitializedError: If the communication channels are not</span>
<span class="sd">            initialized</span>
<span class="sd">        CommunicationShutdownError: If the communication channels are shutdown</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

    <span class="n">client_type</span> <span class="o">=</span> <span class="n">ReqClientType</span><span class="o">.</span><span class="n">from_topic</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">client_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Client type </span><span class="si">%s</span><span class="s2"> not found for req topic </span><span class="si">%s</span><span class="s2">, creating client&quot;</span><span class="p">,</span>
            <span class="n">client_type</span><span class="p">,</span>
            <span class="n">target</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_clients</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">[</span><span class="n">client_type</span><span class="p">]</span><span class="o">.</span><span class="n">request</span><span class="p">(</span>
            <span class="n">target</span><span class="p">,</span> <span class="n">request_data</span><span class="p">,</span> <span class="n">timeout</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception requesting from </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">CommunicationRequestError</span><span class="p">()</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.respond" class="doc doc-heading">
            <code class=" language-python"><span class="n">respond</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.respond" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Respond to a request. If the proper ZMQ client type is not found, it
will be created.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>target</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target to respond to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>response</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The response to send</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="CommunicationRespondError">CommunicationRespondError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there was an error responding to the
target</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationNotInitializedError (aiperf.common.exceptions.CommunicationNotInitializedError)" href="#aiperf.common.exceptions.CommunicationNotInitializedError">CommunicationNotInitializedError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the communication channels are not
initialized</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationShutdownError (aiperf.common.exceptions.CommunicationShutdownError)" href="#aiperf.common.exceptions.CommunicationShutdownError">CommunicationShutdownError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the communication channels are shutdown</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/zmq_comms.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">respond</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Respond to a request. If the proper ZMQ client type is not found, it</span>
<span class="sd">    will be created.</span>

<span class="sd">    Args:</span>
<span class="sd">        target: The target to respond to</span>
<span class="sd">        response: The response to send</span>

<span class="sd">    Raises:</span>
<span class="sd">        CommunicationRespondError: If there was an error responding to the</span>
<span class="sd">            target</span>
<span class="sd">        CommunicationNotInitializedError: If the communication channels are not</span>
<span class="sd">            initialized</span>
<span class="sd">        CommunicationShutdownError: If the communication channels are shutdown</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

    <span class="n">client_type</span> <span class="o">=</span> <span class="n">RepClientType</span><span class="o">.</span><span class="n">from_topic</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">client_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Client type </span><span class="si">%s</span><span class="s2"> not found for rep topic </span><span class="si">%s</span><span class="s2">, creating client&quot;</span><span class="p">,</span>
            <span class="n">client_type</span><span class="p">,</span>
            <span class="n">target</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_clients</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">[</span><span class="n">client_type</span><span class="p">]</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception responding to </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">CommunicationResponseError</span><span class="p">()</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.shutdown" class="doc doc-heading">
            <code class=" language-python"><span class="n">shutdown</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.shutdown" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Gracefully shutdown communication channels.</p>
<p>This method will wait for all clients to shutdown before shutting down
the context.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if shutdown was successful, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/zmq_comms.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gracefully shutdown communication channels.</span>

<span class="sd">    This method will wait for all clients to shutdown before shutting down</span>
<span class="sd">    the context.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if shutdown was successful, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_shutdown</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;ZMQ communication already shutdown&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Shutting down ZMQ communication for client </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">client_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
            <span class="o">*</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span> <span class="k">for</span> <span class="n">client</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">term</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_context</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;ZMQ communication shutdown successfully&quot;</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception shutting down ZMQ communication: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">CommunicationShutdownError</span><span class="p">(</span>
            <span class="s2">&quot;Failed to shutdown ZMQ communication&quot;</span>
        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">finally</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clients</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_context</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.subscribe" class="doc doc-heading">
            <code class=" language-python"><span class="n">subscribe</span><span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.comms.zmq.zmq_comms.ZMQCommunication.subscribe" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Subscribe to a topic. If the proper ZMQ client type is not found, it
will be created.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>topic</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TopicType = Topic | DataTopic

  
      module-attribute
   (aiperf.common.enums.TopicType)" href="#aiperf.common.enums.TopicType">TopicType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The topic to subscribe to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>callback</code>
            </td>
            <td>
                  <code><span title="collections.abc.Callable">Callable</span>[[<a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a>], <span title="collections.abc.Coroutine">Coroutine</span>[<span title="typing.Any">Any</span>, <span title="typing.Any">Any</span>, None]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The callback to call when a message is received</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationSubscribeError (aiperf.common.exceptions.CommunicationSubscribeError)" href="#aiperf.common.exceptions.CommunicationSubscribeError">CommunicationSubscribeError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there was an error subscribing to the
topic</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationNotInitializedError (aiperf.common.exceptions.CommunicationNotInitializedError)" href="#aiperf.common.exceptions.CommunicationNotInitializedError">CommunicationNotInitializedError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the communication channels are not
initialized</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommunicationShutdownError (aiperf.common.exceptions.CommunicationShutdownError)" href="#aiperf.common.exceptions.CommunicationShutdownError">CommunicationShutdownError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the communication channels are shutdown</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/comms/zmq/zmq_comms.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">subscribe</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">topic</span><span class="p">:</span> <span class="n">TopicType</span><span class="p">,</span>
    <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Message</span><span class="p">],</span> <span class="n">Coroutine</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Subscribe to a topic. If the proper ZMQ client type is not found, it</span>
<span class="sd">    will be created.</span>

<span class="sd">    Args:</span>
<span class="sd">        topic: The topic to subscribe to</span>
<span class="sd">        callback: The callback to call when a message is received</span>

<span class="sd">    Raises:</span>
<span class="sd">        CommunicationSubscribeError: If there was an error subscribing to the</span>
<span class="sd">            topic</span>
<span class="sd">        CommunicationNotInitializedError: If the communication channels are not</span>
<span class="sd">            initialized</span>
<span class="sd">        CommunicationShutdownError: If the communication channels are shutdown</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_initialized</span><span class="p">()</span>

    <span class="n">client_type</span> <span class="o">=</span> <span class="n">SubClientType</span><span class="o">.</span><span class="n">from_topic</span><span class="p">(</span><span class="n">topic</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">client_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;Client type </span><span class="si">%s</span><span class="s2"> not found for sub topic </span><span class="si">%s</span><span class="s2">, creating client&quot;</span><span class="p">,</span>
            <span class="n">client_type</span><span class="p">,</span>
            <span class="n">topic</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_clients</span><span class="p">(</span><span class="n">client_type</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">clients</span><span class="p">[</span><span class="n">client_type</span><span class="p">]</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception subscribing to topic: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">CommunicationSubscribeError</span><span class="p">()</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommonconfigloader">aiperf.common.config.loader<a class="headerlink" href="#aiperfcommonconfigloader" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.config.loader"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="aiperf.common.config.loader.load_service_config" class="doc doc-heading">
            <code class=" language-python"><span class="n">load_service_config</span><span class="p">()</span></code>

<a href="#aiperf.common.config.loader.load_service_config" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Load the service configuration.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/config/loader.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_service_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">ServiceConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the service configuration.&quot;&quot;&quot;</span>
    <span class="c1"># TODO: implement</span>
    <span class="k">return</span> <span class="n">ServiceConfig</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="aiperfcommonconfigservice_config">aiperf.common.config.service_config<a class="headerlink" href="#aiperfcommonconfigservice_config" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.config.service_config"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.common.config.service_config.ServiceConfig" class="doc doc-heading">
            <code>ServiceConfig</code>


<a href="#aiperf.common.config.service_config.ServiceConfig" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Base configuration for all services.</p>
<p>This class provides the common configuration parameters needed by all services.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/config/service_config.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ServiceConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base configuration for all services.</span>

<span class="sd">    This class provides the common configuration parameters needed by all services.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># TODO: this needs to be cleaned up and finalized</span>

    <span class="n">service_run_type</span><span class="p">:</span> <span class="n">ServiceRunType</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="n">ServiceRunType</span><span class="o">.</span><span class="n">MULTIPROCESSING</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Type of service run (MULTIPROCESSING, KUBERNETES)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">comm_backend</span><span class="p">:</span> <span class="n">CommunicationBackend</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="n">CommunicationBackend</span><span class="o">.</span><span class="n">ZMQ_TCP</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Communication backend to use&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">heartbeat_timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Time in seconds after which a service is considered dead if no &quot;</span>
        <span class="s2">&quot;heartbeat received&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">registration_timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Time in seconds to wait for all required services to register&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">command_timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Default timeout for command responses&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">heartbeat_interval</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Interval in seconds between heartbeat messages&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">min_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Minimum number of idle workers to maintain&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">max_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Maximum number of workers to create&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">target_idle_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Target number of idle workers to maintain&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommondecorators">aiperf.common.decorators<a class="headerlink" href="#aiperfcommondecorators" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.decorators"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.common.decorators.AIPerfHooks" class="doc doc-heading">
            <code>AIPerfHooks</code>


<a href="#aiperf.common.decorators.AIPerfHooks" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StrEnum (aiperf.common.enums.StrEnum)" href="#aiperf.common.enums.StrEnum">StrEnum</a></code></p>


        <p>Internal constants for the various AIPerf decorators.</p>
<p>Note: If you add a new hook, you must also add it to the @register_metaclass
decorators in the metaclasses you wish to use the hook in.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/decorators.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AIPerfHooks</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Internal constants for the various AIPerf decorators.</span>

<span class="sd">    Note: If you add a new hook, you must also add it to the @register_metaclass</span>
<span class="sd">    decorators in the metaclasses you wish to use the hook in.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">HOOK_TYPE</span> <span class="o">=</span> <span class="s2">&quot;__aiperf_hook_type__&quot;</span>

    <span class="n">CLEANUP</span> <span class="o">=</span> <span class="s2">&quot;__aiperf_on_cleanup__&quot;</span>
    <span class="n">INIT</span> <span class="o">=</span> <span class="s2">&quot;__aiperf_on_init__&quot;</span>
    <span class="n">COMMS_INIT</span> <span class="o">=</span> <span class="s2">&quot;__aiperf_on_comms_init__&quot;</span>
    <span class="n">STOP</span> <span class="o">=</span> <span class="s2">&quot;__aiperf_on_stop__&quot;</span>
    <span class="n">START</span> <span class="o">=</span> <span class="s2">&quot;__aiperf_on_start__&quot;</span>
    <span class="n">CONFIGURE</span> <span class="o">=</span> <span class="s2">&quot;__aiperf_on_configure__&quot;</span>
    <span class="n">RUN</span> <span class="o">=</span> <span class="s2">&quot;__aiperf_on_run__&quot;</span>
    <span class="n">TASK</span> <span class="o">=</span> <span class="s2">&quot;__aiperf_task__&quot;</span>
    <span class="n">TASK_INTERVAL</span> <span class="o">=</span> <span class="s2">&quot;__aiperf_task_interval__&quot;</span>
    <span class="n">SET_STATE</span> <span class="o">=</span> <span class="s2">&quot;__aiperf_on_set_state__&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="aiperf.common.decorators.aiperf_task" class="doc doc-heading">
            <code class=" language-python"><span class="n">aiperf_task</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#aiperf.common.decorators.aiperf_task" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Decorator to indicate that the function is a task function. It will be
started automatically and stopped when the service shuts down.</p>
<p>It allows a derived class to run any tasks specific to that class. An
interval can be provided to indicate the frequency at which the task should
be run, otherwise it will run once.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><span title="collections.abc.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to decorate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code><span title="float">float</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The interval at which the task should be run. If the interval is
None, the task will be run once.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/decorators.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">aiperf_task</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decorator to indicate that the function is a task function. It will be</span>
<span class="sd">    started automatically and stopped when the service shuts down.</span>

<span class="sd">    It allows a derived class to run any tasks specific to that class. An</span>
<span class="sd">    interval can be provided to indicate the frequency at which the task should</span>
<span class="sd">    be run, otherwise it will run once.</span>

<span class="sd">    Args:</span>
<span class="sd">        func: The function to decorate.</span>
<span class="sd">        interval: The interval at which the task should be run. If the interval is</span>
<span class="sd">            None, the task will be run once.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: task intervals are not supported yet</span>

    <span class="nb">setattr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">HOOK_TYPE</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">TASK</span><span class="p">)</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">TASK_INTERVAL</span><span class="p">,</span> <span class="n">interval</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="aiperf.common.decorators.on_cleanup" class="doc doc-heading">
            <code class=" language-python"><span class="n">on_cleanup</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

<a href="#aiperf.common.decorators.on_cleanup" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Decorator to specify that the function should be called during
cleanup.</p>
<p>It will be called during the service shutdown to allow the derived service to
clean up any resources specific to that service.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/decorators.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">on_cleanup</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decorator to specify that the function should be called during</span>
<span class="sd">    cleanup.</span>

<span class="sd">    It will be called during the service shutdown to allow the derived service to</span>
<span class="sd">    clean up any resources specific to that service.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">setattr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">HOOK_TYPE</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">CLEANUP</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="aiperf.common.decorators.on_comms_init" class="doc doc-heading">
            <code class=" language-python"><span class="n">on_comms_init</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

<a href="#aiperf.common.decorators.on_comms_init" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Decorator to specify that the function should be called during
communication initialization.</p>
<p>It will be called after the communication is initialized to allow the derived
classes to set up any resources specific to that subclass.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/decorators.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">on_comms_init</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decorator to specify that the function should be called during</span>
<span class="sd">    communication initialization.</span>

<span class="sd">    It will be called after the communication is initialized to allow the derived</span>
<span class="sd">    classes to set up any resources specific to that subclass.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">setattr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">HOOK_TYPE</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">COMMS_INIT</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="aiperf.common.decorators.on_configure" class="doc doc-heading">
            <code class=" language-python"><span class="n">on_configure</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

<a href="#aiperf.common.decorators.on_configure" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Decorator to specify that the function should be called during the service
configuration.</p>
<p>It will be called during the service configuration to allow the derived service
to set up any resources specific to that service.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/decorators.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">on_configure</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decorator to specify that the function should be called during the service</span>
<span class="sd">    configuration.</span>

<span class="sd">    It will be called during the service configuration to allow the derived service</span>
<span class="sd">    to set up any resources specific to that service.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">HOOK_TYPE</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">CONFIGURE</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="aiperf.common.decorators.on_init" class="doc doc-heading">
            <code class=" language-python"><span class="n">on_init</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

<a href="#aiperf.common.decorators.on_init" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Decorator to specify that the function should be called during
initialization.</p>
<p>It will be called during the service initialization to allow the derived class
to set up any resources specific to that subclass.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/decorators.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">on_init</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decorator to specify that the function should be called during</span>
<span class="sd">    initialization.</span>

<span class="sd">    It will be called during the service initialization to allow the derived class</span>
<span class="sd">    to set up any resources specific to that subclass.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">setattr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">HOOK_TYPE</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">INIT</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="aiperf.common.decorators.on_run" class="doc doc-heading">
            <code class=" language-python"><span class="n">on_run</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

<a href="#aiperf.common.decorators.on_run" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Decorator to specify that the function should be called during run.</p>
<p>It will be called during the service run to allow the derived service to
run any processes or components specific to that service.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/decorators.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">on_run</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decorator to specify that the function should be called during run.</span>

<span class="sd">    It will be called during the service run to allow the derived service to</span>
<span class="sd">    run any processes or components specific to that service.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">HOOK_TYPE</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">RUN</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="aiperf.common.decorators.on_set_state" class="doc doc-heading">
            <code class=" language-python"><span class="n">on_set_state</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

<a href="#aiperf.common.decorators.on_set_state" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Decorator to specify that the function should be called when the service state
is set.</p>
<p>It will be called when the service state is set to allow the derived service to
take any action based on the new state. The new state is passed as an argument
to the function.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/decorators.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">on_set_state</span><span class="p">(</span>
    <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">,</span> <span class="n">ServiceState</span><span class="p">],</span> <span class="n">Coroutine</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">,</span> <span class="n">ServiceState</span><span class="p">],</span> <span class="n">Coroutine</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decorator to specify that the function should be called when the service state</span>
<span class="sd">    is set.</span>

<span class="sd">    It will be called when the service state is set to allow the derived service to</span>
<span class="sd">    take any action based on the new state. The new state is passed as an argument</span>
<span class="sd">    to the function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">HOOK_TYPE</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">SET_STATE</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="aiperf.common.decorators.on_start" class="doc doc-heading">
            <code class=" language-python"><span class="n">on_start</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

<a href="#aiperf.common.decorators.on_start" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Decorator to specify that the function should be called during start.</p>
<p>It will be called during the service start to allow the derived service to
start any processes or components specific to that service.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/decorators.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">on_start</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decorator to specify that the function should be called during start.</span>

<span class="sd">    It will be called during the service start to allow the derived service to</span>
<span class="sd">    start any processes or components specific to that service.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">setattr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">HOOK_TYPE</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">START</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="aiperf.common.decorators.on_stop" class="doc doc-heading">
            <code class=" language-python"><span class="n">on_stop</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

<a href="#aiperf.common.decorators.on_stop" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Decorator to specify that the function should be called during stop.</p>
<p>It will be called during the service shutdown to allow the derived service to
clean up any resources specific to that service.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/decorators.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">on_stop</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decorator to specify that the function should be called during stop.</span>

<span class="sd">    It will be called during the service shutdown to allow the derived service to</span>
<span class="sd">    clean up any resources specific to that service.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">setattr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">HOOK_TYPE</span><span class="p">,</span> <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">STOP</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">func</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="aiperfcommonenums">aiperf.common.enums<a class="headerlink" href="#aiperfcommonenums" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.enums"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="aiperf.common.enums.TopicType" class="doc doc-heading">
            <code class=" language-python"><span class="n">TopicType</span> <span class="o">=</span> <span class="n">Topic</span> <span class="o">|</span> <span class="n">DataTopic</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.TopicType" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Union of all the various different topic types supported by the system, for use in
type hinting.</p>

    </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="aiperf.common.enums.CommandType" class="doc doc-heading">
            <code>CommandType</code>


<a href="#aiperf.common.enums.CommandType" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StrEnum (aiperf.common.enums.StrEnum)" href="#aiperf.common.enums.StrEnum">StrEnum</a></code></p>


        <p>List of commands that the SystemController can send to component services.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/enums.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CommandType</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List of commands that the SystemController can send to component services.&quot;&quot;&quot;</span>

    <span class="n">START</span> <span class="o">=</span> <span class="s2">&quot;start&quot;</span>
    <span class="n">STOP</span> <span class="o">=</span> <span class="s2">&quot;stop&quot;</span>
    <span class="n">CONFIGURE</span> <span class="o">=</span> <span class="s2">&quot;configure&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.enums.CommunicationBackend" class="doc doc-heading">
            <code>CommunicationBackend</code>


<a href="#aiperf.common.enums.CommunicationBackend" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StrEnum (aiperf.common.enums.StrEnum)" href="#aiperf.common.enums.StrEnum">StrEnum</a></code></p>


        <p>Supported communication backends.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/enums.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CommunicationBackend</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Supported communication backends.&quot;&quot;&quot;</span>

    <span class="n">ZMQ_TCP</span> <span class="o">=</span> <span class="s2">&quot;zmq_tcp&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ZeroMQ backend using TCP sockets.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.CommunicationBackend.ZMQ_TCP" class="doc doc-heading">
            <code class=" language-python"><span class="n">ZMQ_TCP</span> <span class="o">=</span> <span class="s1">&#39;zmq_tcp&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.CommunicationBackend.ZMQ_TCP" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>ZeroMQ backend using TCP sockets.</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.enums.DataTopic" class="doc doc-heading">
            <code>DataTopic</code>


<a href="#aiperf.common.enums.DataTopic" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StrEnum (aiperf.common.enums.StrEnum)" href="#aiperf.common.enums.StrEnum">StrEnum</a></code></p>


        <p>TBD. Specific data topics for use in the future.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/enums.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DataTopic</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;TBD. Specific data topics for use in the future.&quot;&quot;&quot;</span>

    <span class="n">DATASET</span> <span class="o">=</span> <span class="s2">&quot;dataset_data&quot;</span>
    <span class="n">RECORDS</span> <span class="o">=</span> <span class="s2">&quot;records_data&quot;</span>
    <span class="n">WORKER</span> <span class="o">=</span> <span class="s2">&quot;worker_data&quot;</span>
    <span class="n">POST_PROCESSOR</span> <span class="o">=</span> <span class="s2">&quot;post_processor_data&quot;</span>
    <span class="n">RESULTS</span> <span class="o">=</span> <span class="s2">&quot;results&quot;</span>
    <span class="n">METRICS</span> <span class="o">=</span> <span class="s2">&quot;metrics&quot;</span>
    <span class="n">CONVERSATION</span> <span class="o">=</span> <span class="s2">&quot;conversation_data&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.enums.MessageType" class="doc doc-heading">
            <code>MessageType</code>


<a href="#aiperf.common.enums.MessageType" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StrEnum (aiperf.common.enums.StrEnum)" href="#aiperf.common.enums.StrEnum">StrEnum</a></code></p>


        <p>The various types of messages that can be sent between services.</p>
<p>The message type is used to determine what Pydantic model the payload maps to.
The mappings between message types and payload types are defined in the
payload definitions.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/enums.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MessageType</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The various types of messages that can be sent between services.</span>

<span class="sd">    The message type is used to determine what Pydantic model the payload maps to.</span>
<span class="sd">    The mappings between message types and payload types are defined in the</span>
<span class="sd">    payload definitions.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">UNKNOWN</span> <span class="o">=</span> <span class="s2">&quot;unknown&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A placeholder value for when the message type is not known.&quot;&quot;&quot;</span>

    <span class="n">REGISTRATION</span> <span class="o">=</span> <span class="s2">&quot;registration&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A message sent by a component service to register itself with the</span>
<span class="sd">    system controller.&quot;&quot;&quot;</span>

    <span class="n">HEARTBEAT</span> <span class="o">=</span> <span class="s2">&quot;heartbeat&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A message sent by a component service to the system controller to indicate it</span>
<span class="sd">    is still running.&quot;&quot;&quot;</span>

    <span class="n">COMMAND</span> <span class="o">=</span> <span class="s2">&quot;command&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A message sent by the system controller to a component service to command it</span>
<span class="sd">    to do something.&quot;&quot;&quot;</span>

    <span class="n">RESPONSE</span> <span class="o">=</span> <span class="s2">&quot;response&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A message sent by a component service to the system controller to respond</span>
<span class="sd">    to a command.&quot;&quot;&quot;</span>

    <span class="n">STATUS</span> <span class="o">=</span> <span class="s2">&quot;status&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A notification sent by a component service to the system controller to</span>
<span class="sd">    report its status.&quot;&quot;&quot;</span>

    <span class="n">ERROR</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A message sent by a component service to the system controller to</span>
<span class="sd">    report an error.&quot;&quot;&quot;</span>

    <span class="n">CREDIT_DROP</span> <span class="o">=</span> <span class="s2">&quot;credit_drop&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A message sent by the Timing Manager service to allocate credits</span>
<span class="sd">    for a worker.&quot;&quot;&quot;</span>

    <span class="n">CREDIT_RETURN</span> <span class="o">=</span> <span class="s2">&quot;credit_return&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A message sent by the Worker services to return credits to the credit pool.&quot;&quot;&quot;</span>

    <span class="n">DATA</span> <span class="o">=</span> <span class="s2">&quot;data&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A message containing data. This is TBD.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.MessageType.COMMAND" class="doc doc-heading">
            <code class=" language-python"><span class="n">COMMAND</span> <span class="o">=</span> <span class="s1">&#39;command&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.MessageType.COMMAND" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>A message sent by the system controller to a component service to command it
to do something.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.MessageType.CREDIT_DROP" class="doc doc-heading">
            <code class=" language-python"><span class="n">CREDIT_DROP</span> <span class="o">=</span> <span class="s1">&#39;credit_drop&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.MessageType.CREDIT_DROP" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>A message sent by the Timing Manager service to allocate credits
for a worker.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.MessageType.CREDIT_RETURN" class="doc doc-heading">
            <code class=" language-python"><span class="n">CREDIT_RETURN</span> <span class="o">=</span> <span class="s1">&#39;credit_return&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.MessageType.CREDIT_RETURN" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>A message sent by the Worker services to return credits to the credit pool.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.MessageType.DATA" class="doc doc-heading">
            <code class=" language-python"><span class="n">DATA</span> <span class="o">=</span> <span class="s1">&#39;data&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.MessageType.DATA" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>A message containing data. This is TBD.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.MessageType.ERROR" class="doc doc-heading">
            <code class=" language-python"><span class="n">ERROR</span> <span class="o">=</span> <span class="s1">&#39;error&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.MessageType.ERROR" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>A message sent by a component service to the system controller to
report an error.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.MessageType.HEARTBEAT" class="doc doc-heading">
            <code class=" language-python"><span class="n">HEARTBEAT</span> <span class="o">=</span> <span class="s1">&#39;heartbeat&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.MessageType.HEARTBEAT" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>A message sent by a component service to the system controller to indicate it
is still running.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.MessageType.REGISTRATION" class="doc doc-heading">
            <code class=" language-python"><span class="n">REGISTRATION</span> <span class="o">=</span> <span class="s1">&#39;registration&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.MessageType.REGISTRATION" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>A message sent by a component service to register itself with the
system controller.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.MessageType.RESPONSE" class="doc doc-heading">
            <code class=" language-python"><span class="n">RESPONSE</span> <span class="o">=</span> <span class="s1">&#39;response&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.MessageType.RESPONSE" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>A message sent by a component service to the system controller to respond
to a command.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.MessageType.STATUS" class="doc doc-heading">
            <code class=" language-python"><span class="n">STATUS</span> <span class="o">=</span> <span class="s1">&#39;status&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.MessageType.STATUS" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>A notification sent by a component service to the system controller to
report its status.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.MessageType.UNKNOWN" class="doc doc-heading">
            <code class=" language-python"><span class="n">UNKNOWN</span> <span class="o">=</span> <span class="s1">&#39;unknown&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.MessageType.UNKNOWN" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>A placeholder value for when the message type is not known.</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.enums.ServiceRegistrationStatus" class="doc doc-heading">
            <code>ServiceRegistrationStatus</code>


<a href="#aiperf.common.enums.ServiceRegistrationStatus" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StrEnum (aiperf.common.enums.StrEnum)" href="#aiperf.common.enums.StrEnum">StrEnum</a></code></p>


        <p>Defines the various states a service can be in during registration with
the SystemController.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/enums.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ServiceRegistrationStatus</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Defines the various states a service can be in during registration with</span>
<span class="sd">    the SystemController.&quot;&quot;&quot;</span>

    <span class="n">UNREGISTERED</span> <span class="o">=</span> <span class="s2">&quot;unregistered&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The service is not registered with the SystemController. This is the</span>
<span class="sd">    initial state.&quot;&quot;&quot;</span>

    <span class="n">WAITING</span> <span class="o">=</span> <span class="s2">&quot;waiting&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The service is waiting for the SystemController to register it.</span>
<span class="sd">    This is a temporary state that should be followed by REGISTERED.&quot;&quot;&quot;</span>

    <span class="n">REGISTERED</span> <span class="o">=</span> <span class="s2">&quot;registered&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The service is registered with the SystemController.&quot;&quot;&quot;</span>

    <span class="n">TIMEOUT</span> <span class="o">=</span> <span class="s2">&quot;timeout&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The service registration timed out.&quot;&quot;&quot;</span>

    <span class="n">ERROR</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The service registration failed.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.ServiceRegistrationStatus.ERROR" class="doc doc-heading">
            <code class=" language-python"><span class="n">ERROR</span> <span class="o">=</span> <span class="s1">&#39;error&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.ServiceRegistrationStatus.ERROR" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The service registration failed.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.ServiceRegistrationStatus.REGISTERED" class="doc doc-heading">
            <code class=" language-python"><span class="n">REGISTERED</span> <span class="o">=</span> <span class="s1">&#39;registered&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.ServiceRegistrationStatus.REGISTERED" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The service is registered with the SystemController.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.ServiceRegistrationStatus.TIMEOUT" class="doc doc-heading">
            <code class=" language-python"><span class="n">TIMEOUT</span> <span class="o">=</span> <span class="s1">&#39;timeout&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.ServiceRegistrationStatus.TIMEOUT" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The service registration timed out.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.ServiceRegistrationStatus.UNREGISTERED" class="doc doc-heading">
            <code class=" language-python"><span class="n">UNREGISTERED</span> <span class="o">=</span> <span class="s1">&#39;unregistered&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.ServiceRegistrationStatus.UNREGISTERED" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The service is not registered with the SystemController. This is the
initial state.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.ServiceRegistrationStatus.WAITING" class="doc doc-heading">
            <code class=" language-python"><span class="n">WAITING</span> <span class="o">=</span> <span class="s1">&#39;waiting&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.ServiceRegistrationStatus.WAITING" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The service is waiting for the SystemController to register it.
This is a temporary state that should be followed by REGISTERED.</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.enums.ServiceRunType" class="doc doc-heading">
            <code>ServiceRunType</code>


<a href="#aiperf.common.enums.ServiceRunType" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StrEnum (aiperf.common.enums.StrEnum)" href="#aiperf.common.enums.StrEnum">StrEnum</a></code></p>


        <p>The different ways the SystemController should run the component services.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/enums.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ServiceRunType</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The different ways the SystemController should run the component services.&quot;&quot;&quot;</span>

    <span class="n">MULTIPROCESSING</span> <span class="o">=</span> <span class="s2">&quot;process&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run each service as a separate process.</span>
<span class="sd">    This is the default way for single-node deployments.&quot;&quot;&quot;</span>

    <span class="n">KUBERNETES</span> <span class="o">=</span> <span class="s2">&quot;k8s&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run each service as a separate Kubernetes pod.</span>
<span class="sd">    This is the default way for multi-node deployments.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.ServiceRunType.KUBERNETES" class="doc doc-heading">
            <code class=" language-python"><span class="n">KUBERNETES</span> <span class="o">=</span> <span class="s1">&#39;k8s&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.ServiceRunType.KUBERNETES" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Run each service as a separate Kubernetes pod.
This is the default way for multi-node deployments.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.ServiceRunType.MULTIPROCESSING" class="doc doc-heading">
            <code class=" language-python"><span class="n">MULTIPROCESSING</span> <span class="o">=</span> <span class="s1">&#39;process&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.ServiceRunType.MULTIPROCESSING" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Run each service as a separate process.
This is the default way for single-node deployments.</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.enums.ServiceState" class="doc doc-heading">
            <code>ServiceState</code>


<a href="#aiperf.common.enums.ServiceState" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StrEnum (aiperf.common.enums.StrEnum)" href="#aiperf.common.enums.StrEnum">StrEnum</a></code></p>


        <p>States a service can be in throughout its lifecycle.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/enums.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ServiceState</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;States a service can be in throughout its lifecycle.&quot;&quot;&quot;</span>

    <span class="n">UNKNOWN</span> <span class="o">=</span> <span class="s2">&quot;unknown&quot;</span>

    <span class="n">INITIALIZING</span> <span class="o">=</span> <span class="s2">&quot;initializing&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The service is currently initializing. This is a temporary state that should be</span>
<span class="sd">    followed by READY.&quot;&quot;&quot;</span>

    <span class="n">READY</span> <span class="o">=</span> <span class="s2">&quot;ready&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The service has initialized and is ready to be configured or started.&quot;&quot;&quot;</span>

    <span class="n">STARTING</span> <span class="o">=</span> <span class="s2">&quot;starting&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The service is starting. This is a temporary state that should be followed</span>
<span class="sd">    by RUNNING.&quot;&quot;&quot;</span>

    <span class="n">RUNNING</span> <span class="o">=</span> <span class="s2">&quot;running&quot;</span>

    <span class="n">STOPPING</span> <span class="o">=</span> <span class="s2">&quot;stopping&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The service is stopping. This is a temporary state that should be followed</span>
<span class="sd">    by STOPPED.&quot;&quot;&quot;</span>

    <span class="n">STOPPED</span> <span class="o">=</span> <span class="s2">&quot;stopped&quot;</span>

    <span class="n">ERROR</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The service is currently in an error state.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.ServiceState.ERROR" class="doc doc-heading">
            <code class=" language-python"><span class="n">ERROR</span> <span class="o">=</span> <span class="s1">&#39;error&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.ServiceState.ERROR" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The service is currently in an error state.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.ServiceState.INITIALIZING" class="doc doc-heading">
            <code class=" language-python"><span class="n">INITIALIZING</span> <span class="o">=</span> <span class="s1">&#39;initializing&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.ServiceState.INITIALIZING" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The service is currently initializing. This is a temporary state that should be
followed by READY.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.ServiceState.READY" class="doc doc-heading">
            <code class=" language-python"><span class="n">READY</span> <span class="o">=</span> <span class="s1">&#39;ready&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.ServiceState.READY" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The service has initialized and is ready to be configured or started.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.ServiceState.STARTING" class="doc doc-heading">
            <code class=" language-python"><span class="n">STARTING</span> <span class="o">=</span> <span class="s1">&#39;starting&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.ServiceState.STARTING" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The service is starting. This is a temporary state that should be followed
by RUNNING.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.enums.ServiceState.STOPPING" class="doc doc-heading">
            <code class=" language-python"><span class="n">STOPPING</span> <span class="o">=</span> <span class="s1">&#39;stopping&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#aiperf.common.enums.ServiceState.STOPPING" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The service is stopping. This is a temporary state that should be followed
by STOPPED.</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.enums.ServiceType" class="doc doc-heading">
            <code>ServiceType</code>


<a href="#aiperf.common.enums.ServiceType" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StrEnum (aiperf.common.enums.StrEnum)" href="#aiperf.common.enums.StrEnum">StrEnum</a></code></p>


        <p>Types of services in the AIPerf system.</p>
<p>This is used to identify the service type when registering with the
SystemController. It can also be used for tracking purposes if multiple
instances of the same service type are running.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/enums.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ServiceType</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Types of services in the AIPerf system.</span>

<span class="sd">    This is used to identify the service type when registering with the</span>
<span class="sd">    SystemController. It can also be used for tracking purposes if multiple</span>
<span class="sd">    instances of the same service type are running.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SYSTEM_CONTROLLER</span> <span class="o">=</span> <span class="s2">&quot;system_controller&quot;</span>
    <span class="n">DATASET_MANAGER</span> <span class="o">=</span> <span class="s2">&quot;dataset_manager&quot;</span>
    <span class="n">TIMING_MANAGER</span> <span class="o">=</span> <span class="s2">&quot;timing_manager&quot;</span>
    <span class="n">RECORDS_MANAGER</span> <span class="o">=</span> <span class="s2">&quot;records_manager&quot;</span>
    <span class="n">POST_PROCESSOR_MANAGER</span> <span class="o">=</span> <span class="s2">&quot;post_processor_manager&quot;</span>
    <span class="n">WORKER_MANAGER</span> <span class="o">=</span> <span class="s2">&quot;worker_manager&quot;</span>
    <span class="n">WORKER</span> <span class="o">=</span> <span class="s2">&quot;worker&quot;</span>
    <span class="n">TEST</span> <span class="o">=</span> <span class="s2">&quot;test_service&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.enums.StrEnum" class="doc doc-heading">
            <code>StrEnum</code>


<a href="#aiperf.common.enums.StrEnum" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="str">str</span></code>, <code><span title="enum.Enum">Enum</span></code></p>


        <p>Base class for string-based enums.</p>
<p>Using this as a base class allows enum values to be used directly as
strings without having to use .value.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/enums.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">StrEnum</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for string-based enums.</span>

<span class="sd">    Using this as a base class allows enum values to be used directly as</span>
<span class="sd">    strings without having to use .value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.enums.Topic" class="doc doc-heading">
            <code>Topic</code>


<a href="#aiperf.common.enums.Topic" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StrEnum (aiperf.common.enums.StrEnum)" href="#aiperf.common.enums.StrEnum">StrEnum</a></code></p>


        <p>Communication topics for the main messaging bus.
Right now, there is some overlap between Topic and MessageType.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/enums.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Topic</span><span class="p">(</span><span class="n">StrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Communication topics for the main messaging bus.</span>
<span class="sd">    Right now, there is some overlap between Topic and MessageType.&quot;&quot;&quot;</span>

    <span class="n">CREDIT_DROP</span> <span class="o">=</span> <span class="s2">&quot;credit_drop&quot;</span>
    <span class="n">CREDIT_RETURN</span> <span class="o">=</span> <span class="s2">&quot;credit_return&quot;</span>
    <span class="n">REGISTRATION</span> <span class="o">=</span> <span class="s2">&quot;registration&quot;</span>
    <span class="n">COMMAND</span> <span class="o">=</span> <span class="s2">&quot;command&quot;</span>
    <span class="n">RESPONSE</span> <span class="o">=</span> <span class="s2">&quot;response&quot;</span>
    <span class="n">STATUS</span> <span class="o">=</span> <span class="s2">&quot;status&quot;</span>
    <span class="n">HEARTBEAT</span> <span class="o">=</span> <span class="s2">&quot;heartbeat&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommonexceptions">aiperf.common.exceptions<a class="headerlink" href="#aiperfcommonexceptions" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.exceptions"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.AIPerfError" class="doc doc-heading">
            <code>AIPerfError</code>


<a href="#aiperf.common.exceptions.AIPerfError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Base class for all exceptions raised by AIPerf.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AIPerfError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for all exceptions raised by AIPerf.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.AIPerfMetaclassError" class="doc doc-heading">
            <code>AIPerfMetaclassError</code>


<a href="#aiperf.common.exceptions.AIPerfMetaclassError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="AIPerfError (aiperf.common.exceptions.AIPerfError)" href="#aiperf.common.exceptions.AIPerfError">AIPerfError</a></code></p>


        <p>Exception raised for AIPerf metaclass errors.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AIPerfMetaclassError</span><span class="p">(</span><span class="n">AIPerfError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised for AIPerf metaclass errors.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.AIPerfMultiError" class="doc doc-heading">
            <code>AIPerfMultiError</code>


<a href="#aiperf.common.exceptions.AIPerfMultiError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="AIPerfError (aiperf.common.exceptions.AIPerfError)" href="#aiperf.common.exceptions.AIPerfError">AIPerfError</a></code></p>


        <p>Exception raised when running multiple tasks and one or more fail.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AIPerfMultiError</span><span class="p">(</span><span class="n">AIPerfError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when running multiple tasks and one or more fail.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exceptions</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">exceptions</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exceptions</span> <span class="o">=</span> <span class="n">exceptions</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.CommunicationClientCreationError" class="doc doc-heading">
            <code>CommunicationClientCreationError</code>


<a href="#aiperf.common.exceptions.CommunicationClientCreationError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="CommunicationError (aiperf.common.exceptions.CommunicationError)" href="#aiperf.common.exceptions.CommunicationError">CommunicationError</a></code></p>


        <p>Exception raised when communication channels fail to create a client.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CommunicationClientCreationError</span><span class="p">(</span><span class="n">CommunicationError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when communication channels fail to create a client.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.CommunicationClientNotFoundError" class="doc doc-heading">
            <code>CommunicationClientNotFoundError</code>


<a href="#aiperf.common.exceptions.CommunicationClientNotFoundError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="CommunicationError (aiperf.common.exceptions.CommunicationError)" href="#aiperf.common.exceptions.CommunicationError">CommunicationError</a></code></p>


        <p>Exception raised when a communication client is not found.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CommunicationClientNotFoundError</span><span class="p">(</span><span class="n">CommunicationError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when a communication client is not found.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.CommunicationCreateError" class="doc doc-heading">
            <code>CommunicationCreateError</code>


<a href="#aiperf.common.exceptions.CommunicationCreateError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="CommunicationError (aiperf.common.exceptions.CommunicationError)" href="#aiperf.common.exceptions.CommunicationError">CommunicationError</a></code></p>


        <p>Exception raised when communication channels fail to create a client.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CommunicationCreateError</span><span class="p">(</span><span class="n">CommunicationError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when communication channels fail to create a client.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.CommunicationError" class="doc doc-heading">
            <code>CommunicationError</code>


<a href="#aiperf.common.exceptions.CommunicationError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="AIPerfError (aiperf.common.exceptions.AIPerfError)" href="#aiperf.common.exceptions.AIPerfError">AIPerfError</a></code></p>


        <p>Base class for all communication exceptions.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CommunicationError</span><span class="p">(</span><span class="n">AIPerfError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for all communication exceptions.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.CommunicationInitializationError" class="doc doc-heading">
            <code>CommunicationInitializationError</code>


<a href="#aiperf.common.exceptions.CommunicationInitializationError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="CommunicationError (aiperf.common.exceptions.CommunicationError)" href="#aiperf.common.exceptions.CommunicationError">CommunicationError</a></code></p>


        <p>Exception raised when communication channels fail to initialize.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CommunicationInitializationError</span><span class="p">(</span><span class="n">CommunicationError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when communication channels fail to initialize.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.CommunicationNotInitializedError" class="doc doc-heading">
            <code>CommunicationNotInitializedError</code>


<a href="#aiperf.common.exceptions.CommunicationNotInitializedError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="CommunicationError (aiperf.common.exceptions.CommunicationError)" href="#aiperf.common.exceptions.CommunicationError">CommunicationError</a></code></p>


        <p>Exception raised when communication channels are not initialized.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CommunicationNotInitializedError</span><span class="p">(</span><span class="n">CommunicationError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when communication channels are not initialized.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.CommunicationPublishError" class="doc doc-heading">
            <code>CommunicationPublishError</code>


<a href="#aiperf.common.exceptions.CommunicationPublishError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="CommunicationError (aiperf.common.exceptions.CommunicationError)" href="#aiperf.common.exceptions.CommunicationError">CommunicationError</a></code></p>


        <p>Exception raised when communication channels fail to publish a message.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CommunicationPublishError</span><span class="p">(</span><span class="n">CommunicationError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when communication channels fail to publish a message.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.CommunicationPullError" class="doc doc-heading">
            <code>CommunicationPullError</code>


<a href="#aiperf.common.exceptions.CommunicationPullError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="CommunicationError (aiperf.common.exceptions.CommunicationError)" href="#aiperf.common.exceptions.CommunicationError">CommunicationError</a></code></p>


        <p>Exception raised when communication channels fail to pull a message from
a topic.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CommunicationPullError</span><span class="p">(</span><span class="n">CommunicationError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when communication channels fail to pull a message from</span>
<span class="sd">    a topic.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.CommunicationPushError" class="doc doc-heading">
            <code>CommunicationPushError</code>


<a href="#aiperf.common.exceptions.CommunicationPushError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="CommunicationError (aiperf.common.exceptions.CommunicationError)" href="#aiperf.common.exceptions.CommunicationError">CommunicationError</a></code></p>


        <p>Exception raised when communication channels fail to push a message to
a topic.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CommunicationPushError</span><span class="p">(</span><span class="n">CommunicationError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when communication channels fail to push a message to</span>
<span class="sd">    a topic.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.CommunicationRequestError" class="doc doc-heading">
            <code>CommunicationRequestError</code>


<a href="#aiperf.common.exceptions.CommunicationRequestError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="CommunicationError (aiperf.common.exceptions.CommunicationError)" href="#aiperf.common.exceptions.CommunicationError">CommunicationError</a></code></p>


        <p>Exception raised when communication channels fail to send a request.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CommunicationRequestError</span><span class="p">(</span><span class="n">CommunicationError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when communication channels fail to send a request.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.CommunicationResponseError" class="doc doc-heading">
            <code>CommunicationResponseError</code>


<a href="#aiperf.common.exceptions.CommunicationResponseError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="CommunicationError (aiperf.common.exceptions.CommunicationError)" href="#aiperf.common.exceptions.CommunicationError">CommunicationError</a></code></p>


        <p>Exception raised when communication channels fail to receive a response.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CommunicationResponseError</span><span class="p">(</span><span class="n">CommunicationError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when communication channels fail to receive a response.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.CommunicationShutdownError" class="doc doc-heading">
            <code>CommunicationShutdownError</code>


<a href="#aiperf.common.exceptions.CommunicationShutdownError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="CommunicationError (aiperf.common.exceptions.CommunicationError)" href="#aiperf.common.exceptions.CommunicationError">CommunicationError</a></code></p>


        <p>Exception raised when communication channels fail to shutdown.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CommunicationShutdownError</span><span class="p">(</span><span class="n">CommunicationError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when communication channels fail to shutdown.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.CommunicationSubscribeError" class="doc doc-heading">
            <code>CommunicationSubscribeError</code>


<a href="#aiperf.common.exceptions.CommunicationSubscribeError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="CommunicationError (aiperf.common.exceptions.CommunicationError)" href="#aiperf.common.exceptions.CommunicationError">CommunicationError</a></code></p>


        <p>Exception raised when communication channels fail to subscribe to a topic.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CommunicationSubscribeError</span><span class="p">(</span><span class="n">CommunicationError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when communication channels fail to subscribe to a topic.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.CommunicationTypeAlreadyRegisteredError" class="doc doc-heading">
            <code>CommunicationTypeAlreadyRegisteredError</code>


<a href="#aiperf.common.exceptions.CommunicationTypeAlreadyRegisteredError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="CommunicationError (aiperf.common.exceptions.CommunicationError)" href="#aiperf.common.exceptions.CommunicationError">CommunicationError</a></code></p>


        <p>Exception raised when the communication type is already registered.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CommunicationTypeAlreadyRegisteredError</span><span class="p">(</span><span class="n">CommunicationError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when the communication type is already registered.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.CommunicationTypeUnknownError" class="doc doc-heading">
            <code>CommunicationTypeUnknownError</code>


<a href="#aiperf.common.exceptions.CommunicationTypeUnknownError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="CommunicationError (aiperf.common.exceptions.CommunicationError)" href="#aiperf.common.exceptions.CommunicationError">CommunicationError</a></code></p>


        <p>Exception raised when the communication type is unknown.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CommunicationTypeUnknownError</span><span class="p">(</span><span class="n">CommunicationError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when the communication type is unknown.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.ConfigError" class="doc doc-heading">
            <code>ConfigError</code>


<a href="#aiperf.common.exceptions.ConfigError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="AIPerfError (aiperf.common.exceptions.AIPerfError)" href="#aiperf.common.exceptions.AIPerfError">AIPerfError</a></code></p>


        <p>Base class for all exceptions raised by configuration errors.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ConfigError</span><span class="p">(</span><span class="n">AIPerfError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for all exceptions raised by configuration errors.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.ConfigLoadError" class="doc doc-heading">
            <code>ConfigLoadError</code>


<a href="#aiperf.common.exceptions.ConfigLoadError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ConfigError (aiperf.common.exceptions.ConfigError)" href="#aiperf.common.exceptions.ConfigError">ConfigError</a></code></p>


        <p>Exception raised for configuration load errors.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ConfigLoadError</span><span class="p">(</span><span class="n">ConfigError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised for configuration load errors.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.ConfigParseError" class="doc doc-heading">
            <code>ConfigParseError</code>


<a href="#aiperf.common.exceptions.ConfigParseError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ConfigError (aiperf.common.exceptions.ConfigError)" href="#aiperf.common.exceptions.ConfigError">ConfigError</a></code></p>


        <p>Exception raised for configuration parse errors.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ConfigParseError</span><span class="p">(</span><span class="n">ConfigError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised for configuration parse errors.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.ConfigValidationError" class="doc doc-heading">
            <code>ConfigValidationError</code>


<a href="#aiperf.common.exceptions.ConfigValidationError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ConfigError (aiperf.common.exceptions.ConfigError)" href="#aiperf.common.exceptions.ConfigError">ConfigError</a></code></p>


        <p>Exception raised for configuration validation errors.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ConfigValidationError</span><span class="p">(</span><span class="n">ConfigError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised for configuration validation errors.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.GeneratorConfigurationError" class="doc doc-heading">
            <code>GeneratorConfigurationError</code>


<a href="#aiperf.common.exceptions.GeneratorConfigurationError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="GeneratorError (aiperf.common.exceptions.GeneratorError)" href="#aiperf.common.exceptions.GeneratorError">GeneratorError</a></code></p>


        <p>Exception raised for data generator configuration errors.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">GeneratorConfigurationError</span><span class="p">(</span><span class="n">GeneratorError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised for data generator configuration errors.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.GeneratorError" class="doc doc-heading">
            <code>GeneratorError</code>


<a href="#aiperf.common.exceptions.GeneratorError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="AIPerfError (aiperf.common.exceptions.AIPerfError)" href="#aiperf.common.exceptions.AIPerfError">AIPerfError</a></code></p>


        <p>Base class for all exceptions raised by data generator modules.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">GeneratorError</span><span class="p">(</span><span class="n">AIPerfError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for all exceptions raised by data generator modules.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.GeneratorInitializationError" class="doc doc-heading">
            <code>GeneratorInitializationError</code>


<a href="#aiperf.common.exceptions.GeneratorInitializationError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="GeneratorError (aiperf.common.exceptions.GeneratorError)" href="#aiperf.common.exceptions.GeneratorError">GeneratorError</a></code></p>


        <p>Exception raised for data generator initialization errors.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">GeneratorInitializationError</span><span class="p">(</span><span class="n">GeneratorError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised for data generator initialization errors.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.ServiceCleanupError" class="doc doc-heading">
            <code>ServiceCleanupError</code>


<a href="#aiperf.common.exceptions.ServiceCleanupError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ServiceError (aiperf.common.exceptions.ServiceError)" href="#aiperf.common.exceptions.ServiceError">ServiceError</a></code></p>


        <p>Exception raised for service cleanup errors.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ServiceCleanupError</span><span class="p">(</span><span class="n">ServiceError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised for service cleanup errors.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.ServiceConfigureError" class="doc doc-heading">
            <code>ServiceConfigureError</code>


<a href="#aiperf.common.exceptions.ServiceConfigureError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ServiceError (aiperf.common.exceptions.ServiceError)" href="#aiperf.common.exceptions.ServiceError">ServiceError</a></code></p>


        <p>Exception raised for service configure errors.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">185</span>
<span class="normal">186</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ServiceConfigureError</span><span class="p">(</span><span class="n">ServiceError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised for service configure errors.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.ServiceError" class="doc doc-heading">
            <code>ServiceError</code>


<a href="#aiperf.common.exceptions.ServiceError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="AIPerfError (aiperf.common.exceptions.AIPerfError)" href="#aiperf.common.exceptions.AIPerfError">AIPerfError</a></code></p>


        <p>Base class for all exceptions raised by services.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">138</span>
<span class="normal">139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ServiceError</span><span class="p">(</span><span class="n">AIPerfError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for all exceptions raised by services.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.ServiceHeartbeatError" class="doc doc-heading">
            <code>ServiceHeartbeatError</code>


<a href="#aiperf.common.exceptions.ServiceHeartbeatError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ServiceError (aiperf.common.exceptions.ServiceError)" href="#aiperf.common.exceptions.ServiceError">ServiceError</a></code></p>


        <p>Exception raised for service heartbeat errors.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">189</span>
<span class="normal">190</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ServiceHeartbeatError</span><span class="p">(</span><span class="n">ServiceError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised for service heartbeat errors.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.ServiceInitializationError" class="doc doc-heading">
            <code>ServiceInitializationError</code>


<a href="#aiperf.common.exceptions.ServiceInitializationError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ServiceError (aiperf.common.exceptions.ServiceError)" href="#aiperf.common.exceptions.ServiceError">ServiceError</a></code></p>


        <p>Exception raised for service initialization errors.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ServiceInitializationError</span><span class="p">(</span><span class="n">ServiceError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised for service initialization errors.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.ServiceMessageProcessingError" class="doc doc-heading">
            <code>ServiceMessageProcessingError</code>


<a href="#aiperf.common.exceptions.ServiceMessageProcessingError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ServiceError (aiperf.common.exceptions.ServiceError)" href="#aiperf.common.exceptions.ServiceError">ServiceError</a></code></p>


        <p>Exception raised for service message processing errors.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ServiceMessageProcessingError</span><span class="p">(</span><span class="n">ServiceError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised for service message processing errors.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.ServiceMetaclassError" class="doc doc-heading">
            <code>ServiceMetaclassError</code>


<a href="#aiperf.common.exceptions.ServiceMetaclassError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="AIPerfError (aiperf.common.exceptions.AIPerfError)" href="#aiperf.common.exceptions.AIPerfError">AIPerfError</a></code></p>


        <p>Exception raised for service metaclass errors.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ServiceMetaclassError</span><span class="p">(</span><span class="n">AIPerfError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised for service metaclass errors.&quot;&quot;&quot;</span>

    <span class="n">message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;Service metaclass error. Please check the service definition decorators.&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.ServiceRegistrationError" class="doc doc-heading">
            <code>ServiceRegistrationError</code>


<a href="#aiperf.common.exceptions.ServiceRegistrationError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ServiceError (aiperf.common.exceptions.ServiceError)" href="#aiperf.common.exceptions.ServiceError">ServiceError</a></code></p>


        <p>Exception raised for service registration errors.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ServiceRegistrationError</span><span class="p">(</span><span class="n">ServiceError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised for service registration errors.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.ServiceRunError" class="doc doc-heading">
            <code>ServiceRunError</code>


<a href="#aiperf.common.exceptions.ServiceRunError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ServiceError (aiperf.common.exceptions.ServiceError)" href="#aiperf.common.exceptions.ServiceError">ServiceError</a></code></p>


        <p>Exception raised for service run errors.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ServiceRunError</span><span class="p">(</span><span class="n">ServiceError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised for service run errors.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.ServiceStartError" class="doc doc-heading">
            <code>ServiceStartError</code>


<a href="#aiperf.common.exceptions.ServiceStartError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ServiceError (aiperf.common.exceptions.ServiceError)" href="#aiperf.common.exceptions.ServiceError">ServiceError</a></code></p>


        <p>Exception raised for service start errors.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ServiceStartError</span><span class="p">(</span><span class="n">ServiceError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised for service start errors.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.ServiceStatusError" class="doc doc-heading">
            <code>ServiceStatusError</code>


<a href="#aiperf.common.exceptions.ServiceStatusError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ServiceError (aiperf.common.exceptions.ServiceError)" href="#aiperf.common.exceptions.ServiceError">ServiceError</a></code></p>


        <p>Exception raised for service status errors.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ServiceStatusError</span><span class="p">(</span><span class="n">ServiceError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised for service status errors.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.ServiceStopError" class="doc doc-heading">
            <code>ServiceStopError</code>


<a href="#aiperf.common.exceptions.ServiceStopError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ServiceError (aiperf.common.exceptions.ServiceError)" href="#aiperf.common.exceptions.ServiceError">ServiceError</a></code></p>


        <p>Exception raised for service stop errors.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">161</span>
<span class="normal">162</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ServiceStopError</span><span class="p">(</span><span class="n">ServiceError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised for service stop errors.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.TokenizerError" class="doc doc-heading">
            <code>TokenizerError</code>


<a href="#aiperf.common.exceptions.TokenizerError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="AIPerfError (aiperf.common.exceptions.AIPerfError)" href="#aiperf.common.exceptions.AIPerfError">AIPerfError</a></code></p>


        <p>Base class for tokenizer exceptions.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">TokenizerError</span><span class="p">(</span><span class="n">AIPerfError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for tokenizer exceptions.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.exceptions.TokenizerInitializationError" class="doc doc-heading">
            <code>TokenizerInitializationError</code>


<a href="#aiperf.common.exceptions.TokenizerInitializationError" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="TokenizerError (aiperf.common.exceptions.TokenizerError)" href="#aiperf.common.exceptions.TokenizerError">TokenizerError</a></code></p>


        <p>Exception raised for errors during tokenizer initialization.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/exceptions.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">TokenizerInitializationError</span><span class="p">(</span><span class="n">TokenizerError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised for errors during tokenizer initialization.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommonmodels">aiperf.common.models<a class="headerlink" href="#aiperfcommonmodels" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.models"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="aiperf.common.models.Message" class="doc doc-heading">
            <code class=" language-python"><span class="n">Message</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">BaseMessage</span><span class="p">,</span> <span class="n">DataMessage</span><span class="p">,</span> <span class="n">HeartbeatMessage</span><span class="p">,</span> <span class="n">RegistrationMessage</span><span class="p">,</span> <span class="n">StatusMessage</span><span class="p">,</span> <span class="n">CommandMessage</span><span class="p">,</span> <span class="n">CreditDropMessage</span><span class="p">,</span> <span class="n">CreditReturnMessage</span><span class="p">,</span> <span class="n">ErrorMessage</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#aiperf.common.models.Message" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Union of all message types. This is used as a type hint when a function
accepts a message as an argument.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">process_message</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="o">...</span>     <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">DataMessage</span><span class="p">):</span>
<span class="o">...</span>         <span class="nb">print</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="o">...</span>     <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">HeartbeatMessage</span><span class="p">):</span>
<span class="o">...</span>         <span class="nb">print</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">state</span><span class="p">)</span>
</code></pre></div>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="aiperf.common.models.Payload" class="doc doc-heading">
            <code class=" language-python"><span class="n">Payload</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">DataPayload</span><span class="p">,</span> <span class="n">HeartbeatPayload</span><span class="p">,</span> <span class="n">RegistrationPayload</span><span class="p">,</span> <span class="n">StatusPayload</span><span class="p">,</span> <span class="n">CommandPayload</span><span class="p">,</span> <span class="n">CreditDropPayload</span><span class="p">,</span> <span class="n">CreditReturnPayload</span><span class="p">,</span> <span class="n">ErrorPayload</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#aiperf.common.models.Payload" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>This is a union of all the payload types that can be sent and received.</p>
<p>This is used with Pydantic's <code>discriminator</code> to allow for polymorphic payloads,
and automatic type coercion when receiving messages.</p>

    </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.BaseMessage" class="doc doc-heading">
            <code>BaseMessage</code>


<a href="#aiperf.common.models.BaseMessage" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Base message model with common fields for all messages.
The payload can be any of the payload types defined by the payloads.py module.</p>
<p>The message type is determined by the discriminator field <code>message_type</code>. This is
used by the Pydantic <code>discriminator</code> argument to determine the type of the
payload automatically when the message is deserialized from a JSON string.</p>
<p>To serialize a message to a JSON string, use the <code>model_dump_json</code> method.
To deserialize a message from a JSON string, use the <code>model_validate_json</code>
method.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">message</span> <span class="o">=</span> <span class="n">BaseMessage</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">service_id</span><span class="o">=</span><span class="s2">&quot;service_1&quot;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">request_id</span><span class="o">=</span><span class="s2">&quot;request_1&quot;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">payload</span><span class="o">=</span><span class="n">DataPayload</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s2">&quot;Hello, world!&quot;</span><span class="p">),</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">json_string</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">json_string</span><span class="p">)</span>
<span class="p">{</span><span class="s2">&quot;payload&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello, world!&quot;</span><span class="p">},</span> <span class="s2">&quot;service_id&quot;</span><span class="p">:</span> <span class="s2">&quot;service_1&quot;</span><span class="p">,</span> <span class="s2">&quot;request_id&quot;</span><span class="p">:</span> <span class="s2">&quot;request_1&quot;</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">deserialized_message</span> <span class="o">=</span> <span class="n">BaseMessage</span><span class="o">.</span><span class="n">model_validate_json</span><span class="p">(</span><span class="n">json_string</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">deserialized_message</span><span class="p">)</span>
<span class="n">BaseMessage</span><span class="p">(</span>
    <span class="n">payload</span><span class="o">=</span><span class="n">DataPayload</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s2">&quot;Hello, world!&quot;</span><span class="p">),</span>
    <span class="n">service_id</span><span class="o">=</span><span class="s2">&quot;service_1&quot;</span><span class="p">,</span>
    <span class="n">request_id</span><span class="o">=</span><span class="s2">&quot;request_1&quot;</span><span class="p">,</span>
    <span class="n">timestamp</span><span class="o">=</span><span class="mi">1716278400000000000</span><span class="p">,</span>
<span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">deserialized_message</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">Hello</span><span class="p">,</span> <span class="n">world</span><span class="err">!</span>
</code></pre></div>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BaseMessage</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base message model with common fields for all messages.</span>
<span class="sd">    The payload can be any of the payload types defined by the payloads.py module.</span>

<span class="sd">    The message type is determined by the discriminator field `message_type`. This is</span>
<span class="sd">    used by the Pydantic `discriminator` argument to determine the type of the</span>
<span class="sd">    payload automatically when the message is deserialized from a JSON string.</span>

<span class="sd">    To serialize a message to a JSON string, use the `model_dump_json` method.</span>
<span class="sd">    To deserialize a message from a JSON string, use the `model_validate_json`</span>
<span class="sd">    method.</span>

<span class="sd">    Example:</span>
<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; message = BaseMessage(</span>
<span class="sd">    ...     service_id=&quot;service_1&quot;,</span>
<span class="sd">    ...     request_id=&quot;request_1&quot;,</span>
<span class="sd">    ...     payload=DataPayload(data=&quot;Hello, world!&quot;),</span>
<span class="sd">    ... )</span>
<span class="sd">    &gt;&gt;&gt; json_string = message.model_dump_json()</span>
<span class="sd">    &gt;&gt;&gt; print(json_string)</span>
<span class="sd">    {&quot;payload&quot;: {&quot;data&quot;: &quot;Hello, world!&quot;}, &quot;service_id&quot;: &quot;service_1&quot;, &quot;request_id&quot;: &quot;request_1&quot;}</span>
<span class="sd">    &gt;&gt;&gt; deserialized_message = BaseMessage.model_validate_json(json_string)</span>
<span class="sd">    &gt;&gt;&gt; print(deserialized_message)</span>
<span class="sd">    BaseMessage(</span>
<span class="sd">        payload=DataPayload(data=&quot;Hello, world!&quot;),</span>
<span class="sd">        service_id=&quot;service_1&quot;,</span>
<span class="sd">        request_id=&quot;request_1&quot;,</span>
<span class="sd">        timestamp=1716278400000000000,</span>
<span class="sd">    )</span>
<span class="sd">    &gt;&gt;&gt; print(deserialized_message.payload.data)</span>
<span class="sd">    Hello, world!</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">service_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;ID of the service sending the response&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Time when the response was created&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">request_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;ID of the request&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">payload</span><span class="p">:</span> <span class="n">Payload</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="n">discriminator</span><span class="o">=</span><span class="s2">&quot;message_type&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Payload of the response&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.BasePayload" class="doc doc-heading">
            <code>BasePayload</code>


<a href="#aiperf.common.models.BasePayload" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code>, <code><span title="abc.ABC">ABC</span></code></p>


        <p>Base model for all payload data. Each payload type must inherit
from this class, and override the <code>message_type</code> field.</p>
<p>This is used with Pydantic's <code>discriminator</code> to allow for polymorphic payloads,
and automatic type coercion when receiving messages.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BasePayload</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base model for all payload data. Each payload type must inherit</span>
<span class="sd">    from this class, and override the `message_type` field.</span>

<span class="sd">    This is used with Pydantic&#39;s `discriminator` to allow for polymorphic payloads,</span>
<span class="sd">    and automatic type coercion when receiving messages.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Note: Literal[MessageType.UNKNOWN] is required due to the way the</span>
    <span class="c1"># discriminator is implemented in Pydantic, it requires everything to be a</span>
    <span class="c1"># literal.</span>
    <span class="n">message_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">MessageType</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Type of message this payload represents&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.CommandMessage" class="doc doc-heading">
            <code>CommandMessage</code>


<a href="#aiperf.common.models.CommandMessage" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseMessage (aiperf.common.models.BaseMessage)" href="#aiperf.common.models.BaseMessage">BaseMessage</a></code></p>


        <p>Message containing command data.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CommandMessage</span><span class="p">(</span><span class="n">BaseMessage</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Message containing command data.&quot;&quot;&quot;</span>

    <span class="n">payload</span><span class="p">:</span> <span class="n">CommandPayload</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.CommandPayload" class="doc doc-heading">
            <code>CommandPayload</code>


<a href="#aiperf.common.models.CommandPayload" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BasePayload (aiperf.common.models.BasePayload)" href="#aiperf.common.models.BasePayload">BasePayload</a></code></p>


        <p>Command payload sent to services to request an action.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CommandPayload</span><span class="p">(</span><span class="n">BasePayload</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Command payload sent to services to request an action.&quot;&quot;&quot;</span>

    <span class="n">message_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">MessageType</span><span class="o">.</span><span class="n">COMMAND</span><span class="p">]</span> <span class="o">=</span> <span class="n">MessageType</span><span class="o">.</span><span class="n">COMMAND</span>

    <span class="n">command</span><span class="p">:</span> <span class="n">CommandType</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Command to execute&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">command_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span><span class="p">[:</span><span class="mi">8</span><span class="p">],</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Unique identifier for this command&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">require_response</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Whether a response is required for this command&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">target_service_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;ID of the target service for this command&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">BaseModel</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Data to send with the command&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.CreditDropMessage" class="doc doc-heading">
            <code>CreditDropMessage</code>


<a href="#aiperf.common.models.CreditDropMessage" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseMessage (aiperf.common.models.BaseMessage)" href="#aiperf.common.models.BaseMessage">BaseMessage</a></code></p>


        <p>Message indicating that a credit has been dropped.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CreditDropMessage</span><span class="p">(</span><span class="n">BaseMessage</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Message indicating that a credit has been dropped.&quot;&quot;&quot;</span>

    <span class="n">payload</span><span class="p">:</span> <span class="n">CreditDropPayload</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.CreditDropPayload" class="doc doc-heading">
            <code>CreditDropPayload</code>


<a href="#aiperf.common.models.CreditDropPayload" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BasePayload (aiperf.common.models.BasePayload)" href="#aiperf.common.models.BasePayload">BasePayload</a></code></p>


        <p>Credit drop payload sent to services to request a credit drop.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CreditDropPayload</span><span class="p">(</span><span class="n">BasePayload</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Credit drop payload sent to services to request a credit drop.&quot;&quot;&quot;</span>

    <span class="n">message_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">MessageType</span><span class="o">.</span><span class="n">CREDIT_DROP</span><span class="p">]</span> <span class="o">=</span> <span class="n">MessageType</span><span class="o">.</span><span class="n">CREDIT_DROP</span>

    <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Amount of credits to drop&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Timestamp of the credit drop&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.CreditReturnMessage" class="doc doc-heading">
            <code>CreditReturnMessage</code>


<a href="#aiperf.common.models.CreditReturnMessage" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseMessage (aiperf.common.models.BaseMessage)" href="#aiperf.common.models.BaseMessage">BaseMessage</a></code></p>


        <p>Message indicating that a credit has been returned.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CreditReturnMessage</span><span class="p">(</span><span class="n">BaseMessage</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Message indicating that a credit has been returned.&quot;&quot;&quot;</span>

    <span class="n">payload</span><span class="p">:</span> <span class="n">CreditReturnPayload</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.CreditReturnPayload" class="doc doc-heading">
            <code>CreditReturnPayload</code>


<a href="#aiperf.common.models.CreditReturnPayload" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BasePayload (aiperf.common.models.BasePayload)" href="#aiperf.common.models.BasePayload">BasePayload</a></code></p>


        <p>Credit return payload sent to services to request a credit return.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CreditReturnPayload</span><span class="p">(</span><span class="n">BasePayload</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Credit return payload sent to services to request a credit return.&quot;&quot;&quot;</span>

    <span class="n">message_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">MessageType</span><span class="o">.</span><span class="n">CREDIT_RETURN</span><span class="p">]</span> <span class="o">=</span> <span class="n">MessageType</span><span class="o">.</span><span class="n">CREDIT_RETURN</span>

    <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Amount of credits to return&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.DataMessage" class="doc doc-heading">
            <code>DataMessage</code>


<a href="#aiperf.common.models.DataMessage" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseMessage (aiperf.common.models.BaseMessage)" href="#aiperf.common.models.BaseMessage">BaseMessage</a></code></p>


        <p>Message containing data.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DataMessage</span><span class="p">(</span><span class="n">BaseMessage</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Message containing data.&quot;&quot;&quot;</span>

    <span class="n">payload</span><span class="p">:</span> <span class="n">DataPayload</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.DataPayload" class="doc doc-heading">
            <code>DataPayload</code>


<a href="#aiperf.common.models.DataPayload" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BasePayload (aiperf.common.models.BasePayload)" href="#aiperf.common.models.BasePayload">BasePayload</a></code></p>


        <p>Base model for data payloads with metadata.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DataPayload</span><span class="p">(</span><span class="n">BasePayload</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base model for data payloads with metadata.&quot;&quot;&quot;</span>

    <span class="n">message_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">MessageType</span><span class="o">.</span><span class="n">DATA</span><span class="p">]</span> <span class="o">=</span> <span class="n">MessageType</span><span class="o">.</span><span class="n">DATA</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.ErrorMessage" class="doc doc-heading">
            <code>ErrorMessage</code>


<a href="#aiperf.common.models.ErrorMessage" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseMessage (aiperf.common.models.BaseMessage)" href="#aiperf.common.models.BaseMessage">BaseMessage</a></code></p>


        <p>Message containing error data.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ErrorMessage</span><span class="p">(</span><span class="n">BaseMessage</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Message containing error data.&quot;&quot;&quot;</span>

    <span class="n">payload</span><span class="p">:</span> <span class="n">ErrorPayload</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.ErrorPayload" class="doc doc-heading">
            <code>ErrorPayload</code>


<a href="#aiperf.common.models.ErrorPayload" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BasePayload (aiperf.common.models.BasePayload)" href="#aiperf.common.models.BasePayload">BasePayload</a></code></p>


        <p>Exception payload sent by services to report an error.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ErrorPayload</span><span class="p">(</span><span class="n">BasePayload</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception payload sent by services to report an error.&quot;&quot;&quot;</span>

    <span class="n">message_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">MessageType</span><span class="o">.</span><span class="n">ERROR</span><span class="p">]</span> <span class="o">=</span> <span class="n">MessageType</span><span class="o">.</span><span class="n">ERROR</span>

    <span class="n">error_code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Exception code&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">error_message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Exception message&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">error_details</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Additional details about the error&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.HeartbeatMessage" class="doc doc-heading">
            <code>HeartbeatMessage</code>


<a href="#aiperf.common.models.HeartbeatMessage" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseMessage (aiperf.common.models.BaseMessage)" href="#aiperf.common.models.BaseMessage">BaseMessage</a></code></p>


        <p>Message containing heartbeat data.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">HeartbeatMessage</span><span class="p">(</span><span class="n">BaseMessage</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Message containing heartbeat data.&quot;&quot;&quot;</span>

    <span class="n">payload</span><span class="p">:</span> <span class="n">HeartbeatPayload</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.HeartbeatPayload" class="doc doc-heading">
            <code>HeartbeatPayload</code>


<a href="#aiperf.common.models.HeartbeatPayload" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StatusPayload (aiperf.common.models.StatusPayload)" href="#aiperf.common.models.StatusPayload">StatusPayload</a></code></p>


        <p>Heartbeat payload sent periodically by services.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">HeartbeatPayload</span><span class="p">(</span><span class="n">StatusPayload</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Heartbeat payload sent periodically by services.&quot;&quot;&quot;</span>

    <span class="n">message_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">MessageType</span><span class="o">.</span><span class="n">HEARTBEAT</span><span class="p">]</span> <span class="o">=</span> <span class="n">MessageType</span><span class="o">.</span><span class="n">HEARTBEAT</span>

    <span class="n">state</span><span class="p">:</span> <span class="n">ServiceState</span> <span class="o">=</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">RUNNING</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.RegistrationMessage" class="doc doc-heading">
            <code>RegistrationMessage</code>


<a href="#aiperf.common.models.RegistrationMessage" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseMessage (aiperf.common.models.BaseMessage)" href="#aiperf.common.models.BaseMessage">BaseMessage</a></code></p>


        <p>Message containing registration data.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RegistrationMessage</span><span class="p">(</span><span class="n">BaseMessage</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Message containing registration data.&quot;&quot;&quot;</span>

    <span class="n">payload</span><span class="p">:</span> <span class="n">RegistrationPayload</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.RegistrationPayload" class="doc doc-heading">
            <code>RegistrationPayload</code>


<a href="#aiperf.common.models.RegistrationPayload" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="StatusPayload (aiperf.common.models.StatusPayload)" href="#aiperf.common.models.StatusPayload">StatusPayload</a></code></p>


        <p>Registration payload sent by services to register themselves.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RegistrationPayload</span><span class="p">(</span><span class="n">StatusPayload</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Registration payload sent by services to register themselves.&quot;&quot;&quot;</span>

    <span class="n">message_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">MessageType</span><span class="o">.</span><span class="n">REGISTRATION</span><span class="p">]</span> <span class="o">=</span> <span class="n">MessageType</span><span class="o">.</span><span class="n">REGISTRATION</span>

    <span class="n">state</span><span class="p">:</span> <span class="n">ServiceState</span> <span class="o">=</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">READY</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.ServiceRunInfo" class="doc doc-heading">
            <code>ServiceRunInfo</code>


<a href="#aiperf.common.models.ServiceRunInfo" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Base model for tracking service run information.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ServiceRunInfo</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base model for tracking service run information.&quot;&quot;&quot;</span>

    <span class="n">service_type</span><span class="p">:</span> <span class="n">ServiceType</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The type of service&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">registration_status</span><span class="p">:</span> <span class="n">ServiceRegistrationStatus</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The registration status of the service&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">service_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The ID of the service&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">first_seen</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The first time the service was seen&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">last_seen</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The last time the service was seen&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">state</span><span class="p">:</span> <span class="n">ServiceState</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="n">ServiceState</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;The current state of the service&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.StatusMessage" class="doc doc-heading">
            <code>StatusMessage</code>


<a href="#aiperf.common.models.StatusMessage" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseMessage (aiperf.common.models.BaseMessage)" href="#aiperf.common.models.BaseMessage">BaseMessage</a></code></p>


        <p>Message containing status data.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">StatusMessage</span><span class="p">(</span><span class="n">BaseMessage</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Message containing status data.&quot;&quot;&quot;</span>

    <span class="n">payload</span><span class="p">:</span> <span class="n">StatusPayload</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.StatusPayload" class="doc doc-heading">
            <code>StatusPayload</code>


<a href="#aiperf.common.models.StatusPayload" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BasePayload (aiperf.common.models.BasePayload)" href="#aiperf.common.models.BasePayload">BasePayload</a></code></p>


        <p>Status payload sent by services to report their current state.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">StatusPayload</span><span class="p">(</span><span class="n">BasePayload</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Status payload sent by services to report their current state.&quot;&quot;&quot;</span>

    <span class="n">message_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="n">MessageType</span><span class="o">.</span><span class="n">STATUS</span><span class="p">]</span> <span class="o">=</span> <span class="n">MessageType</span><span class="o">.</span><span class="n">STATUS</span>

    <span class="n">state</span><span class="p">:</span> <span class="n">ServiceState</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Current state of the service&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">service_type</span><span class="p">:</span> <span class="n">ServiceType</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Type of service&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.ZMQCommunicationConfig" class="doc doc-heading">
            <code>ZMQCommunicationConfig</code>


<a href="#aiperf.common.models.ZMQCommunicationConfig" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Configuration for ZMQ communication.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ZMQCommunicationConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration for ZMQ communication.&quot;&quot;&quot;</span>

    <span class="n">protocol_config</span><span class="p">:</span> <span class="n">ZMQTCPTransportConfig</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="n">ZMQTCPTransportConfig</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Configuration for the selected transport protocol&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">client_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Client ID, will be generated if not provided&quot;</span>
    <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">controller_pub_sub_address</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the controller pub/sub address based on protocol configuration.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;tcp://</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol_config</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol_config</span><span class="o">.</span><span class="n">controller_pub_sub_port</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">component_pub_sub_address</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the component pub/sub address based on protocol configuration.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;tcp://</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol_config</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol_config</span><span class="o">.</span><span class="n">component_pub_sub_port</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">inference_push_pull_address</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the inference push/pull address based on protocol configuration.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;tcp://</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol_config</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol_config</span><span class="o">.</span><span class="n">inference_push_pull_port</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">records_address</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the records address based on protocol configuration.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;tcp://</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol_config</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol_config</span><span class="o">.</span><span class="n">records_port</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">conversation_data_address</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the conversation data address based on protocol configuration.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;tcp://</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol_config</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol_config</span><span class="o">.</span><span class="n">conversation_data_port</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">credit_drop_address</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the credit drop address based on protocol configuration.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;tcp://</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol_config</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol_config</span><span class="o">.</span><span class="n">credit_drop_port</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">credit_return_address</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the credit return address based on protocol configuration.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;tcp://</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol_config</span><span class="o">.</span><span class="n">host</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol_config</span><span class="o">.</span><span class="n">credit_return_port</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.models.ZMQCommunicationConfig.component_pub_sub_address" class="doc doc-heading">
            <code class=" language-python"><span class="n">component_pub_sub_address</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.models.ZMQCommunicationConfig.component_pub_sub_address" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the component pub/sub address based on protocol configuration.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.models.ZMQCommunicationConfig.controller_pub_sub_address" class="doc doc-heading">
            <code class=" language-python"><span class="n">controller_pub_sub_address</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.models.ZMQCommunicationConfig.controller_pub_sub_address" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the controller pub/sub address based on protocol configuration.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.models.ZMQCommunicationConfig.conversation_data_address" class="doc doc-heading">
            <code class=" language-python"><span class="n">conversation_data_address</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.models.ZMQCommunicationConfig.conversation_data_address" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the conversation data address based on protocol configuration.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.models.ZMQCommunicationConfig.credit_drop_address" class="doc doc-heading">
            <code class=" language-python"><span class="n">credit_drop_address</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.models.ZMQCommunicationConfig.credit_drop_address" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the credit drop address based on protocol configuration.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.models.ZMQCommunicationConfig.credit_return_address" class="doc doc-heading">
            <code class=" language-python"><span class="n">credit_return_address</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.models.ZMQCommunicationConfig.credit_return_address" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the credit return address based on protocol configuration.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.models.ZMQCommunicationConfig.inference_push_pull_address" class="doc doc-heading">
            <code class=" language-python"><span class="n">inference_push_pull_address</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.models.ZMQCommunicationConfig.inference_push_pull_address" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the inference push/pull address based on protocol configuration.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.models.ZMQCommunicationConfig.records_address" class="doc doc-heading">
            <code class=" language-python"><span class="n">records_address</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.models.ZMQCommunicationConfig.records_address" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the records address based on protocol configuration.</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.common.models.ZMQTCPTransportConfig" class="doc doc-heading">
            <code>ZMQTCPTransportConfig</code>


<a href="#aiperf.common.models.ZMQTCPTransportConfig" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Configuration for TCP transport.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/models.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ZMQTCPTransportConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration for TCP transport.&quot;&quot;&quot;</span>

    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;0.0.0.0&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Host address for TCP connections&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">controller_pub_sub_port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">5555</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Port for controller pub/sub messages&quot;</span>
    <span class="p">)</span>
    <span class="n">component_pub_sub_port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">5556</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Port for component pub/sub messages&quot;</span>
    <span class="p">)</span>
    <span class="n">inference_push_pull_port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">5557</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Port for inference push/pull messages&quot;</span>
    <span class="p">)</span>
    <span class="n">req_rep_port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">5558</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Port for sending and receiving requests&quot;</span>
    <span class="p">)</span>
    <span class="n">push_pull_port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">5559</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Port for pushing and pulling data&quot;</span>
    <span class="p">)</span>
    <span class="n">records_port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">5560</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Port for record data&quot;</span><span class="p">)</span>
    <span class="n">conversation_data_port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">5561</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Port for conversation data&quot;</span>
    <span class="p">)</span>
    <span class="n">credit_drop_port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">5562</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Port for credit drop operations&quot;</span>
    <span class="p">)</span>
    <span class="n">credit_return_port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">5563</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Port for credit return operations&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommonservicebase_component_service">aiperf.common.service.base_component_service<a class="headerlink" href="#aiperfcommonservicebase_component_service" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.service.base_component_service"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.common.service.base_component_service.BaseComponentService" class="doc doc-heading">
            <code>BaseComponentService</code>


<a href="#aiperf.common.service.base_component_service.BaseComponentService" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseService (aiperf.common.service.base_service.BaseService)" href="#aiperf.common.service.base_service.BaseService">BaseService</a></code></p>


        <p>Base class for all Component services.</p>
<p>This class provides a common interface for all Component services in the AIPerf
framework such as the Timing Manager, Dataset Manager, etc.</p>
<p>It extends the BaseService by:
- Subscribing to the command topic
- Processing command messages
- Sending registration requests to the system controller
- Sending heartbeat notifications to the system controller
- Sending status notifications to the system controller
- Helpers to create heartbeat, registration, and status messages
- Request the appropriate communication clients for a component service</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/service/base_component_service.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BaseComponentService</span><span class="p">(</span><span class="n">BaseService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for all Component services.</span>

<span class="sd">    This class provides a common interface for all Component services in the AIPerf</span>
<span class="sd">    framework such as the Timing Manager, Dataset Manager, etc.</span>

<span class="sd">    It extends the BaseService by:</span>
<span class="sd">    - Subscribing to the command topic</span>
<span class="sd">    - Processing command messages</span>
<span class="sd">    - Sending registration requests to the system controller</span>
<span class="sd">    - Sending heartbeat notifications to the system controller</span>
<span class="sd">    - Sending status notifications to the system controller</span>
<span class="sd">    - Helpers to create heartbeat, registration, and status messages</span>
<span class="sd">    - Request the appropriate communication clients for a component service</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">service_config</span><span class="p">:</span> <span class="n">ServiceConfig</span><span class="p">,</span> <span class="n">service_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">service_config</span><span class="o">=</span><span class="n">service_config</span><span class="p">,</span> <span class="n">service_id</span><span class="o">=</span><span class="n">service_id</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">required_clients</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ClientType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The communication clients required by the service.</span>

<span class="sd">        The component services subscribe to controller messages and publish</span>
<span class="sd">        component messages.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="o">*</span><span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">required_clients</span> <span class="ow">or</span> <span class="p">[]),</span>
            <span class="n">PubClientType</span><span class="o">.</span><span class="n">COMPONENT</span><span class="p">,</span>
            <span class="n">SubClientType</span><span class="o">.</span><span class="n">CONTROLLER</span><span class="p">,</span>
        <span class="p">]</span>

    <span class="c1"># TODO: The configure method is turning into a service hook</span>
    <span class="c1"># @abstractmethod</span>
    <span class="c1"># async def _configure(self, payload: Payload) -&gt; None:</span>
    <span class="c1">#     &quot;&quot;&quot;Configure the service with the given configuration payload.</span>

    <span class="c1">#     This method is called when a configure command is received from the controller.</span>
    <span class="c1">#     It should be implemented by the derived class to configure the service.</span>

    <span class="c1">#     The service should validate the payload and configure itself accordingly.</span>
    <span class="c1">#     If successful, the service should publish a success message to the controller.</span>
    <span class="c1">#     On failure, the service should publish an error message to the controller.</span>

    <span class="c1">#     Args:</span>
    <span class="c1">#         payload: The configuration payload. This is a union type of all the possible</span>
    <span class="c1">#         configuration payloads.</span>

    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     pass</span>

    <span class="nd">@on_run</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_on_run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Automatically subscribe to the command topic and register the service</span>
<span class="sd">        with the system controller when the run hook is called.</span>

<span class="sd">        This method will:</span>
<span class="sd">        - Subscribe to the command topic</span>
<span class="sd">        - Wait for the communication to be fully initialized</span>
<span class="sd">        - Register the service with the system controller</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Subscribe to the command topic</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">comms</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span>
                <span class="n">Topic</span><span class="o">.</span><span class="n">COMMAND</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">process_command_message</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Exception subscribing to command topic: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationSubscribeError</span><span class="p">(</span>
                <span class="s2">&quot;Failed to subscribe to command topic&quot;</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="c1"># TODO: Find a way to wait for the communication to be fully initialized</span>
        <span class="c1"># FIXME: This is a hack to ensure the communication is fully initialized</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Register the service</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">register</span><span class="p">()</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ServiceRegistrationError</span><span class="p">()</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="nd">@aiperf_task</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_heartbeat_task</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Starts a background task to send heartbeats at regular intervals. It</span>
<span class="sd">        will continue to send heartbeats even if an error occurs until the stop</span>
<span class="sd">        event is set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
            <span class="c1"># Sleep first to avoid sending a heartbeat before the registration</span>
            <span class="c1"># message has been published</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_heartbeat_interval</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_heartbeat</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Exception sending heartbeat: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="c1"># continue to keep sending heartbeats regardless of the error</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Heartbeat task stopped&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">send_heartbeat</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Send a heartbeat notification to the system controller.&quot;&quot;&quot;</span>
        <span class="n">heartbeat_message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_heartbeat_message</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Sending heartbeat: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">heartbeat_message</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">comms</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span>
                <span class="n">topic</span><span class="o">=</span><span class="n">Topic</span><span class="o">.</span><span class="n">HEARTBEAT</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="n">heartbeat_message</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ServiceHeartbeatError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Publish a registration request to the system controller.</span>

<span class="sd">        This method should be called after the service has been initialized and is</span>
<span class="sd">        ready to start processing messages.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;Attempting to register service </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) with system controller&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">comms</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span>
                <span class="n">topic</span><span class="o">=</span><span class="n">Topic</span><span class="o">.</span><span class="n">REGISTRATION</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">create_registration_message</span><span class="p">(),</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ServiceRegistrationError</span><span class="p">()</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">process_command_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">CommandMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process a command message received from the controller.</span>

<span class="sd">        This method will process the command message and execute the appropriate action.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">message</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">target_service_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">]:</span>
            <span class="k">return</span>  <span class="c1"># Ignore commands meant for other services</span>

        <span class="n">cmd</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">command</span>
        <span class="k">if</span> <span class="n">cmd</span> <span class="o">==</span> <span class="n">CommandType</span><span class="o">.</span><span class="n">START</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">cmd</span> <span class="o">==</span> <span class="n">CommandType</span><span class="o">.</span><span class="n">STOP</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">cmd</span> <span class="o">==</span> <span class="n">CommandType</span><span class="o">.</span><span class="n">CONFIGURE</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">CONFIGURE</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="si">}</span><span class="s2"> received unknown command: </span><span class="si">{</span><span class="n">cmd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nd">@on_set_state</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_on_set_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">ServiceState</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Action to take when the service state is set.</span>

<span class="sd">        This method will also publish the status message to the status topic if the</span>
<span class="sd">        communications are initialized.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comms</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comms</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">comms</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span>
                <span class="n">topic</span><span class="o">=</span><span class="n">Topic</span><span class="o">.</span><span class="n">STATUS</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">create_status_message</span><span class="p">(</span><span class="n">state</span><span class="p">),</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_heartbeat_message</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HeartbeatMessage</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a heartbeat notification message.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">HeartbeatMessage</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span>
                <span class="n">HeartbeatPayload</span><span class="p">(</span>
                    <span class="n">service_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_registration_message</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RegistrationMessage</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a registration request message.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">RegistrationMessage</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span>
                <span class="n">RegistrationPayload</span><span class="p">(</span>
                    <span class="n">service_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_status_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">ServiceState</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StatusMessage</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a status notification message.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">StatusMessage</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span>
                <span class="n">StatusPayload</span><span class="p">(</span>
                    <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span>
                    <span class="n">service_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">),</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.service.base_component_service.BaseComponentService.required_clients" class="doc doc-heading">
            <code class=" language-python"><span class="n">required_clients</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.service.base_component_service.BaseComponentService.required_clients" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The communication clients required by the service.</p>
<p>The component services subscribe to controller messages and publish
component messages.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="aiperf.common.service.base_component_service.BaseComponentService.create_heartbeat_message" class="doc doc-heading">
            <code class=" language-python"><span class="n">create_heartbeat_message</span><span class="p">()</span></code>

<a href="#aiperf.common.service.base_component_service.BaseComponentService.create_heartbeat_message" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create a heartbeat notification message.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/service/base_component_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_heartbeat_message</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HeartbeatMessage</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a heartbeat notification message.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span>
        <span class="n">HeartbeatMessage</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span>
            <span class="n">HeartbeatPayload</span><span class="p">(</span>
                <span class="n">service_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.service.base_component_service.BaseComponentService.create_registration_message" class="doc doc-heading">
            <code class=" language-python"><span class="n">create_registration_message</span><span class="p">()</span></code>

<a href="#aiperf.common.service.base_component_service.BaseComponentService.create_registration_message" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create a registration request message.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/service/base_component_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_registration_message</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RegistrationMessage</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a registration request message.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span>
        <span class="n">RegistrationMessage</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span>
            <span class="n">RegistrationPayload</span><span class="p">(</span>
                <span class="n">service_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.service.base_component_service.BaseComponentService.create_status_message" class="doc doc-heading">
            <code class=" language-python"><span class="n">create_status_message</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></code>

<a href="#aiperf.common.service.base_component_service.BaseComponentService.create_status_message" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create a status notification message.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/service/base_component_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_status_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">ServiceState</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StatusMessage</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a status notification message.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span>
        <span class="n">StatusMessage</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span>
            <span class="n">StatusPayload</span><span class="p">(</span>
                <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span>
                <span class="n">service_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.service.base_component_service.BaseComponentService.process_command_message" class="doc doc-heading">
            <code class=" language-python"><span class="n">process_command_message</span><span class="p">(</span><span class="n">message</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.service.base_component_service.BaseComponentService.process_command_message" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Process a command message received from the controller.</p>
<p>This method will process the command message and execute the appropriate action.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/service/base_component_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">process_command_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">CommandMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process a command message received from the controller.</span>

<span class="sd">    This method will process the command message and execute the appropriate action.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">message</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">target_service_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">]:</span>
        <span class="k">return</span>  <span class="c1"># Ignore commands meant for other services</span>

    <span class="n">cmd</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">command</span>
    <span class="k">if</span> <span class="n">cmd</span> <span class="o">==</span> <span class="n">CommandType</span><span class="o">.</span><span class="n">START</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">elif</span> <span class="n">cmd</span> <span class="o">==</span> <span class="n">CommandType</span><span class="o">.</span><span class="n">STOP</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="k">elif</span> <span class="n">cmd</span> <span class="o">==</span> <span class="n">CommandType</span><span class="o">.</span><span class="n">CONFIGURE</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">CONFIGURE</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="si">}</span><span class="s2"> received unknown command: </span><span class="si">{</span><span class="n">cmd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.service.base_component_service.BaseComponentService.register" class="doc doc-heading">
            <code class=" language-python"><span class="n">register</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.service.base_component_service.BaseComponentService.register" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Publish a registration request to the system controller.</p>
<p>This method should be called after the service has been initialized and is
ready to start processing messages.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/service/base_component_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Publish a registration request to the system controller.</span>

<span class="sd">    This method should be called after the service has been initialized and is</span>
<span class="sd">    ready to start processing messages.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="s2">&quot;Attempting to register service </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) with system controller&quot;</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">comms</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span>
            <span class="n">topic</span><span class="o">=</span><span class="n">Topic</span><span class="o">.</span><span class="n">REGISTRATION</span><span class="p">,</span>
            <span class="n">message</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">create_registration_message</span><span class="p">(),</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ServiceRegistrationError</span><span class="p">()</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.service.base_component_service.BaseComponentService.send_heartbeat" class="doc doc-heading">
            <code class=" language-python"><span class="n">send_heartbeat</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.service.base_component_service.BaseComponentService.send_heartbeat" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Send a heartbeat notification to the system controller.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/service/base_component_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">send_heartbeat</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Send a heartbeat notification to the system controller.&quot;&quot;&quot;</span>
    <span class="n">heartbeat_message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_heartbeat_message</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Sending heartbeat: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">heartbeat_message</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">comms</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span>
            <span class="n">topic</span><span class="o">=</span><span class="n">Topic</span><span class="o">.</span><span class="n">HEARTBEAT</span><span class="p">,</span>
            <span class="n">message</span><span class="o">=</span><span class="n">heartbeat_message</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ServiceHeartbeatError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommonservicebase_controller_service">aiperf.common.service.base_controller_service<a class="headerlink" href="#aiperfcommonservicebase_controller_service" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.service.base_controller_service"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.common.service.base_controller_service.BaseControllerService" class="doc doc-heading">
            <code>BaseControllerService</code>


<a href="#aiperf.common.service.base_controller_service.BaseControllerService" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseService (aiperf.common.service.base_service.BaseService)" href="#aiperf.common.service.base_service.BaseService">BaseService</a></code></p>


        <p>Base class for all controller services, such as the System Controller.</p>
<p>This class provides a common interface for all controller services in the AIPerf
framework. It inherits from the BaseService class and implements the required
methods for controller services.</p>
<p>It extends the BaseService by:
- Starting the service automatically when the run hook is called
- Helpers to create command messages to be sent to a specific service
- Request the appropriate communication clients for a controller service</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/service/base_controller_service.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BaseControllerService</span><span class="p">(</span><span class="n">BaseService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for all controller services, such as the System Controller.</span>

<span class="sd">    This class provides a common interface for all controller services in the AIPerf</span>
<span class="sd">    framework. It inherits from the BaseService class and implements the required</span>
<span class="sd">    methods for controller services.</span>

<span class="sd">    It extends the BaseService by:</span>
<span class="sd">    - Starting the service automatically when the run hook is called</span>
<span class="sd">    - Helpers to create command messages to be sent to a specific service</span>
<span class="sd">    - Request the appropriate communication clients for a controller service</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">service_config</span><span class="p">:</span> <span class="n">ServiceConfig</span><span class="p">,</span> <span class="n">service_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">service_config</span><span class="o">=</span><span class="n">service_config</span><span class="p">,</span> <span class="n">service_id</span><span class="o">=</span><span class="n">service_id</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">required_clients</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ClientType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The communication clients required by the service.</span>

<span class="sd">        The controller service subscribes to controller messages and publishes</span>
<span class="sd">        to components.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="o">*</span><span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">required_clients</span> <span class="ow">or</span> <span class="p">[]),</span>
            <span class="n">PubClientType</span><span class="o">.</span><span class="n">CONTROLLER</span><span class="p">,</span>
            <span class="n">SubClientType</span><span class="o">.</span><span class="n">COMPONENT</span><span class="p">,</span>
        <span class="p">]</span>

    <span class="nd">@on_run</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_on_run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Automatically start the service when the run hook is called.&quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_command_message</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">,</span>
        <span class="n">target_service_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Message</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a command message to be sent to a specific service.</span>

<span class="sd">        Args:</span>
<span class="sd">            command: The command to send</span>
<span class="sd">            target_service_id: The ID of the service to send the command to</span>
<span class="sd">            data: Optional data to send with the command.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A command message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span>
            <span class="n">CommandPayload</span><span class="p">(</span>
                <span class="n">command</span><span class="o">=</span><span class="n">command</span><span class="p">,</span>
                <span class="n">target_service_id</span><span class="o">=</span><span class="n">target_service_id</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.service.base_controller_service.BaseControllerService.required_clients" class="doc doc-heading">
            <code class=" language-python"><span class="n">required_clients</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.service.base_controller_service.BaseControllerService.required_clients" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The communication clients required by the service.</p>
<p>The controller service subscribes to controller messages and publishes
to components.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="aiperf.common.service.base_controller_service.BaseControllerService.create_command_message" class="doc doc-heading">
            <code class=" language-python"><span class="n">create_command_message</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">target_service_id</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#aiperf.common.service.base_controller_service.BaseControllerService.create_command_message" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create a command message to be sent to a specific service.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>command</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommandType (aiperf.common.enums.CommandType)" href="#aiperf.common.enums.CommandType">CommandType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The command to send</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_service_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the service to send the command to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional data to send with the command.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A command message</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/service/base_controller_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_command_message</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">command</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">,</span>
    <span class="n">target_service_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Message</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a command message to be sent to a specific service.</span>

<span class="sd">    Args:</span>
<span class="sd">        command: The command to send</span>
<span class="sd">        target_service_id: The ID of the service to send the command to</span>
<span class="sd">        data: Optional data to send with the command.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A command message</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span>
        <span class="n">CommandPayload</span><span class="p">(</span>
            <span class="n">command</span><span class="o">=</span><span class="n">command</span><span class="p">,</span>
            <span class="n">target_service_id</span><span class="o">=</span><span class="n">target_service_id</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommonservicebase_service">aiperf.common.service.base_service<a class="headerlink" href="#aiperfcommonservicebase_service" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.service.base_service"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.common.service.base_service.BaseService" class="doc doc-heading">
            <code>BaseService</code>


<a href="#aiperf.common.service.base_service.BaseService" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseServiceInterface (aiperf.common.service.base_service_interface.BaseServiceInterface)" href="#aiperf.common.service.base_service_interface.BaseServiceInterface">BaseServiceInterface</a></code>, <code><span title="abc.ABC">ABC</span></code></p>


        <p>Base class for all AIPerf services, providing common functionality for
communication, state management, and lifecycle operations.</p>
<p>This class provides the foundation for implementing the various services of the
AIPerf system. Some of the abstract methods are implemented here, while others
are still required to be implemented by derived classes.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/service/base_service.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BaseService</span><span class="p">(</span><span class="n">BaseServiceInterface</span><span class="p">,</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">ServiceMetaclass</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for all AIPerf services, providing common functionality for</span>
<span class="sd">    communication, state management, and lifecycle operations.</span>

<span class="sd">    This class provides the foundation for implementing the various services of the</span>
<span class="sd">    AIPerf system. Some of the abstract methods are implemented here, while others</span>
<span class="sd">    are still required to be implemented by derived classes.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_aiperf_hooks</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callable</span><span class="p">]]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">service_config</span><span class="p">:</span> <span class="n">ServiceConfig</span><span class="p">,</span> <span class="n">service_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">service_id</span> <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">service_config</span> <span class="o">=</span> <span class="n">service_config</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Initializing </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="si">}</span><span class="s2"> service (id: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_state</span><span class="p">:</span> <span class="n">ServiceState</span> <span class="o">=</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">UNKNOWN</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_heartbeat_interval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">heartbeat_interval</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_task_registry</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialized_event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_comms</span><span class="p">:</span> <span class="n">BaseCommunication</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Set to store signal handler tasks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_signal_tasks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="c1"># noinspection PyBroadException</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">setproctitle</span><span class="o">.</span><span class="n">setproctitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;aiperf </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>  <span class="c1"># noqa: E722</span>
            <span class="c1"># setproctitle is not available on all platforms, so we ignore the error</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Failed to set process title, ignoring&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;__init__ finished for </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">comms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseCommunication</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the communication object for the service.</span>
<span class="sd">        Raises:</span>
<span class="sd">            CommunicationNotInitializedError: If the communication is not initialized</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comms</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CommunicationNotInitializedError</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comms</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">state</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ServiceState</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The current state of the service.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_initialized</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if service is initialized.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if service is initialized, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if service is shutdown.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if service is shutdown, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hook_type</span><span class="p">:</span> <span class="n">AIPerfHooks</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callable</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all the hooks for the given hook type.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Getting hooks for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">hook_type</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_aiperf_hooks</span><span class="p">[</span><span class="n">hook_type</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aiperf_hooks</span><span class="p">[</span><span class="n">hook_type</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_run_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hook_type</span><span class="p">:</span> <span class="n">AIPerfHooks</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run all the hooks for the given hook type.</span>

<span class="sd">        Args:</span>
<span class="sd">            hook_type: The type of hook to run</span>
<span class="sd">            *args: The arguments to pass to the hooks</span>
<span class="sd">            **kwargs: The keyword arguments to pass to the hooks</span>

<span class="sd">        Raises:</span>
<span class="sd">            AIPerfMultiError: If any of the hooks raise an exception</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="n">call_all_functions_self</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_hooks</span><span class="p">(</span><span class="n">hook_type</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Note: Not using as a setter so it can be overridden by derived classes and still</span>
    <span class="c1"># be async</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">ServiceState</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the state of the service. This method implements</span>
<span class="sd">        the `BaseServiceInterface.set_state` method.</span>

<span class="sd">        This method will:</span>
<span class="sd">        - Set the service state to the given state</span>
<span class="sd">        - Call all registered `AIPerfHooks.SET_STATE` hooks</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_state</span> <span class="o">=</span> <span class="n">state</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">SET_STATE</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the service communication and signal handlers. This method implements</span>
<span class="sd">        the `BaseServiceInterface.initialize` method.</span>

<span class="sd">        This method will:</span>
<span class="sd">        - Set the service to `ServiceState.INITIALIZING` state</span>
<span class="sd">        - Set up signal handlers for graceful shutdown</span>
<span class="sd">        - Allow time for the event loop to start</span>
<span class="sd">        - Initialize communication</span>
<span class="sd">        - Call all registered `AIPerfHooks.INIT` hooks</span>
<span class="sd">        - Set the service to `ServiceState.READY` state</span>
<span class="sd">        - Set the initialized asyncio event</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_state</span> <span class="o">=</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">INITIALIZING</span>
        <span class="c1"># Set up signal handlers for graceful shutdown</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_signal_handlers</span><span class="p">()</span>
        <span class="c1"># Allow time for the event loop to start</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

        <span class="c1"># Initialize communication</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_comms</span> <span class="o">=</span> <span class="n">CommunicationFactory</span><span class="o">.</span><span class="n">create_communication</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">service_config</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
                <span class="s2">&quot;Failed to create communication for service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationCreateError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comms</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
                <span class="s2">&quot;Failed to initialize communication for service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">ServiceInitializationError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">required_clients</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Create the communication clients ahead of time</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">: Creating communication clients (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">required_clients</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comms</span><span class="o">.</span><span class="n">create_clients</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">required_clients</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
                    <span class="s2">&quot;Failed to create communication clients for service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">raise</span> <span class="n">CommunicationClientCreationError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="c1"># Initialize any derived service components</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">INIT</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">AIPerfMultiError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
                <span class="s2">&quot;Failed to initialize service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">ServiceInitializationError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">ServiceState</span><span class="o">.</span><span class="n">READY</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run_forever</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run the service in a loop until the stop event is set. This method implements</span>
<span class="sd">        the `BaseServiceInterface.run_forever` method.</span>

<span class="sd">        This method will:</span>
<span class="sd">        - Call the initialize method to initialize the service</span>
<span class="sd">        - Start all the registered tasks</span>
<span class="sd">        - Call all registered `AIPerfHooks.RUN` hooks</span>
<span class="sd">        - Wait for the stop event to be set</span>
<span class="sd">        - Shuts down the service when the stop event is set</span>

<span class="sd">        This method will be called as the main entry point for the service.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;Running </span><span class="si">%s</span><span class="s2"> service (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span>
            <span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
                    <span class="s2">&quot;Failed to initialize service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">raise</span> <span class="n">ServiceRunError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

            <span class="c1"># Start all registered tasks</span>
            <span class="k">for</span> <span class="n">hook</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">TASK</span><span class="p">):</span>
                <span class="c1"># TODO: support task intervals</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_task_registry</span><span class="p">[</span><span class="n">hook</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">hook</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">RUN</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">AIPerfMultiError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
                    <span class="s2">&quot;Failed to run service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">raise</span> <span class="n">ServiceRunError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Service </span><span class="si">%s</span><span class="s2"> execution cancelled&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Service </span><span class="si">%s</span><span class="s2"> execution failed:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">)</span>
            <span class="n">_</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">ServiceState</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">ServiceRunError</span><span class="p">(</span>
                <span class="s2">&quot;Service </span><span class="si">%s</span><span class="s2"> execution failed&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forever_loop</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_forever_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method will be called by the `run_forever` method to allow the service to run</span>
<span class="sd">        indefinitely. This method is not expected to be overridden by derived classes.</span>

<span class="sd">        This method will:</span>
<span class="sd">        - Wait for the stop event to be set</span>
<span class="sd">        - Shuts down the service when the stop event is set</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="s2">&quot;Service </span><span class="si">%s</span><span class="s2"> waiting for stop event&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span>
                <span class="p">)</span>
                <span class="c1"># Wait forever for the stop event to be set</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>

            <span class="k">except</span> <span class="p">(</span><span class="ne">KeyboardInterrupt</span><span class="p">,</span> <span class="ne">SystemExit</span><span class="p">,</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Service </span><span class="si">%s</span><span class="s2"> execution cancelled&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
                    <span class="s2">&quot;Caught unexpected exception in service </span><span class="si">%s</span><span class="s2"> execution&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="c1"># Shutdown the service</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
                        <span class="s2">&quot;Exception stopping service </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span>
                    <span class="p">)</span>
                    <span class="k">raise</span> <span class="n">ServiceStopError</span><span class="p">(</span>
                        <span class="s2">&quot;Exception stopping service </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span>
                    <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start the service and its components. This method implements</span>
<span class="sd">        the `BaseServiceInterface.start` method.</span>

<span class="sd">        This method should be called to start the service after it has been initialized</span>
<span class="sd">        and configured.</span>

<span class="sd">        This method will:</span>
<span class="sd">        - Set the service to `ServiceState.STARTING` state</span>
<span class="sd">        - Call all registered `AIPerfHooks.START` hooks</span>
<span class="sd">        - Set the service to `ServiceState.RUNNING` state</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;Starting </span><span class="si">%s</span><span class="s2"> service (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span>
            <span class="p">)</span>
            <span class="n">_</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">ServiceState</span><span class="o">.</span><span class="n">STARTING</span><span class="p">)</span>

            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">START</span><span class="p">)</span>

            <span class="n">_</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">ServiceState</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Service </span><span class="si">%s</span><span class="s2"> execution cancelled&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
                <span class="s2">&quot;Failed to start service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_state</span> <span class="o">=</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">ERROR</span>

            <span class="k">raise</span> <span class="n">ServiceStartError</span><span class="p">(</span>
                <span class="s2">&quot;Failed to start service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop the service and clean up its components. This method implements</span>
<span class="sd">        the `BaseServiceInterface.stop` method.</span>

<span class="sd">        This method will:</span>
<span class="sd">        - Set the service to `ServiceState.STOPPING` state</span>
<span class="sd">        - Call all registered `AIPerfHooks.STOP` hooks</span>
<span class="sd">        - Shutdown the service communication component</span>
<span class="sd">        - Cancel all registered tasks</span>
<span class="sd">        - Call all registered `AIPerfHooks.CLEANUP` hooks</span>
<span class="sd">        - Set the service to `ServiceState.STOPPED` state</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">STOPPED</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;Service </span><span class="si">%s</span><span class="s2"> state </span><span class="si">%s</span><span class="s2"> is already STOPPED, ignoring stop request&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">return</span>

            <span class="c1"># ignore if we were unable to send the STOPPING state message</span>
            <span class="n">_</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">ServiceState</span><span class="o">.</span><span class="n">STOPPING</span><span class="p">)</span>

            <span class="c1"># Signal the run method to exit if it hasn&#39;t already</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

            <span class="c1"># Custom stop logic implemented by derived classes</span>
            <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">suppress</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">):</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">STOP</span><span class="p">)</span>

            <span class="c1"># Shutdown communication component</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comms</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comms</span><span class="o">.</span><span class="n">is_shutdown</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comms</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>

            <span class="c1"># Cancel all registered tasks</span>
            <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_task_registry</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>

            <span class="c1"># Wait for all tasks to complete</span>
            <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">suppress</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">):</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_task_registry</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

            <span class="c1"># Custom cleanup logic implemented by derived classes</span>
            <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">suppress</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">):</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">CLEANUP</span><span class="p">)</span>

            <span class="c1"># Set the state to STOPPED. Communications are shutdown, so we don&#39;t need to</span>
            <span class="c1"># publish a status message</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_state</span> <span class="o">=</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">STOPPED</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;Service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">) stopped&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span>
            <span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
                <span class="s2">&quot;Failed to stop service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_state</span> <span class="o">=</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">ERROR</span>
            <span class="k">raise</span> <span class="n">ServiceStopError</span><span class="p">(</span>
                <span class="s2">&quot;Failed to stop service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Configure the service with the given configuration. This method implements</span>
<span class="sd">        the `BaseServiceInterface.configure` method.</span>

<span class="sd">        This method will:</span>
<span class="sd">        - Call all registered AIPerfHooks.CONFIGURE hooks</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">CONFIGURE</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_message</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">payload</span><span class="p">:</span> <span class="n">Payload</span><span class="p">,</span> <span class="n">request_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Message</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a message of the given type, and pre-fill the service_id.</span>

<span class="sd">        Args:</span>
<span class="sd">            payload: The payload of the message</span>
<span class="sd">            request_id: optional The request id of this message, or the request id of the</span>
<span class="sd">                message this is a response to</span>

<span class="sd">        Returns:</span>
<span class="sd">            A message of the given type</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">BaseMessage</span><span class="p">(</span>
            <span class="n">service_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
            <span class="n">request_id</span><span class="o">=</span><span class="n">request_id</span><span class="p">,</span>
            <span class="n">payload</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">message</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_setup_signal_handlers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This method will set up signal handlers for the SIGTERM and SIGINT signals</span>
<span class="sd">        in order to trigger a graceful shutdown of the service.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">signal_handler</span><span class="p">(</span><span class="n">sig</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Create a task and store it so it doesn&#39;t get garbage collected</span>
            <span class="n">task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle_signal</span><span class="p">(</span><span class="n">sig</span><span class="p">))</span>

            <span class="c1"># Store the task somewhere to prevent it from being garbage collected</span>
            <span class="c1"># before it completes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_signal_tasks</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
            <span class="n">task</span><span class="o">.</span><span class="n">add_done_callback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_signal_tasks</span><span class="o">.</span><span class="n">discard</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">sig</span> <span class="ow">in</span> <span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGTERM</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">SIGINT</span><span class="p">):</span>
            <span class="n">loop</span><span class="o">.</span><span class="n">add_signal_handler</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="o">=</span><span class="n">sig</span><span class="p">:</span> <span class="n">signal_handler</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_handle_signal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sig</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle received signals by triggering graceful shutdown.</span>

<span class="sd">        Args:</span>
<span class="sd">            sig: The signal number received</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">signal_name</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">Signals</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">: Received signal </span><span class="si">%s</span><span class="s2">, initiating graceful shutdown&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
            <span class="n">signal_name</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.service.base_service.BaseService.comms" class="doc doc-heading">
            <code class=" language-python"><span class="n">comms</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.service.base_service.BaseService.comms" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the communication object for the service.
Raises:
    CommunicationNotInitializedError: If the communication is not initialized</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.service.base_service.BaseService.is_initialized" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_initialized</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.service.base_service.BaseService.is_initialized" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if service is initialized.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if service is initialized, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.service.base_service.BaseService.is_shutdown" class="doc doc-heading">
            <code class=" language-python"><span class="n">is_shutdown</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.service.base_service.BaseService.is_shutdown" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if service is shutdown.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if service is shutdown, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.service.base_service.BaseService.state" class="doc doc-heading">
            <code class=" language-python"><span class="n">state</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.service.base_service.BaseService.state" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The current state of the service.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="aiperf.common.service.base_service.BaseService.configure" class="doc doc-heading">
            <code class=" language-python"><span class="n">configure</span><span class="p">(</span><span class="n">message</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.service.base_service.BaseService.configure" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Configure the service with the given configuration. This method implements
the <code>BaseServiceInterface.configure</code> method.</p>
<p>This method will:
- Call all registered AIPerfHooks.CONFIGURE hooks</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/service/base_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configure the service with the given configuration. This method implements</span>
<span class="sd">    the `BaseServiceInterface.configure` method.</span>

<span class="sd">    This method will:</span>
<span class="sd">    - Call all registered AIPerfHooks.CONFIGURE hooks</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">CONFIGURE</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.service.base_service.BaseService.create_message" class="doc doc-heading">
            <code class=" language-python"><span class="n">create_message</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">request_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#aiperf.common.service.base_service.BaseService.create_message" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create a message of the given type, and pre-fill the service_id.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>payload</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Payload = Union[DataPayload, HeartbeatPayload, RegistrationPayload, StatusPayload, CommandPayload, CreditDropPayload, CreditReturnPayload, ErrorPayload]

  
      module-attribute
   (aiperf.common.models.Payload)" href="#aiperf.common.models.Payload">Payload</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The payload of the message</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>request_id</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional The request id of this message, or the request id of the
message this is a response to</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Message = Union[BaseMessage, DataMessage, HeartbeatMessage, RegistrationMessage, StatusMessage, CommandMessage, CreditDropMessage, CreditReturnMessage, ErrorMessage]

  
      module-attribute
   (aiperf.common.models.Message)" href="#aiperf.common.models.Message">Message</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A message of the given type</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/service/base_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_message</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">payload</span><span class="p">:</span> <span class="n">Payload</span><span class="p">,</span> <span class="n">request_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Message</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a message of the given type, and pre-fill the service_id.</span>

<span class="sd">    Args:</span>
<span class="sd">        payload: The payload of the message</span>
<span class="sd">        request_id: optional The request id of this message, or the request id of the</span>
<span class="sd">            message this is a response to</span>

<span class="sd">    Returns:</span>
<span class="sd">        A message of the given type</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">BaseMessage</span><span class="p">(</span>
        <span class="n">service_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
        <span class="n">request_id</span><span class="o">=</span><span class="n">request_id</span><span class="p">,</span>
        <span class="n">payload</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">message</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.service.base_service.BaseService.initialize" class="doc doc-heading">
            <code class=" language-python"><span class="n">initialize</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.service.base_service.BaseService.initialize" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize the service communication and signal handlers. This method implements
the <code>BaseServiceInterface.initialize</code> method.</p>
<p>This method will:
- Set the service to <code>ServiceState.INITIALIZING</code> state
- Set up signal handlers for graceful shutdown
- Allow time for the event loop to start
- Initialize communication
- Call all registered <code>AIPerfHooks.INIT</code> hooks
- Set the service to <code>ServiceState.READY</code> state
- Set the initialized asyncio event</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/service/base_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the service communication and signal handlers. This method implements</span>
<span class="sd">    the `BaseServiceInterface.initialize` method.</span>

<span class="sd">    This method will:</span>
<span class="sd">    - Set the service to `ServiceState.INITIALIZING` state</span>
<span class="sd">    - Set up signal handlers for graceful shutdown</span>
<span class="sd">    - Allow time for the event loop to start</span>
<span class="sd">    - Initialize communication</span>
<span class="sd">    - Call all registered `AIPerfHooks.INIT` hooks</span>
<span class="sd">    - Set the service to `ServiceState.READY` state</span>
<span class="sd">    - Set the initialized asyncio event</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_state</span> <span class="o">=</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">INITIALIZING</span>
    <span class="c1"># Set up signal handlers for graceful shutdown</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_setup_signal_handlers</span><span class="p">()</span>
    <span class="c1"># Allow time for the event loop to start</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="c1"># Initialize communication</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_comms</span> <span class="o">=</span> <span class="n">CommunicationFactory</span><span class="o">.</span><span class="n">create_communication</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">service_config</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
            <span class="s2">&quot;Failed to create communication for service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="n">CommunicationCreateError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comms</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
            <span class="s2">&quot;Failed to initialize communication for service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="n">ServiceInitializationError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">required_clients</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Create the communication clients ahead of time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">: Creating communication clients (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">required_clients</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comms</span><span class="o">.</span><span class="n">create_clients</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">required_clients</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
                <span class="s2">&quot;Failed to create communication clients for service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationClientCreationError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="c1"># Initialize any derived service components</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">INIT</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">AIPerfMultiError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
            <span class="s2">&quot;Failed to initialize service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="n">ServiceInitializationError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">ServiceState</span><span class="o">.</span><span class="n">READY</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.service.base_service.BaseService.run_forever" class="doc doc-heading">
            <code class=" language-python"><span class="n">run_forever</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.service.base_service.BaseService.run_forever" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Run the service in a loop until the stop event is set. This method implements
the <code>BaseServiceInterface.run_forever</code> method.</p>
<p>This method will:
- Call the initialize method to initialize the service
- Start all the registered tasks
- Call all registered <code>AIPerfHooks.RUN</code> hooks
- Wait for the stop event to be set
- Shuts down the service when the stop event is set</p>
<p>This method will be called as the main entry point for the service.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/service/base_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run_forever</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run the service in a loop until the stop event is set. This method implements</span>
<span class="sd">    the `BaseServiceInterface.run_forever` method.</span>

<span class="sd">    This method will:</span>
<span class="sd">    - Call the initialize method to initialize the service</span>
<span class="sd">    - Start all the registered tasks</span>
<span class="sd">    - Call all registered `AIPerfHooks.RUN` hooks</span>
<span class="sd">    - Wait for the stop event to be set</span>
<span class="sd">    - Shuts down the service when the stop event is set</span>

<span class="sd">    This method will be called as the main entry point for the service.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;Running </span><span class="si">%s</span><span class="s2"> service (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span>
        <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
                <span class="s2">&quot;Failed to initialize service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">ServiceRunError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="c1"># Start all registered tasks</span>
        <span class="k">for</span> <span class="n">hook</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">TASK</span><span class="p">):</span>
            <span class="c1"># TODO: support task intervals</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_task_registry</span><span class="p">[</span><span class="n">hook</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">hook</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">RUN</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">AIPerfMultiError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
                <span class="s2">&quot;Failed to run service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">ServiceRunError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Service </span><span class="si">%s</span><span class="s2"> execution cancelled&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Service </span><span class="si">%s</span><span class="s2"> execution failed:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">)</span>
        <span class="n">_</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">ServiceState</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">ServiceRunError</span><span class="p">(</span>
            <span class="s2">&quot;Service </span><span class="si">%s</span><span class="s2"> execution failed&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span>
        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forever_loop</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.service.base_service.BaseService.set_state" class="doc doc-heading">
            <code class=" language-python"><span class="n">set_state</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.service.base_service.BaseService.set_state" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Set the state of the service. This method implements
the <code>BaseServiceInterface.set_state</code> method.</p>
<p>This method will:
- Set the service state to the given state
- Call all registered <code>AIPerfHooks.SET_STATE</code> hooks</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/service/base_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">ServiceState</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the state of the service. This method implements</span>
<span class="sd">    the `BaseServiceInterface.set_state` method.</span>

<span class="sd">    This method will:</span>
<span class="sd">    - Set the service state to the given state</span>
<span class="sd">    - Call all registered `AIPerfHooks.SET_STATE` hooks</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_state</span> <span class="o">=</span> <span class="n">state</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">SET_STATE</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.service.base_service.BaseService.start" class="doc doc-heading">
            <code class=" language-python"><span class="n">start</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.service.base_service.BaseService.start" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Start the service and its components. This method implements
the <code>BaseServiceInterface.start</code> method.</p>
<p>This method should be called to start the service after it has been initialized
and configured.</p>
<p>This method will:
- Set the service to <code>ServiceState.STARTING</code> state
- Call all registered <code>AIPerfHooks.START</code> hooks
- Set the service to <code>ServiceState.RUNNING</code> state</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/service/base_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Start the service and its components. This method implements</span>
<span class="sd">    the `BaseServiceInterface.start` method.</span>

<span class="sd">    This method should be called to start the service after it has been initialized</span>
<span class="sd">    and configured.</span>

<span class="sd">    This method will:</span>
<span class="sd">    - Set the service to `ServiceState.STARTING` state</span>
<span class="sd">    - Call all registered `AIPerfHooks.START` hooks</span>
<span class="sd">    - Set the service to `ServiceState.RUNNING` state</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;Starting </span><span class="si">%s</span><span class="s2"> service (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span>
        <span class="p">)</span>
        <span class="n">_</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">ServiceState</span><span class="o">.</span><span class="n">STARTING</span><span class="p">)</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">START</span><span class="p">)</span>

        <span class="n">_</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">ServiceState</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">)</span>

    <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Service </span><span class="si">%s</span><span class="s2"> execution cancelled&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
            <span class="s2">&quot;Failed to start service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_state</span> <span class="o">=</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">ERROR</span>

        <span class="k">raise</span> <span class="n">ServiceStartError</span><span class="p">(</span>
            <span class="s2">&quot;Failed to start service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.service.base_service.BaseService.stop" class="doc doc-heading">
            <code class=" language-python"><span class="n">stop</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.service.base_service.BaseService.stop" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Stop the service and clean up its components. This method implements
the <code>BaseServiceInterface.stop</code> method.</p>
<p>This method will:
- Set the service to <code>ServiceState.STOPPING</code> state
- Call all registered <code>AIPerfHooks.STOP</code> hooks
- Shutdown the service communication component
- Cancel all registered tasks
- Call all registered <code>AIPerfHooks.CLEANUP</code> hooks
- Set the service to <code>ServiceState.STOPPED</code> state</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/service/base_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stop the service and clean up its components. This method implements</span>
<span class="sd">    the `BaseServiceInterface.stop` method.</span>

<span class="sd">    This method will:</span>
<span class="sd">    - Set the service to `ServiceState.STOPPING` state</span>
<span class="sd">    - Call all registered `AIPerfHooks.STOP` hooks</span>
<span class="sd">    - Shutdown the service communication component</span>
<span class="sd">    - Cancel all registered tasks</span>
<span class="sd">    - Call all registered `AIPerfHooks.CLEANUP` hooks</span>
<span class="sd">    - Set the service to `ServiceState.STOPPED` state</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">STOPPED</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Service </span><span class="si">%s</span><span class="s2"> state </span><span class="si">%s</span><span class="s2"> is already STOPPED, ignoring stop request&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># ignore if we were unable to send the STOPPING state message</span>
        <span class="n">_</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">ServiceState</span><span class="o">.</span><span class="n">STOPPING</span><span class="p">)</span>

        <span class="c1"># Signal the run method to exit if it hasn&#39;t already</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

        <span class="c1"># Custom stop logic implemented by derived classes</span>
        <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">suppress</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">STOP</span><span class="p">)</span>

        <span class="c1"># Shutdown communication component</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comms</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comms</span><span class="o">.</span><span class="n">is_shutdown</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comms</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>

        <span class="c1"># Cancel all registered tasks</span>
        <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_task_registry</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>

        <span class="c1"># Wait for all tasks to complete</span>
        <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">suppress</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">):</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_task_registry</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="c1"># Custom cleanup logic implemented by derived classes</span>
        <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">suppress</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_hooks</span><span class="p">(</span><span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">CLEANUP</span><span class="p">)</span>

        <span class="c1"># Set the state to STOPPED. Communications are shutdown, so we don&#39;t need to</span>
        <span class="c1"># publish a status message</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_state</span> <span class="o">=</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">STOPPED</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;Service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">) stopped&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
            <span class="s2">&quot;Failed to stop service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_state</span> <span class="o">=</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">ERROR</span>
        <span class="k">raise</span> <span class="n">ServiceStopError</span><span class="p">(</span>
            <span class="s2">&quot;Failed to stop service </span><span class="si">%s</span><span class="s2"> (id: </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommonservicebase_service_interface">aiperf.common.service.base_service_interface<a class="headerlink" href="#aiperfcommonservicebase_service_interface" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.service.base_service_interface"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.common.service.base_service_interface.BaseServiceInterface" class="doc doc-heading">
            <code>BaseServiceInterface</code>


<a href="#aiperf.common.service.base_service_interface.BaseServiceInterface" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>


        <p>Base interface for all services.</p>
<p>This class provides the base foundation for which every service should provide. Some
methods are required to be implemented by derived classes, while others are
meant to be implemented by the base class.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/service/base_service_interface.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BaseServiceInterface</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base interface for all services.</span>

<span class="sd">    This class provides the base foundation for which every service should provide. Some</span>
<span class="sd">    methods are required to be implemented by derived classes, while others are</span>
<span class="sd">    meant to be implemented by the base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">required_clients</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ClientType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The communication clients required by the service. If nothing is returned,</span>
<span class="sd">        the service will be responsible for creating its own clients.</span>

<span class="sd">        This property should be implemented by derived classes to specify the</span>
<span class="sd">        communication clients that the service requires.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">service_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ServiceType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The type/name of the service.</span>

<span class="sd">        This property should be implemented by derived classes to specify the</span>
<span class="sd">        type/name of the service.&quot;&quot;&quot;</span>
        <span class="c1"># TODO: We can do this better by using a decorator to set the service type</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">ServiceState</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the state of the service.</span>

<span class="sd">        This method will be implemented by the base class, and extra</span>
<span class="sd">        functionality can be added by derived classes via the `@on_set_state`</span>
<span class="sd">        decorator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the service.</span>

<span class="sd">        This method will be implemented by the base class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start the service. It should be called after the service has been initialized</span>
<span class="sd">        and configured.</span>

<span class="sd">        This method will be implemented by the base class, and extra</span>
<span class="sd">        functionality can be added by derived classes via the `@on_start`</span>
<span class="sd">        decorator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop the service.</span>

<span class="sd">        This method will be implemented by the base class, and extra</span>
<span class="sd">        functionality can be added by derived classes via the `@on_stop`</span>
<span class="sd">        decorator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Configure the service with the given configuration.</span>

<span class="sd">        This method will be implemented by the base class, and extra</span>
<span class="sd">        functionality can be added by derived classes via the `@on_configure`</span>
<span class="sd">        decorator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run_forever</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run the service. This method will be the primary entry point for the service</span>
<span class="sd">        and will be called by the bootstrap script. It should not return until the</span>
<span class="sd">        service is completely shutdown.</span>

<span class="sd">        This method will be implemented by the base class. Any additional</span>
<span class="sd">        functionality can be added by derived classes via the `@on_run`</span>
<span class="sd">        decorator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_forever_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run the service in a loop until the stop event is set. This method will be</span>
<span class="sd">        called by the `run` method to allow the service to run indefinitely.</span>

<span class="sd">        This method will be implemented by the base class, and is not expected to be</span>
<span class="sd">        overridden by derived classes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.service.base_service_interface.BaseServiceInterface.required_clients" class="doc doc-heading">
            <code class=" language-python"><span class="n">required_clients</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.required_clients" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The communication clients required by the service. If nothing is returned,
the service will be responsible for creating its own clients.</p>
<p>This property should be implemented by derived classes to specify the
communication clients that the service requires.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.common.service.base_service_interface.BaseServiceInterface.service_type" class="doc doc-heading">
            <code class=" language-python"><span class="n">service_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.service_type" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The type/name of the service.</p>
<p>This property should be implemented by derived classes to specify the
type/name of the service.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="aiperf.common.service.base_service_interface.BaseServiceInterface.configure" class="doc doc-heading">
            <code class=" language-python"><span class="n">configure</span><span class="p">(</span><span class="n">message</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.configure" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Configure the service with the given configuration.</p>
<p>This method will be implemented by the base class, and extra
functionality can be added by derived classes via the <code>@on_configure</code>
decorator.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/service/base_service_interface.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configure the service with the given configuration.</span>

<span class="sd">    This method will be implemented by the base class, and extra</span>
<span class="sd">    functionality can be added by derived classes via the `@on_configure`</span>
<span class="sd">    decorator.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.service.base_service_interface.BaseServiceInterface.initialize" class="doc doc-heading">
            <code class=" language-python"><span class="n">initialize</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.initialize" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize the service.</p>
<p>This method will be implemented by the base class.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/service/base_service_interface.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the service.</span>

<span class="sd">    This method will be implemented by the base class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.service.base_service_interface.BaseServiceInterface.run_forever" class="doc doc-heading">
            <code class=" language-python"><span class="n">run_forever</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.run_forever" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Run the service. This method will be the primary entry point for the service
and will be called by the bootstrap script. It should not return until the
service is completely shutdown.</p>
<p>This method will be implemented by the base class. Any additional
functionality can be added by derived classes via the <code>@on_run</code>
decorator.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/service/base_service_interface.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run_forever</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run the service. This method will be the primary entry point for the service</span>
<span class="sd">    and will be called by the bootstrap script. It should not return until the</span>
<span class="sd">    service is completely shutdown.</span>

<span class="sd">    This method will be implemented by the base class. Any additional</span>
<span class="sd">    functionality can be added by derived classes via the `@on_run`</span>
<span class="sd">    decorator.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.service.base_service_interface.BaseServiceInterface.set_state" class="doc doc-heading">
            <code class=" language-python"><span class="n">set_state</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.set_state" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Set the state of the service.</p>
<p>This method will be implemented by the base class, and extra
functionality can be added by derived classes via the <code>@on_set_state</code>
decorator.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/service/base_service_interface.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">ServiceState</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the state of the service.</span>

<span class="sd">    This method will be implemented by the base class, and extra</span>
<span class="sd">    functionality can be added by derived classes via the `@on_set_state`</span>
<span class="sd">    decorator.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.service.base_service_interface.BaseServiceInterface.start" class="doc doc-heading">
            <code class=" language-python"><span class="n">start</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.start" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Start the service. It should be called after the service has been initialized
and configured.</p>
<p>This method will be implemented by the base class, and extra
functionality can be added by derived classes via the <code>@on_start</code>
decorator.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/service/base_service_interface.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Start the service. It should be called after the service has been initialized</span>
<span class="sd">    and configured.</span>

<span class="sd">    This method will be implemented by the base class, and extra</span>
<span class="sd">    functionality can be added by derived classes via the `@on_start`</span>
<span class="sd">    decorator.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.service.base_service_interface.BaseServiceInterface.stop" class="doc doc-heading">
            <code class=" language-python"><span class="n">stop</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.service.base_service_interface.BaseServiceInterface.stop" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Stop the service.</p>
<p>This method will be implemented by the base class, and extra
functionality can be added by derived classes via the <code>@on_stop</code>
decorator.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/service/base_service_interface.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stop the service.</span>

<span class="sd">    This method will be implemented by the base class, and extra</span>
<span class="sd">    functionality can be added by derived classes via the `@on_stop`</span>
<span class="sd">    decorator.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommonserviceservice_metaclass">aiperf.common.service.service_metaclass<a class="headerlink" href="#aiperfcommonserviceservice_metaclass" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.service.service_metaclass"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.common.service.service_metaclass.ServiceMetaclass" class="doc doc-heading">
            <code>ServiceMetaclass</code>


<a href="#aiperf.common.service.service_metaclass.ServiceMetaclass" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseMetaclass (aiperf.common.base_metaclass.BaseMetaclass)" href="#aiperf.common.base_metaclass.BaseMetaclass">BaseMetaclass</a></code></p>


        <p>Meta class for services.</p>
<p>This meta class is used to collect the hooks for a service. All of the logic
for the hooks is implemented in the BaseMetaclass.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/service/service_metaclass.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@register_metaclass</span><span class="p">(</span>
    <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">INIT</span><span class="p">,</span>
    <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">START</span><span class="p">,</span>
    <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">STOP</span><span class="p">,</span>
    <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">CLEANUP</span><span class="p">,</span>
    <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">RUN</span><span class="p">,</span>
    <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">CONFIGURE</span><span class="p">,</span>
    <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">TASK</span><span class="p">,</span>
    <span class="n">AIPerfHooks</span><span class="o">.</span><span class="n">SET_STATE</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ServiceMetaclass</span><span class="p">(</span><span class="n">BaseMetaclass</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Meta class for services.</span>

<span class="sd">    This meta class is used to collect the hooks for a service. All of the logic</span>
<span class="sd">    for the hooks is implemented in the BaseMetaclass.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommontokenizer">aiperf.common.tokenizer<a class="headerlink" href="#aiperfcommontokenizer" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.tokenizer"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.common.tokenizer.Tokenizer" class="doc doc-heading">
            <code>Tokenizer</code>


<a href="#aiperf.common.tokenizer.Tokenizer" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>This class provides a simplified interface for using Huggingface
tokenizers, with default arguments for common operations.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/common/tokenizer.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Tokenizer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class provides a simplified interface for using Huggingface</span>
<span class="sd">    tokenizers, with default arguments for common operations.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the tokenizer with default values for call, encode, and decode.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_call_args</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;add_special_tokens&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_encode_args</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;add_special_tokens&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_decode_args</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;skip_special_tokens&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_pretrained</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">trust_remote_code</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">revision</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Tokenizer&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Factory to load a tokenizer for the given pretrained model name.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The name or path of the pretrained tokenizer model.</span>
<span class="sd">            trust_remote_code: Whether to trust remote code when loading the tokenizer.</span>
<span class="sd">            revision: The specific model version to use.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tokenizer</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="n">tokenizer</span><span class="o">.</span><span class="n">_set_tokenizer</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="p">,</span> <span class="n">revision</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tokenizer</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_set_tokenizer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">revision</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the tokenizer from Huggingface.co or local filesystem.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The name or path of the tokenizer.</span>
<span class="sd">            trust_remote_code: Whether to trust remote code when loading the tokenizer.</span>
<span class="sd">            revision: The specific model version to use.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Silence tokenizer warning on import and first use</span>
            <span class="k">with</span> <span class="p">(</span>
                <span class="n">contextlib</span><span class="o">.</span><span class="n">redirect_stdout</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">())</span> <span class="k">as</span> <span class="n">_</span><span class="p">,</span>
                <span class="n">contextlib</span><span class="o">.</span><span class="n">redirect_stderr</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()),</span>
            <span class="p">):</span>
                <span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoTokenizer</span>
                <span class="kn">from</span><span class="w"> </span><span class="nn">transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">logging</span> <span class="k">as</span> <span class="n">token_logger</span>

                <span class="n">token_logger</span><span class="o">.</span><span class="n">set_verbosity_error</span><span class="p">()</span>
                <span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span>
                    <span class="n">name</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="o">=</span><span class="n">trust_remote_code</span><span class="p">,</span> <span class="n">revision</span><span class="o">=</span><span class="n">revision</span>
                <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TokenizerInitializationError</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span> <span class="o">=</span> <span class="n">tokenizer</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BatchEncoding&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Call the underlying Huggingface tokenizer with default arguments,</span>
<span class="sd">        which can be overridden by kwargs.</span>

<span class="sd">        Args:</span>
<span class="sd">            text: The input text to tokenize.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A BatchEncoding object containing the tokenized output.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TokenizerInitializationError</span><span class="p">(</span><span class="s2">&quot;Tokenizer is not initialized.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_call_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">})</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Encode the input text into a list of token IDs.</span>

<span class="sd">        This method calls the underlying Huggingface tokenizer&#39;s encode</span>
<span class="sd">        method with default arguments, which can be overridden by kwargs.</span>

<span class="sd">        Args:</span>
<span class="sd">            text: The input text to encode.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of token IDs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TokenizerInitializationError</span><span class="p">(</span><span class="s2">&quot;Tokenizer is not initialized.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_encode_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">})</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token_ids</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Decode a list of token IDs back into a string.</span>

<span class="sd">        This method calls the underlying Huggingface tokenizer&#39;s decode</span>
<span class="sd">        method with default arguments, which can be overridden by kwargs.</span>

<span class="sd">        Args:</span>
<span class="sd">            token_ids: A list of token IDs to decode.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The decoded string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TokenizerInitializationError</span><span class="p">(</span><span class="s2">&quot;Tokenizer is not initialized.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">token_ids</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_decode_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">})</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">bos_token_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the beginning-of-sequence (BOS) token ID.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">TokenizerInitializationError</span><span class="p">(</span><span class="s2">&quot;Tokenizer is not initialized.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span><span class="o">.</span><span class="n">bos_token_id</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a string representation of the underlying tokenizer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The string representation of the tokenizer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a user-friendly string representation of the underlying tokenizer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The string representation of the tokenizer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.common.tokenizer.Tokenizer.__call__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#aiperf.common.tokenizer.Tokenizer.__call__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Call the underlying Huggingface tokenizer with default arguments,
which can be overridden by kwargs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>text</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input text to tokenize.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="transformers.BatchEncoding">BatchEncoding</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A BatchEncoding object containing the tokenized output.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/tokenizer.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BatchEncoding&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Call the underlying Huggingface tokenizer with default arguments,</span>
<span class="sd">    which can be overridden by kwargs.</span>

<span class="sd">    Args:</span>
<span class="sd">        text: The input text to tokenize.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A BatchEncoding object containing the tokenized output.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">TokenizerInitializationError</span><span class="p">(</span><span class="s2">&quot;Tokenizer is not initialized.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_call_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.tokenizer.Tokenizer.__init__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__init__</span><span class="p">()</span></code>

<a href="#aiperf.common.tokenizer.Tokenizer.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize the tokenizer with default values for call, encode, and decode.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/tokenizer.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the tokenizer with default values for call, encode, and decode.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_call_args</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;add_special_tokens&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_encode_args</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;add_special_tokens&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_decode_args</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;skip_special_tokens&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.tokenizer.Tokenizer.__repr__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#aiperf.common.tokenizer.Tokenizer.__repr__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return a string representation of the underlying tokenizer.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string representation of the tokenizer.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/tokenizer.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a string representation of the underlying tokenizer.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The string representation of the tokenizer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.tokenizer.Tokenizer.__str__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#aiperf.common.tokenizer.Tokenizer.__str__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return a user-friendly string representation of the underlying tokenizer.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string representation of the tokenizer.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/tokenizer.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a user-friendly string representation of the underlying tokenizer.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The string representation of the tokenizer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.tokenizer.Tokenizer.bos_token_id" class="doc doc-heading">
            <code class=" language-python"><span class="n">bos_token_id</span><span class="p">()</span></code>

<a href="#aiperf.common.tokenizer.Tokenizer.bos_token_id" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the beginning-of-sequence (BOS) token ID.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/tokenizer.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bos_token_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the beginning-of-sequence (BOS) token ID.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">TokenizerInitializationError</span><span class="p">(</span><span class="s2">&quot;Tokenizer is not initialized.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span><span class="o">.</span><span class="n">bos_token_id</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.tokenizer.Tokenizer.decode" class="doc doc-heading">
            <code class=" language-python"><span class="n">decode</span><span class="p">(</span><span class="n">token_ids</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#aiperf.common.tokenizer.Tokenizer.decode" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Decode a list of token IDs back into a string.</p>
<p>This method calls the underlying Huggingface tokenizer's decode
method with default arguments, which can be overridden by kwargs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>token_ids</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of token IDs to decode.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The decoded string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/tokenizer.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token_ids</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decode a list of token IDs back into a string.</span>

<span class="sd">    This method calls the underlying Huggingface tokenizer&#39;s decode</span>
<span class="sd">    method with default arguments, which can be overridden by kwargs.</span>

<span class="sd">    Args:</span>
<span class="sd">        token_ids: A list of token IDs to decode.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The decoded string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">TokenizerInitializationError</span><span class="p">(</span><span class="s2">&quot;Tokenizer is not initialized.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">token_ids</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_decode_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.tokenizer.Tokenizer.encode" class="doc doc-heading">
            <code class=" language-python"><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#aiperf.common.tokenizer.Tokenizer.encode" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Encode the input text into a list of token IDs.</p>
<p>This method calls the underlying Huggingface tokenizer's encode
method with default arguments, which can be overridden by kwargs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>text</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input text to encode.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of token IDs.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/tokenizer.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Encode the input text into a list of token IDs.</span>

<span class="sd">    This method calls the underlying Huggingface tokenizer&#39;s encode</span>
<span class="sd">    method with default arguments, which can be overridden by kwargs.</span>

<span class="sd">    Args:</span>
<span class="sd">        text: The input text to encode.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of token IDs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">TokenizerInitializationError</span><span class="p">(</span><span class="s2">&quot;Tokenizer is not initialized.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_encode_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.common.tokenizer.Tokenizer.from_pretrained" class="doc doc-heading">
            <code class=" language-python"><span class="n">from_pretrained</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">revision</span><span class="o">=</span><span class="s1">&#39;main&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#aiperf.common.tokenizer.Tokenizer.from_pretrained" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Factory to load a tokenizer for the given pretrained model name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name or path of the pretrained tokenizer model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>trust_remote_code</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to trust remote code when loading the tokenizer.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>revision</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The specific model version to use.</p>
              </div>
            </td>
            <td>
                  <code>&#39;main&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/tokenizer.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_pretrained</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">trust_remote_code</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">revision</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Tokenizer&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Factory to load a tokenizer for the given pretrained model name.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: The name or path of the pretrained tokenizer model.</span>
<span class="sd">        trust_remote_code: Whether to trust remote code when loading the tokenizer.</span>
<span class="sd">        revision: The specific model version to use.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tokenizer</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
    <span class="n">tokenizer</span><span class="o">.</span><span class="n">_set_tokenizer</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="p">,</span> <span class="n">revision</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tokenizer</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfcommonutils">aiperf.common.utils<a class="headerlink" href="#aiperfcommonutils" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.common.utils"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="aiperf.common.utils.call_all_functions" class="doc doc-heading">
            <code class=" language-python"><span class="n">call_all_functions</span><span class="p">(</span><span class="n">funcs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.utils.call_all_functions" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Call all functions in the list with the given name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>obj</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The object to call the functions on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>func_names</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The names of the functions to call.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>*args</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The arguments to pass to the functions.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The keyword arguments to pass to the functions.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="AIPerfMultiError (aiperf.common.exceptions.AIPerfMultiError)" href="#aiperf.common.exceptions.AIPerfMultiError">AIPerfMultiError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any of the functions raise an exception.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/utils.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">call_all_functions</span><span class="p">(</span><span class="n">funcs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callable</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Call all functions in the list with the given name.</span>

<span class="sd">    Args:</span>
<span class="sd">        obj: The object to call the functions on.</span>
<span class="sd">        func_names: The names of the functions to call.</span>
<span class="sd">        *args: The arguments to pass to the functions.</span>
<span class="sd">        **kwargs: The keyword arguments to pass to the functions.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AIPerfMultiError: If any of the functions raise an exception.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">exceptions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">funcs</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">iscoroutinefunction</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
                <span class="k">await</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># TODO: error handling, logging</span>
            <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
            <span class="n">exceptions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">exceptions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AIPerfMultiError</span><span class="p">(</span><span class="n">exceptions</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="aiperf.common.utils.call_all_functions_self" class="doc doc-heading">
            <code class=" language-python"><span class="n">call_all_functions_self</span><span class="p">(</span><span class="n">self_</span><span class="p">,</span> <span class="n">funcs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.common.utils.call_all_functions_self" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Call all functions in the list with the given name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>obj</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The object to call the functions on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>func_names</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The names of the functions to call.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>*args</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The arguments to pass to the functions.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The keyword arguments to pass to the functions.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="AIPerfMultiError (aiperf.common.exceptions.AIPerfMultiError)" href="#aiperf.common.exceptions.AIPerfMultiError">AIPerfMultiError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any of the functions raise an exception.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/common/utils.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">call_all_functions_self</span><span class="p">(</span>
    <span class="n">self_</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">funcs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Callable</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Call all functions in the list with the given name.</span>

<span class="sd">    Args:</span>
<span class="sd">        obj: The object to call the functions on.</span>
<span class="sd">        func_names: The names of the functions to call.</span>
<span class="sd">        *args: The arguments to pass to the functions.</span>
<span class="sd">        **kwargs: The keyword arguments to pass to the functions.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AIPerfMultiError: If any of the functions raise an exception.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">exceptions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">funcs</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">iscoroutinefunction</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
                <span class="k">await</span> <span class="n">func</span><span class="p">(</span><span class="n">self_</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">func</span><span class="p">(</span><span class="n">self_</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># TODO: error handling, logging</span>
            <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
            <span class="n">exceptions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">exceptions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AIPerfMultiError</span><span class="p">(</span><span class="n">exceptions</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="aiperfservicesdatasetdataset_manager">aiperf.services.dataset.dataset_manager<a class="headerlink" href="#aiperfservicesdatasetdataset_manager" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.services.dataset.dataset_manager"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.services.dataset.dataset_manager.DatasetManager" class="doc doc-heading">
            <code>DatasetManager</code>


<a href="#aiperf.services.dataset.dataset_manager.DatasetManager" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseComponentService (aiperf.common.service.base_component_service.BaseComponentService)" href="#aiperf.common.service.base_component_service.BaseComponentService">BaseComponentService</a></code></p>


        <p>The DatasetManager primary responsibility is to manage the data generation or acquisition.
For synthetic generation, it contains the code to generate the prompts or tokens.
It will have an API for dataset acquisition of a dataset if available in a remote repository or database.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/services/dataset/dataset_manager.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DatasetManager</span><span class="p">(</span><span class="n">BaseComponentService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The DatasetManager primary responsibility is to manage the data generation or acquisition.</span>
<span class="sd">    For synthetic generation, it contains the code to generate the prompts or tokens.</span>
<span class="sd">    It will have an API for dataset acquisition of a dataset if available in a remote repository or database.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">service_config</span><span class="p">:</span> <span class="n">ServiceConfig</span><span class="p">,</span>
        <span class="n">service_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">service_config</span><span class="o">=</span><span class="n">service_config</span><span class="p">,</span> <span class="n">service_id</span><span class="o">=</span><span class="n">service_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Initializing dataset manager&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">service_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ServiceType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The type of service.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ServiceType</span><span class="o">.</span><span class="n">DATASET_MANAGER</span>

    <span class="nd">@on_init</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize dataset manager-specific components.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Initializing dataset manager&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Implement dataset manager initialization</span>

    <span class="nd">@on_start</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start the dataset manager.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Starting dataset manager&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Implement dataset manager start</span>

    <span class="nd">@on_stop</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop the dataset manager.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Stopping dataset manager&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Implement dataset manager stop</span>

    <span class="nd">@on_cleanup</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clean up dataset manager-specific components.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Cleaning up dataset manager&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Implement dataset manager cleanup</span>

    <span class="nd">@on_configure</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payload</span><span class="p">:</span> <span class="n">BasePayload</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Configure the dataset manager.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Configuring dataset manager with payload: </span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="aiperf.services.dataset.dataset_manager.DatasetManager.service_type" class="doc doc-heading">
            <code class=" language-python"><span class="n">service_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.services.dataset.dataset_manager.DatasetManager.service_type" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The type of service.</p>

    </div>

</div>





  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="aiperf.services.dataset.dataset_manager.main" class="doc doc-heading">
            <code class=" language-python"><span class="n">main</span><span class="p">()</span></code>

<a href="#aiperf.services.dataset.dataset_manager.main" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Main entry point for the dataset manager.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/dataset/dataset_manager.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Main entry point for the dataset manager.&quot;&quot;&quot;</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">aiperf.common.bootstrap</span><span class="w"> </span><span class="kn">import</span> <span class="n">bootstrap_and_run_service</span>

    <span class="n">bootstrap_and_run_service</span><span class="p">(</span><span class="n">DatasetManager</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="aiperfservicesdatasetgeneratoraudio">aiperf.services.dataset.generator.audio<a class="headerlink" href="#aiperfservicesdatasetgeneratoraudio" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.services.dataset.generator.audio"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.services.dataset.generator.audio.AudioGenerator" class="doc doc-heading">
            <code>AudioGenerator</code>


<a href="#aiperf.services.dataset.generator.audio.AudioGenerator" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>A class for generating synthetic audio data.</p>
<p>This class provides methods to create audio samples with specified
characteristics such as format (WAV, MP3), length, sampling rate,
bit depth, and number of channels. It supports validation of audio
parameters to ensure compatibility with chosen formats.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/services/dataset/generator/audio.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AudioGenerator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for generating synthetic audio data.</span>

<span class="sd">    This class provides methods to create audio samples with specified</span>
<span class="sd">    characteristics such as format (WAV, MP3), length, sampling rate,</span>
<span class="sd">    bit depth, and number of channels. It supports validation of audio</span>
<span class="sd">    parameters to ensure compatibility with chosen formats.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_sample_positive_normal</span><span class="p">(</span>
        <span class="n">mean</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">stddev</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">min_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sample from a normal distribution ensuring positive values without distorting the distribution.</span>
<span class="sd">        Uses rejection sampling to maintain the proper shape of the distribution.</span>

<span class="sd">        Args:</span>
<span class="sd">            mean: Mean value for the normal distribution</span>
<span class="sd">            stddev: Standard deviation for the normal distribution</span>
<span class="sd">            min_value: Minimum acceptable value</span>

<span class="sd">        Returns:</span>
<span class="sd">            A positive sample from the normal distribution</span>

<span class="sd">        Raises:</span>
<span class="sd">            GeneratorConfigurationError: If mean is less than min_value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">mean</span> <span class="o">&lt;</span> <span class="n">min_value</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GeneratorConfigurationError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Mean value (</span><span class="si">{</span><span class="n">mean</span><span class="si">}</span><span class="s2">) must be greater than min_value (</span><span class="si">{</span><span class="n">min_value</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="p">)</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">stddev</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sample</span> <span class="o">&gt;=</span> <span class="n">min_value</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">sample</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_sampling_rate</span><span class="p">(</span><span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">audio_format</span><span class="p">:</span> <span class="n">AudioFormat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate sampling rate for the given output format.</span>

<span class="sd">        Args:</span>
<span class="sd">            sampling_rate: Sampling rate in Hz</span>
<span class="sd">            audio_format: Audio format</span>

<span class="sd">        Raises:</span>
<span class="sd">            GeneratorConfigurationError: If sampling rate is not supported for the given format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">audio_format</span> <span class="o">==</span> <span class="n">AudioFormat</span><span class="o">.</span><span class="n">MP3</span>
            <span class="ow">and</span> <span class="n">sampling_rate</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">MP3_SUPPORTED_SAMPLE_RATES</span>
        <span class="p">):</span>
            <span class="n">supported_rates</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">MP3_SUPPORTED_SAMPLE_RATES</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">GeneratorConfigurationError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;MP3 format only supports the following sample rates (in Hz): </span><span class="si">{</span><span class="n">supported_rates</span><span class="si">}</span><span class="s2">. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">sampling_rate</span><span class="si">}</span><span class="s2"> Hz. Please choose a supported rate from the list.&quot;</span>
            <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_bit_depth</span><span class="p">(</span><span class="n">bit_depth</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate bit depth is supported.</span>

<span class="sd">        Args:</span>
<span class="sd">            bit_depth: Bit depth in bits</span>

<span class="sd">        Raises:</span>
<span class="sd">            GeneratorConfigurationError: If bit depth is not supported</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">bit_depth</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SUPPORTED_BIT_DEPTHS</span><span class="p">:</span>
            <span class="n">supported_depths</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">SUPPORTED_BIT_DEPTHS</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">raise</span> <span class="n">GeneratorConfigurationError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unsupported bit depth: </span><span class="si">{</span><span class="n">bit_depth</span><span class="si">}</span><span class="s2">. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Supported bit depths are: </span><span class="si">{</span><span class="n">supported_depths</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="c1"># TODO: uncomment when ConfigAudio is implemented</span>
    <span class="c1"># @staticmethod</span>
    <span class="c1"># def create_synthetic_audio(config: ConfigAudio) -&gt; str:</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_synthetic_audio</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate audio data with specified parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            config: ConfigAudio object containing audio generation parameters</span>

<span class="sd">        Returns:</span>
<span class="sd">            Data URI containing base64-encoded audio data with format specification</span>

<span class="sd">        Raises:</span>
<span class="sd">            GeneratorConfigurationError: If any of the following conditions are met:</span>
<span class="sd">                - audio_length_mean is less than 0.1 seconds</span>
<span class="sd">                - channels is not 1 (mono) or 2 (stereo)</span>
<span class="sd">                - sampling rate is not supported for MP3 format</span>
<span class="sd">                - bit depth is not supported (must be 8, 16, 24, or 32)</span>
<span class="sd">                - audio format is not supported (must be &#39;wav&#39; or &#39;mp3&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">num_channels</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">GeneratorConfigurationError</span><span class="p">(</span>
                <span class="s2">&quot;Only mono (1) and stereo (2) channels are supported&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Sample audio length (in seconds) using rejection sampling</span>
        <span class="n">audio_length</span> <span class="o">=</span> <span class="n">AudioGenerator</span><span class="o">.</span><span class="n">_sample_positive_normal</span><span class="p">(</span>
            <span class="n">config</span><span class="o">.</span><span class="n">length</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">length</span><span class="o">.</span><span class="n">stddev</span>
        <span class="p">)</span>

        <span class="c1"># Randomly select sampling rate and bit depth</span>
        <span class="n">sampling_rate</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">sample_rates</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span>
        <span class="p">)</span>  <span class="c1"># Convert kHz to Hz</span>
        <span class="n">bit_depth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">depths</span><span class="p">)</span>

        <span class="c1"># Validate sampling rate and bit depth</span>
        <span class="n">AudioGenerator</span><span class="o">.</span><span class="n">_validate_sampling_rate</span><span class="p">(</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
        <span class="n">AudioGenerator</span><span class="o">.</span><span class="n">_validate_bit_depth</span><span class="p">(</span><span class="n">bit_depth</span><span class="p">)</span>

        <span class="c1"># Generate synthetic audio data (gaussian noise)</span>
        <span class="n">num_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">audio_length</span> <span class="o">*</span> <span class="n">sampling_rate</span><span class="p">)</span>
        <span class="n">audio_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="mf">0.3</span><span class="p">,</span>
            <span class="p">(</span>
                <span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">num_channels</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">num_channels</span> <span class="o">&gt;</span> <span class="mi">1</span>
                <span class="k">else</span> <span class="n">num_samples</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Ensure the signal is within [-1, 1] range</span>
        <span class="n">audio_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">audio_data</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Scale to the appropriate bit depth range</span>
        <span class="n">max_val</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">bit_depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">numpy_type</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">SUPPORTED_BIT_DEPTHS</span><span class="p">[</span><span class="n">bit_depth</span><span class="p">]</span>
        <span class="n">audio_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">audio_data</span> <span class="o">*</span> <span class="n">max_val</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy_type</span><span class="p">)</span>

        <span class="c1"># Write audio using soundfile</span>
        <span class="n">output_buffer</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>

        <span class="c1"># Select appropriate subtype based on format</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">AudioFormat</span><span class="o">.</span><span class="n">MP3</span><span class="p">:</span>
            <span class="n">subtype</span> <span class="o">=</span> <span class="s2">&quot;MPEG_LAYER_III&quot;</span>
        <span class="k">elif</span> <span class="n">config</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">AudioFormat</span><span class="o">.</span><span class="n">WAV</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">subtype</span> <span class="o">=</span> <span class="n">SUPPORTED_BIT_DEPTHS</span><span class="p">[</span><span class="n">bit_depth</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GeneratorConfigurationError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unsupported audio format: </span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Supported formats are: </span><span class="si">{</span><span class="n">AudioFormat</span><span class="o">.</span><span class="n">WAV</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">AudioFormat</span><span class="o">.</span><span class="n">MP3</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">sf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
            <span class="n">output_buffer</span><span class="p">,</span>
            <span class="n">audio_data</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="p">,</span>
            <span class="nb">format</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">subtype</span><span class="o">=</span><span class="n">subtype</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">audio_bytes</span> <span class="o">=</span> <span class="n">output_buffer</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>

        <span class="c1"># Encode to base64 with data URI scheme: &quot;{format},{data}&quot;</span>
        <span class="n">base64_data</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">audio_bytes</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">base64_data</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.services.dataset.generator.audio.AudioGenerator.create_synthetic_audio" class="doc doc-heading">
            <code class=" language-python"><span class="n">create_synthetic_audio</span><span class="p">(</span><span class="n">config</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#aiperf.services.dataset.generator.audio.AudioGenerator.create_synthetic_audio" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Generate audio data with specified parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ConfigAudio object containing audio generation parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data URI containing base64-encoded audio data with format specification</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="GeneratorConfigurationError (aiperf.common.exceptions.GeneratorConfigurationError)" href="#aiperf.common.exceptions.GeneratorConfigurationError">GeneratorConfigurationError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any of the following conditions are met:
- audio_length_mean is less than 0.1 seconds
- channels is not 1 (mono) or 2 (stereo)
- sampling rate is not supported for MP3 format
- bit depth is not supported (must be 8, 16, 24, or 32)
- audio format is not supported (must be 'wav' or 'mp3')</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/dataset/generator/audio.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_synthetic_audio</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate audio data with specified parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        config: ConfigAudio object containing audio generation parameters</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data URI containing base64-encoded audio data with format specification</span>

<span class="sd">    Raises:</span>
<span class="sd">        GeneratorConfigurationError: If any of the following conditions are met:</span>
<span class="sd">            - audio_length_mean is less than 0.1 seconds</span>
<span class="sd">            - channels is not 1 (mono) or 2 (stereo)</span>
<span class="sd">            - sampling rate is not supported for MP3 format</span>
<span class="sd">            - bit depth is not supported (must be 8, 16, 24, or 32)</span>
<span class="sd">            - audio format is not supported (must be &#39;wav&#39; or &#39;mp3&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">num_channels</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">GeneratorConfigurationError</span><span class="p">(</span>
            <span class="s2">&quot;Only mono (1) and stereo (2) channels are supported&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Sample audio length (in seconds) using rejection sampling</span>
    <span class="n">audio_length</span> <span class="o">=</span> <span class="n">AudioGenerator</span><span class="o">.</span><span class="n">_sample_positive_normal</span><span class="p">(</span>
        <span class="n">config</span><span class="o">.</span><span class="n">length</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">length</span><span class="o">.</span><span class="n">stddev</span>
    <span class="p">)</span>

    <span class="c1"># Randomly select sampling rate and bit depth</span>
    <span class="n">sampling_rate</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">sample_rates</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="p">)</span>  <span class="c1"># Convert kHz to Hz</span>
    <span class="n">bit_depth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">depths</span><span class="p">)</span>

    <span class="c1"># Validate sampling rate and bit depth</span>
    <span class="n">AudioGenerator</span><span class="o">.</span><span class="n">_validate_sampling_rate</span><span class="p">(</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
    <span class="n">AudioGenerator</span><span class="o">.</span><span class="n">_validate_bit_depth</span><span class="p">(</span><span class="n">bit_depth</span><span class="p">)</span>

    <span class="c1"># Generate synthetic audio data (gaussian noise)</span>
    <span class="n">num_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">audio_length</span> <span class="o">*</span> <span class="n">sampling_rate</span><span class="p">)</span>
    <span class="n">audio_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span>
        <span class="mi">0</span><span class="p">,</span>
        <span class="mf">0.3</span><span class="p">,</span>
        <span class="p">(</span>
            <span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">num_channels</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">num_channels</span> <span class="o">&gt;</span> <span class="mi">1</span>
            <span class="k">else</span> <span class="n">num_samples</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># Ensure the signal is within [-1, 1] range</span>
    <span class="n">audio_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">audio_data</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Scale to the appropriate bit depth range</span>
    <span class="n">max_val</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">bit_depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">numpy_type</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">SUPPORTED_BIT_DEPTHS</span><span class="p">[</span><span class="n">bit_depth</span><span class="p">]</span>
    <span class="n">audio_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">audio_data</span> <span class="o">*</span> <span class="n">max_val</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy_type</span><span class="p">)</span>

    <span class="c1"># Write audio using soundfile</span>
    <span class="n">output_buffer</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>

    <span class="c1"># Select appropriate subtype based on format</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">AudioFormat</span><span class="o">.</span><span class="n">MP3</span><span class="p">:</span>
        <span class="n">subtype</span> <span class="o">=</span> <span class="s2">&quot;MPEG_LAYER_III&quot;</span>
    <span class="k">elif</span> <span class="n">config</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">AudioFormat</span><span class="o">.</span><span class="n">WAV</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">subtype</span> <span class="o">=</span> <span class="n">SUPPORTED_BIT_DEPTHS</span><span class="p">[</span><span class="n">bit_depth</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">GeneratorConfigurationError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Unsupported audio format: </span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Supported formats are: </span><span class="si">{</span><span class="n">AudioFormat</span><span class="o">.</span><span class="n">WAV</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">AudioFormat</span><span class="o">.</span><span class="n">MP3</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="n">sf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="n">output_buffer</span><span class="p">,</span>
        <span class="n">audio_data</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">subtype</span><span class="o">=</span><span class="n">subtype</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">audio_bytes</span> <span class="o">=</span> <span class="n">output_buffer</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>

    <span class="c1"># Encode to base64 with data URI scheme: &quot;{format},{data}&quot;</span>
    <span class="n">base64_data</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">audio_bytes</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">base64_data</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfservicesdatasetgeneratorimage">aiperf.services.dataset.generator.image<a class="headerlink" href="#aiperfservicesdatasetgeneratorimage" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.services.dataset.generator.image"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.services.dataset.generator.image.ImageGenerator" class="doc doc-heading">
            <code>ImageGenerator</code>


<a href="#aiperf.services.dataset.generator.image.ImageGenerator" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>A class that generates images from source images.</p>
<p>This class provides methods to create synthetic images by resizing
source images (located in the 'assets/source_images' directory)
to specified dimensions and converting them to a chosen image format (e.g., PNG, JPEG).
The dimensions can be randomized based on mean and standard deviation values.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/services/dataset/generator/image.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ImageGenerator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class that generates images from source images.</span>

<span class="sd">    This class provides methods to create synthetic images by resizing</span>
<span class="sd">    source images (located in the &#39;assets/source_images&#39; directory)</span>
<span class="sd">    to specified dimensions and converting them to a chosen image format (e.g., PNG, JPEG).</span>
<span class="sd">    The dimensions can be randomized based on mean and standard deviation values.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_synthetic_image</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">image_width_mean</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">image_width_stddev</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">image_height_mean</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">image_height_stddev</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">image_format</span><span class="p">:</span> <span class="n">ImageFormat</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate an image with the provided parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            image_width_mean: The mean width of the image.</span>
<span class="sd">            image_width_stddev: The standard deviation of the image width.</span>
<span class="sd">            image_height_mean: The mean height of the image.</span>
<span class="sd">            image_height_stddev: The standard deviation of the image height.</span>
<span class="sd">            image_format: The format of the image.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A base64 encoded string of the generated image.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">image_format</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">image_format</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ImageFormat</span><span class="p">))</span>
        <span class="n">width</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_sample_random_positive_integer</span><span class="p">(</span>
            <span class="n">image_width_mean</span><span class="p">,</span> <span class="n">image_width_stddev</span>
        <span class="p">)</span>
        <span class="n">height</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_sample_random_positive_integer</span><span class="p">(</span>
            <span class="n">image_height_mean</span><span class="p">,</span> <span class="n">image_height_stddev</span>
        <span class="p">)</span>

        <span class="n">image</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_sample_source_image</span><span class="p">()</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
        <span class="n">base64_image</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">encode_image</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">image_format</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;data:image/</span><span class="si">{</span><span class="n">image_format</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">;base64,</span><span class="si">{</span><span class="n">base64_image</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_sample_source_image</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sample one image among the source images.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A PIL Image object randomly selected from the source images.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;assets&quot;</span> <span class="o">/</span> <span class="s2">&quot;source_images&quot;</span> <span class="o">/</span> <span class="s2">&quot;*&quot;</span>
        <span class="n">filenames</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filepath</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No source images found in &#39;</span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">filenames</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_sample_random_positive_integer</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">stddev</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sample a random positive integer from a Gaussian distribution.</span>

<span class="sd">        Args:</span>
<span class="sd">            mean: The mean of the Gaussian distribution.</span>
<span class="sd">            stddev: The standard deviation of the Gaussian distribution.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A positive integer sampled from the distribution. If the sampled</span>
<span class="sd">            number is zero, it returns 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">stddev</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">n</span> <span class="k">if</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span>  <span class="c1"># avoid zero</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.services.dataset.generator.image.ImageGenerator.create_synthetic_image" class="doc doc-heading">
            <code class=" language-python"><span class="n">create_synthetic_image</span><span class="p">(</span><span class="n">image_width_mean</span><span class="p">,</span> <span class="n">image_width_stddev</span><span class="p">,</span> <span class="n">image_height_mean</span><span class="p">,</span> <span class="n">image_height_stddev</span><span class="p">,</span> <span class="n">image_format</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#aiperf.services.dataset.generator.image.ImageGenerator.create_synthetic_image" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Generate an image with the provided parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>image_width_mean</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The mean width of the image.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>image_width_stddev</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The standard deviation of the image width.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>image_height_mean</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The mean height of the image.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>image_height_stddev</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The standard deviation of the image height.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>image_format</code>
            </td>
            <td>
                  <code><span title="aiperf.common.enums.ImageFormat">ImageFormat</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The format of the image.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A base64 encoded string of the generated image.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/dataset/generator/image.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_synthetic_image</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">image_width_mean</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">image_width_stddev</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">image_height_mean</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">image_height_stddev</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">image_format</span><span class="p">:</span> <span class="n">ImageFormat</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate an image with the provided parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        image_width_mean: The mean width of the image.</span>
<span class="sd">        image_width_stddev: The standard deviation of the image width.</span>
<span class="sd">        image_height_mean: The mean height of the image.</span>
<span class="sd">        image_height_stddev: The standard deviation of the image height.</span>
<span class="sd">        image_format: The format of the image.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A base64 encoded string of the generated image.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">image_format</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">image_format</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ImageFormat</span><span class="p">))</span>
    <span class="n">width</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_sample_random_positive_integer</span><span class="p">(</span>
        <span class="n">image_width_mean</span><span class="p">,</span> <span class="n">image_width_stddev</span>
    <span class="p">)</span>
    <span class="n">height</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_sample_random_positive_integer</span><span class="p">(</span>
        <span class="n">image_height_mean</span><span class="p">,</span> <span class="n">image_height_stddev</span>
    <span class="p">)</span>

    <span class="n">image</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_sample_source_image</span><span class="p">()</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
    <span class="n">base64_image</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">encode_image</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">image_format</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;data:image/</span><span class="si">{</span><span class="n">image_format</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">;base64,</span><span class="si">{</span><span class="n">base64_image</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfservicesdatasetgeneratorprompt">aiperf.services.dataset.generator.prompt<a class="headerlink" href="#aiperfservicesdatasetgeneratorprompt" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.services.dataset.generator.prompt"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.services.dataset.generator.prompt.PromptGenerator" class="doc doc-heading">
            <code>PromptGenerator</code>


<a href="#aiperf.services.dataset.generator.prompt.PromptGenerator" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>A class for generating synthetic prompts from a text corpus.</p>
<p>This class loads a text corpus (e.g., Shakespearean text), tokenizes it,
and uses the tokenized corpus to generate synthetic prompts of specified
lengths. It supports generating prompts with a target number of tokens
(with optional randomization around a mean and standard deviation) and
can reuse previously generated token blocks to optimize generation for
certain use cases. It also allows for the creation of a pool of prefix
prompts that can be randomly selected.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/services/dataset/generator/prompt.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PromptGenerator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class for generating synthetic prompts from a text corpus.</span>

<span class="sd">    This class loads a text corpus (e.g., Shakespearean text), tokenizes it,</span>
<span class="sd">    and uses the tokenized corpus to generate synthetic prompts of specified</span>
<span class="sd">    lengths. It supports generating prompts with a target number of tokens</span>
<span class="sd">    (with optional randomization around a mean and standard deviation) and</span>
<span class="sd">    can reuse previously generated token blocks to optimize generation for</span>
<span class="sd">    certain use cases. It also allows for the creation of a pool of prefix</span>
<span class="sd">    prompts that can be randomly selected.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_tokenized_corpus</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_corpus_length</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">_prefix_prompts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">_cache</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_synthetic_prompt</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">tokenizer</span><span class="p">:</span> <span class="n">Tokenizer</span><span class="p">,</span>
        <span class="n">prompt_tokens_mean</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">550</span><span class="p">,</span>
        <span class="n">prompt_tokens_stddev</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
        <span class="n">hash_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">block_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">512</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a synthetic prompt with a specific number of tokens.</span>

<span class="sd">        Args:</span>
<span class="sd">            tokenizer: Tokenizer instance.</span>
<span class="sd">            prompt_tokens_mean: Mean number of tokens in the prompt.</span>
<span class="sd">            prompt_tokens_stddev: Standard deviation for the number of tokens in the prompt.</span>
<span class="sd">            hash_ids: Optional list of integers for token reuse.</span>
<span class="sd">            block_size: Size of the token block for reuse.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A synthetic prompt as a string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_tokenized_corpus</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_initialize_corpus</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hash_ids</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_generate_prompt_with_token_reuse</span><span class="p">(</span>
                <span class="n">tokenizer</span><span class="p">,</span> <span class="n">prompt_tokens_mean</span><span class="p">,</span> <span class="n">hash_ids</span><span class="p">,</span> <span class="n">block_size</span>
            <span class="p">)</span>

        <span class="n">num_prompt_tokens</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="n">prompt_tokens_mean</span><span class="p">,</span> <span class="n">prompt_tokens_stddev</span><span class="p">))</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_generate_prompt</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">,</span> <span class="n">num_prompt_tokens</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_corpus</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">:</span> <span class="n">Tokenizer</span><span class="p">,</span> <span class="n">corpus_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">DEFAULT_CORPUS_FILE</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load and tokenize the corpus once, storing it for reuse.</span>

<span class="sd">        Args:</span>
<span class="sd">            tokenizer: Tokenizer for tokenizing the corpus.</span>
<span class="sd">            corpus_file: Path to the corpus file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">corpus_path</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="n">corpus_file</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">corpus_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">tokenize_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">):</span>
            <span class="n">cleaned_text</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">chunk</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">cleaned_text</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">tokens</span>

        <span class="n">num_threads</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">num_threads</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">num_threads</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">chunk_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">//</span> <span class="n">num_threads</span>
        <span class="n">chunks</span> <span class="o">=</span> <span class="p">[</span><span class="n">lines</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">chunk_size</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">),</span> <span class="n">chunk_size</span><span class="p">)]</span>

        <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">num_threads</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
            <span class="n">tokenized_chunks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">executor</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">tokenize_chunk</span><span class="p">,</span> <span class="n">chunks</span><span class="p">))</span>

        <span class="bp">cls</span><span class="o">.</span><span class="n">_tokenized_corpus</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">tokenized_chunks</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">chunk</span><span class="p">]</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_corpus_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_tokenized_corpus</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_prompt_tokens</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">num_tokens</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a prompt containing exactly `num_tokens` using the preloaded tokenized corpus.</span>

<span class="sd">        Args:</span>
<span class="sd">            num_tokens: Number of tokens required in the prompt.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A synthetic prompt of tokens.</span>

<span class="sd">        Raises:</span>
<span class="sd">            GeneratorInitializationError: If the tokenized corpus is not initialized</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_tokenized_corpus</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GeneratorInitializationError</span><span class="p">(</span><span class="s2">&quot;Tokenized corpus is not initialized.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">num_tokens</span> <span class="o">&gt;</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_corpus_length</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Requested prompt length </span><span class="si">{</span><span class="n">num_tokens</span><span class="si">}</span><span class="s2"> is longer than the corpus. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Returning a prompt of length </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="n">_corpus_length</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

        <span class="n">start_idx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_corpus_length</span><span class="p">)</span>

        <span class="n">end_idx</span> <span class="o">=</span> <span class="n">start_idx</span> <span class="o">+</span> <span class="n">num_tokens</span>
        <span class="n">prompt_tokens</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_tokenized_corpus</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">end_idx</span> <span class="o">&gt;</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_corpus_length</span><span class="p">:</span>
            <span class="n">prompt_tokens</span> <span class="o">+=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_tokenized_corpus</span><span class="p">[:</span> <span class="n">end_idx</span> <span class="o">-</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_corpus_length</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">prompt_tokens</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_prompt</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">:</span> <span class="n">Tokenizer</span><span class="p">,</span> <span class="n">num_tokens</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a prompt containing exactly `num_tokens` using the preloaded tokenized corpus.</span>

<span class="sd">        Args:</span>
<span class="sd">            tokenizer: Tokenizer instance.</span>
<span class="sd">            num_tokens: Number of tokens required in the prompt.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A synthetic prompt as a string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_generate_prompt_tokens</span><span class="p">(</span><span class="n">num_tokens</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_prompt_with_token_reuse</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">tokenizer</span><span class="p">:</span> <span class="n">Tokenizer</span><span class="p">,</span>
        <span class="n">num_tokens</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">prompt_hash_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
        <span class="n">block_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a prompt containing exactly `num_tokens` by reusing previously generated prompts</span>
<span class="sd">        stored in `_cache`. Each hash index in `prompt_hash_list` corresponds to a block of</span>
<span class="sd">        `block_size` tokens. If a hash index is found in `_cache`, its stored prompt is reused.</span>
<span class="sd">        Otherwise, a new prompt is generated using `_generate_prompt()` and stored in `_cache`.</span>

<span class="sd">        Args:</span>
<span class="sd">            tokenizer : Tokenizer</span>
<span class="sd">                The tokenizer used to generate prompts.</span>
<span class="sd">            num_tokens : int</span>
<span class="sd">                The number of tokens required in the prompt.</span>
<span class="sd">            prompt_hash_list : list[int]</span>
<span class="sd">                A list of hash indices used for token reuse.</span>
<span class="sd">            block_size : int</span>
<span class="sd">                The number of tokens allocated per hash block (default 512).</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: A synthetic prompt as a string.</span>

<span class="sd">        Raises:</span>
<span class="sd">            GeneratorConfigurationError: If the input parameters are not compatible.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">final_prompt</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">size_to_use</span> <span class="o">=</span> <span class="n">block_size</span>
        <span class="n">last_hash_length</span> <span class="o">=</span> <span class="n">num_tokens</span> <span class="o">-</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">prompt_hash_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">block_size</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">last_hash_length</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">block_size</span> <span class="o">&lt;</span> <span class="n">last_hash_length</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GeneratorConfigurationError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Input_length: </span><span class="si">{</span><span class="n">num_tokens</span><span class="si">}</span><span class="s2">, Hash_ids: </span><span class="si">{</span><span class="n">prompt_hash_list</span><span class="si">}</span><span class="s2">, Block_size: </span><span class="si">{</span><span class="n">block_size</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;are not compatible. The final hash id length: </span><span class="si">{</span><span class="n">last_hash_length</span><span class="si">}</span><span class="s2"> must be greater &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;than 0 and less than or equal to </span><span class="si">{</span><span class="n">block_size</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">hash_index</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">prompt_hash_list</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">prompt_hash_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">size_to_use</span> <span class="o">=</span> <span class="n">num_tokens</span> <span class="o">-</span> <span class="p">(</span><span class="n">index</span> <span class="o">*</span> <span class="n">block_size</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">hash_index</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_cache</span><span class="p">:</span>
                <span class="c1"># To ensure that the prompt doesn&#39;t merge chunks, we pop the last token</span>
                <span class="c1"># and insert the bos token at the beginning. Length is maintained and</span>
                <span class="c1"># the prompt generates the expected number of tokens.</span>
                <span class="n">prompt_tokens</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_generate_prompt_tokens</span><span class="p">(</span><span class="n">size_to_use</span><span class="p">)</span>
                <span class="n">prompt_tokens</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">prompt_tokens</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">bos_token_id</span><span class="p">())</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">hash_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">prompt_tokens</span>
            <span class="n">final_prompt</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">hash_index</span><span class="p">])</span>
        <span class="n">prompt</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">final_prompt</span><span class="p">,</span> <span class="n">skip_special_tokens</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">prompt</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_prefix_prompts_pool</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">:</span> <span class="n">Tokenizer</span><span class="p">,</span> <span class="n">num_prompts</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">prompt_length</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a pool of prefix prompts.</span>

<span class="sd">        Args:</span>
<span class="sd">            tokenizer: Tokenizer instance.</span>
<span class="sd">            num_prompts: Number of prefix prompts to generate.</span>
<span class="sd">            prompt_length: Number of tokens per prefix prompt.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_tokenized_corpus</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_initialize_corpus</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">)</span>

        <span class="bp">cls</span><span class="o">.</span><span class="n">_prefix_prompts</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_generate_prompt</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">,</span> <span class="n">prompt_length</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_prompts</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_random_prefix_prompt</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fetch a random prefix prompt from the pool.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A random prefix prompt.</span>

<span class="sd">        Raises:</span>
<span class="sd">            GeneratorInitializationError: If the prefix prompts pool is empty.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_prefix_prompts</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GeneratorInitializationError</span><span class="p">(</span>
                <span class="s2">&quot;Prefix prompts pool is empty. Call `create_prefix_prompts_pool` first.&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_prefix_prompts</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.services.dataset.generator.prompt.PromptGenerator.create_prefix_prompts_pool" class="doc doc-heading">
            <code class=" language-python"><span class="n">create_prefix_prompts_pool</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">,</span> <span class="n">num_prompts</span><span class="p">,</span> <span class="n">prompt_length</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#aiperf.services.dataset.generator.prompt.PromptGenerator.create_prefix_prompts_pool" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Generate a pool of prefix prompts.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tokenizer</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Tokenizer (aiperf.common.tokenizer.Tokenizer)" href="#aiperf.common.tokenizer.Tokenizer">Tokenizer</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tokenizer instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_prompts</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of prefix prompts to generate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prompt_length</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of tokens per prefix prompt.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/dataset/generator/prompt.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_prefix_prompts_pool</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">:</span> <span class="n">Tokenizer</span><span class="p">,</span> <span class="n">num_prompts</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">prompt_length</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a pool of prefix prompts.</span>

<span class="sd">    Args:</span>
<span class="sd">        tokenizer: Tokenizer instance.</span>
<span class="sd">        num_prompts: Number of prefix prompts to generate.</span>
<span class="sd">        prompt_length: Number of tokens per prefix prompt.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_tokenized_corpus</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_initialize_corpus</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">)</span>

    <span class="bp">cls</span><span class="o">.</span><span class="n">_prefix_prompts</span> <span class="o">=</span> <span class="p">[</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_generate_prompt</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">,</span> <span class="n">prompt_length</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_prompts</span><span class="p">)</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.services.dataset.generator.prompt.PromptGenerator.create_synthetic_prompt" class="doc doc-heading">
            <code class=" language-python"><span class="n">create_synthetic_prompt</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">,</span> <span class="n">prompt_tokens_mean</span><span class="o">=</span><span class="mi">550</span><span class="p">,</span> <span class="n">prompt_tokens_stddev</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">hash_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">block_size</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#aiperf.services.dataset.generator.prompt.PromptGenerator.create_synthetic_prompt" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Generate a synthetic prompt with a specific number of tokens.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tokenizer</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Tokenizer (aiperf.common.tokenizer.Tokenizer)" href="#aiperf.common.tokenizer.Tokenizer">Tokenizer</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tokenizer instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prompt_tokens_mean</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mean number of tokens in the prompt.</p>
              </div>
            </td>
            <td>
                  <code>550</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prompt_tokens_stddev</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Standard deviation for the number of tokens in the prompt.</p>
              </div>
            </td>
            <td>
                  <code>250</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hash_ids</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional list of integers for token reuse.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>block_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of the token block for reuse.</p>
              </div>
            </td>
            <td>
                  <code>512</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A synthetic prompt as a string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/dataset/generator/prompt.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_synthetic_prompt</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">tokenizer</span><span class="p">:</span> <span class="n">Tokenizer</span><span class="p">,</span>
    <span class="n">prompt_tokens_mean</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">550</span><span class="p">,</span>
    <span class="n">prompt_tokens_stddev</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
    <span class="n">hash_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">block_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">512</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a synthetic prompt with a specific number of tokens.</span>

<span class="sd">    Args:</span>
<span class="sd">        tokenizer: Tokenizer instance.</span>
<span class="sd">        prompt_tokens_mean: Mean number of tokens in the prompt.</span>
<span class="sd">        prompt_tokens_stddev: Standard deviation for the number of tokens in the prompt.</span>
<span class="sd">        hash_ids: Optional list of integers for token reuse.</span>
<span class="sd">        block_size: Size of the token block for reuse.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A synthetic prompt as a string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_tokenized_corpus</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_initialize_corpus</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">hash_ids</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_generate_prompt_with_token_reuse</span><span class="p">(</span>
            <span class="n">tokenizer</span><span class="p">,</span> <span class="n">prompt_tokens_mean</span><span class="p">,</span> <span class="n">hash_ids</span><span class="p">,</span> <span class="n">block_size</span>
        <span class="p">)</span>

    <span class="n">num_prompt_tokens</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
        <span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="n">prompt_tokens_mean</span><span class="p">,</span> <span class="n">prompt_tokens_stddev</span><span class="p">))</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_generate_prompt</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">,</span> <span class="n">num_prompt_tokens</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.services.dataset.generator.prompt.PromptGenerator.get_random_prefix_prompt" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_random_prefix_prompt</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#aiperf.services.dataset.generator.prompt.PromptGenerator.get_random_prefix_prompt" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Fetch a random prefix prompt from the pool.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A random prefix prompt.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="GeneratorInitializationError (aiperf.common.exceptions.GeneratorInitializationError)" href="#aiperf.common.exceptions.GeneratorInitializationError">GeneratorInitializationError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the prefix prompts pool is empty.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/dataset/generator/prompt.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_random_prefix_prompt</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch a random prefix prompt from the pool.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A random prefix prompt.</span>

<span class="sd">    Raises:</span>
<span class="sd">        GeneratorInitializationError: If the prefix prompts pool is empty.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_prefix_prompts</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">GeneratorInitializationError</span><span class="p">(</span>
            <span class="s2">&quot;Prefix prompts pool is empty. Call `create_prefix_prompts_pool` first.&quot;</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_prefix_prompts</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfservicesdatasetgeneratorutils">aiperf.services.dataset.generator.utils<a class="headerlink" href="#aiperfservicesdatasetgeneratorutils" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.services.dataset.generator.utils"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="aiperf.services.dataset.generator.utils.encode_image" class="doc doc-heading">
            <code class=" language-python"><span class="n">encode_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="nb">format</span><span class="p">)</span></code>

<a href="#aiperf.services.dataset.generator.utils.encode_image" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Encodes an image into base64 encoded string.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>img</code>
            </td>
            <td>
                  <code><span title="PIL.Image">Image</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PIL Image object to encode.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>format</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The image format to use (e.g., "JPEG", "PNG").</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A base64 encoded string representation of the image.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/dataset/generator/utils.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">encode_image</span><span class="p">(</span><span class="n">img</span><span class="p">:</span> <span class="n">Image</span><span class="p">,</span> <span class="nb">format</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Encodes an image into base64 encoded string.</span>

<span class="sd">    Args:</span>
<span class="sd">        img: The PIL Image object to encode.</span>
<span class="sd">        format: The image format to use (e.g., &quot;JPEG&quot;, &quot;PNG&quot;).</span>

<span class="sd">    Returns:</span>
<span class="sd">        A base64 encoded string representation of the image.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># JPEG does not support P or RGBA mode (commonly used for PNG) so it needs</span>
    <span class="c1"># to be converted to RGB before an image can be saved as JPEG format.</span>
    <span class="k">if</span> <span class="nb">format</span> <span class="o">==</span> <span class="s2">&quot;JPEG&quot;</span> <span class="ow">and</span> <span class="n">img</span><span class="o">.</span><span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;RGB&quot;</span><span class="p">:</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span>

    <span class="n">buffer</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
    <span class="n">img</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">buffer</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="aiperfservicespost_processor_managerpost_processor_manager">aiperf.services.post_processor_manager.post_processor_manager<a class="headerlink" href="#aiperfservicespost_processor_managerpost_processor_manager" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.services.post_processor_manager.post_processor_manager"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.services.post_processor_manager.post_processor_manager.PostProcessorManager" class="doc doc-heading">
            <code>PostProcessorManager</code>


<a href="#aiperf.services.post_processor_manager.post_processor_manager.PostProcessorManager" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseComponentService (aiperf.common.service.base_component_service.BaseComponentService)" href="#aiperf.common.service.base_component_service.BaseComponentService">BaseComponentService</a></code></p>


        <p>PostProcessorManager is primarily responsible for iterating over the
records to generate metrics and other conclusions from the records.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/services/post_processor_manager/post_processor_manager.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PostProcessorManager</span><span class="p">(</span><span class="n">BaseComponentService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;PostProcessorManager is primarily responsible for iterating over the</span>
<span class="sd">    records to generate metrics and other conclusions from the records.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">service_config</span><span class="p">:</span> <span class="n">ServiceConfig</span><span class="p">,</span> <span class="n">service_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">service_config</span><span class="o">=</span><span class="n">service_config</span><span class="p">,</span> <span class="n">service_id</span><span class="o">=</span><span class="n">service_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Initializing post processor manager&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">service_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ServiceType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The type of service.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ServiceType</span><span class="o">.</span><span class="n">POST_PROCESSOR_MANAGER</span>

    <span class="nd">@on_init</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize post processor manager-specific components.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Initializing post processor manager&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Implement post processor manager initialization</span>

    <span class="nd">@on_start</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start the post processor manager.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Starting post processor manager&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Implement post processor manager start</span>

    <span class="nd">@on_stop</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop the post processor manager.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Stopping post processor manager&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Implement post processor manager stop</span>

    <span class="nd">@on_cleanup</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clean up post processor manager-specific components.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Cleaning up post processor manager&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Implement post processor manager cleanup</span>

    <span class="nd">@on_configure</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payload</span><span class="p">:</span> <span class="n">BasePayload</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Configure the post processor manager.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Configuring post processor manager with payload: </span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="aiperf.services.post_processor_manager.post_processor_manager.PostProcessorManager.service_type" class="doc doc-heading">
            <code class=" language-python"><span class="n">service_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.services.post_processor_manager.post_processor_manager.PostProcessorManager.service_type" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The type of service.</p>

    </div>

</div>





  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="aiperf.services.post_processor_manager.post_processor_manager.main" class="doc doc-heading">
            <code class=" language-python"><span class="n">main</span><span class="p">()</span></code>

<a href="#aiperf.services.post_processor_manager.post_processor_manager.main" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Main entry point for the post processor manager.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/post_processor_manager/post_processor_manager.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Main entry point for the post processor manager.&quot;&quot;&quot;</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">aiperf.common.bootstrap</span><span class="w"> </span><span class="kn">import</span> <span class="n">bootstrap_and_run_service</span>

    <span class="n">bootstrap_and_run_service</span><span class="p">(</span><span class="n">PostProcessorManager</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="aiperfservicesrecords_managerrecords_manager">aiperf.services.records_manager.records_manager<a class="headerlink" href="#aiperfservicesrecords_managerrecords_manager" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.services.records_manager.records_manager"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.services.records_manager.records_manager.RecordsManager" class="doc doc-heading">
            <code>RecordsManager</code>


<a href="#aiperf.services.records_manager.records_manager.RecordsManager" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseComponentService (aiperf.common.service.base_component_service.BaseComponentService)" href="#aiperf.common.service.base_component_service.BaseComponentService">BaseComponentService</a></code></p>


        <p>The RecordsManager service is primarily responsible for holding the
results returned from the workers.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/services/records_manager/records_manager.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RecordsManager</span><span class="p">(</span><span class="n">BaseComponentService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The RecordsManager service is primarily responsible for holding the</span>
<span class="sd">    results returned from the workers.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">service_config</span><span class="p">:</span> <span class="n">ServiceConfig</span><span class="p">,</span> <span class="n">service_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">service_config</span><span class="o">=</span><span class="n">service_config</span><span class="p">,</span> <span class="n">service_id</span><span class="o">=</span><span class="n">service_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Initializing records manager&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">service_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ServiceType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The type of service.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ServiceType</span><span class="o">.</span><span class="n">RECORDS_MANAGER</span>

    <span class="nd">@on_init</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize records manager-specific components.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Initializing records manager&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Implement records manager initialization</span>

    <span class="nd">@on_start</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start the records manager.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Starting records manager&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Implement records manager start</span>

    <span class="nd">@on_stop</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop the records manager.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Stopping records manager&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Implement records manager stop</span>

    <span class="nd">@on_cleanup</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clean up records manager-specific components.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Cleaning up records manager&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Implement records manager cleanup</span>

    <span class="nd">@on_configure</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payload</span><span class="p">:</span> <span class="n">BasePayload</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Configure the records manager.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Configuring records manager with payload: </span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="aiperf.services.records_manager.records_manager.RecordsManager.service_type" class="doc doc-heading">
            <code class=" language-python"><span class="n">service_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.services.records_manager.records_manager.RecordsManager.service_type" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The type of service.</p>

    </div>

</div>





  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="aiperf.services.records_manager.records_manager.main" class="doc doc-heading">
            <code class=" language-python"><span class="n">main</span><span class="p">()</span></code>

<a href="#aiperf.services.records_manager.records_manager.main" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Main entry point for the records manager.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/records_manager/records_manager.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Main entry point for the records manager.&quot;&quot;&quot;</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">aiperf.common.bootstrap</span><span class="w"> </span><span class="kn">import</span> <span class="n">bootstrap_and_run_service</span>

    <span class="n">bootstrap_and_run_service</span><span class="p">(</span><span class="n">RecordsManager</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="aiperfservicesservice_managerbase">aiperf.services.service_manager.base<a class="headerlink" href="#aiperfservicesservice_managerbase" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.services.service_manager.base"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.services.service_manager.base.BaseServiceManager" class="doc doc-heading">
            <code>BaseServiceManager</code>


<a href="#aiperf.services.service_manager.base.BaseServiceManager" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>


        <p>Base class for service managers. It provides a common interface for
managing services and a way to look up service information by service ID.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/services/service_manager/base.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BaseServiceManager</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for service managers. It provides a common interface for</span>
<span class="sd">    managing services and a way to look up service information by service ID.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">required_service_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ServiceType</span><span class="p">],</span> <span class="n">config</span><span class="p">:</span> <span class="n">ServiceConfig</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">required_service_types</span> <span class="o">=</span> <span class="n">required_service_types</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>

        <span class="c1"># Maps to track service information</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">service_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">ServiceType</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ServiceRunInfo</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Create service ID map for component lookups</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">service_id_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ServiceRunInfo</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">initialize_all_services</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize all required services.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">stop_all_services</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop all managed services.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">wait_for_all_services_registration</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">stop_event</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait for all required services to be registered.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">wait_for_all_services_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait for all required services to be started.&quot;&quot;&quot;</span>
        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.services.service_manager.base.BaseServiceManager.initialize_all_services" class="doc doc-heading">
            <code class=" language-python"><span class="n">initialize_all_services</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.services.service_manager.base.BaseServiceManager.initialize_all_services" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize all required services.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/service_manager/base.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">initialize_all_services</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize all required services.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.services.service_manager.base.BaseServiceManager.stop_all_services" class="doc doc-heading">
            <code class=" language-python"><span class="n">stop_all_services</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.services.service_manager.base.BaseServiceManager.stop_all_services" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Stop all managed services.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/service_manager/base.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">stop_all_services</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stop all managed services.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.services.service_manager.base.BaseServiceManager.wait_for_all_services_registration" class="doc doc-heading">
            <code class=" language-python"><span class="n">wait_for_all_services_registration</span><span class="p">(</span><span class="n">stop_event</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.services.service_manager.base.BaseServiceManager.wait_for_all_services_registration" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Wait for all required services to be registered.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/service_manager/base.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">wait_for_all_services_registration</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">stop_event</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wait for all required services to be registered.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.services.service_manager.base.BaseServiceManager.wait_for_all_services_start" class="doc doc-heading">
            <code class=" language-python"><span class="n">wait_for_all_services_start</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.services.service_manager.base.BaseServiceManager.wait_for_all_services_start" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Wait for all required services to be started.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/service_manager/base.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">wait_for_all_services_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wait for all required services to be started.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfservicesservice_managerkubernetes">aiperf.services.service_manager.kubernetes<a class="headerlink" href="#aiperfservicesservice_managerkubernetes" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.services.service_manager.kubernetes"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.services.service_manager.kubernetes.KubernetesServiceManager" class="doc doc-heading">
            <code>KubernetesServiceManager</code>


<a href="#aiperf.services.service_manager.kubernetes.KubernetesServiceManager" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseServiceManager (aiperf.services.service_manager.base.BaseServiceManager)" href="#aiperf.services.service_manager.base.BaseServiceManager">BaseServiceManager</a></code></p>


        <p>Service Manager for starting and stopping services in a Kubernetes cluster.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/services/service_manager/kubernetes.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">KubernetesServiceManager</span><span class="p">(</span><span class="n">BaseServiceManager</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Service Manager for starting and stopping services in a Kubernetes cluster.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">required_service_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ServiceType</span><span class="p">],</span> <span class="n">config</span><span class="p">:</span> <span class="n">ServiceConfig</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">required_service_types</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">initialize_all_services</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize all required services as Kubernetes pods.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Initializing all required services as Kubernetes pods&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Implement Kubernetes</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;KubernetesServiceManager.initialize_all_services not implemented&quot;</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">stop_all_services</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop all required services as Kubernetes pods.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Stopping all required services as Kubernetes pods&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Implement Kubernetes</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;KubernetesServiceManager.stop_all_services not implemented&quot;</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">wait_for_all_services_registration</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">stop_event</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait for all required services to be registered in Kubernetes.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;Waiting for all required services to be registered in Kubernetes&quot;</span>
        <span class="p">)</span>
        <span class="c1"># TODO: Implement Kubernetes</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;KubernetesServiceManager.wait_for_all_services_registration not implemented&quot;</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">wait_for_all_services_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait for all required services to be started in Kubernetes.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;Waiting for all required services to be started in Kubernetes&quot;</span>
        <span class="p">)</span>
        <span class="c1"># TODO: Implement Kubernetes</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;KubernetesServiceManager.wait_for_all_services_start not implemented&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.services.service_manager.kubernetes.KubernetesServiceManager.initialize_all_services" class="doc doc-heading">
            <code class=" language-python"><span class="n">initialize_all_services</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.services.service_manager.kubernetes.KubernetesServiceManager.initialize_all_services" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize all required services as Kubernetes pods.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/service_manager/kubernetes.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">initialize_all_services</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize all required services as Kubernetes pods.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Initializing all required services as Kubernetes pods&quot;</span><span class="p">)</span>
    <span class="c1"># TODO: Implement Kubernetes</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
        <span class="s2">&quot;KubernetesServiceManager.initialize_all_services not implemented&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.services.service_manager.kubernetes.KubernetesServiceManager.stop_all_services" class="doc doc-heading">
            <code class=" language-python"><span class="n">stop_all_services</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.services.service_manager.kubernetes.KubernetesServiceManager.stop_all_services" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Stop all required services as Kubernetes pods.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/service_manager/kubernetes.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">stop_all_services</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stop all required services as Kubernetes pods.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Stopping all required services as Kubernetes pods&quot;</span><span class="p">)</span>
    <span class="c1"># TODO: Implement Kubernetes</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
        <span class="s2">&quot;KubernetesServiceManager.stop_all_services not implemented&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.services.service_manager.kubernetes.KubernetesServiceManager.wait_for_all_services_registration" class="doc doc-heading">
            <code class=" language-python"><span class="n">wait_for_all_services_registration</span><span class="p">(</span><span class="n">stop_event</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.services.service_manager.kubernetes.KubernetesServiceManager.wait_for_all_services_registration" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Wait for all required services to be registered in Kubernetes.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/service_manager/kubernetes.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">wait_for_all_services_registration</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">stop_event</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wait for all required services to be registered in Kubernetes.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="s2">&quot;Waiting for all required services to be registered in Kubernetes&quot;</span>
    <span class="p">)</span>
    <span class="c1"># TODO: Implement Kubernetes</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
        <span class="s2">&quot;KubernetesServiceManager.wait_for_all_services_registration not implemented&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.services.service_manager.kubernetes.KubernetesServiceManager.wait_for_all_services_start" class="doc doc-heading">
            <code class=" language-python"><span class="n">wait_for_all_services_start</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.services.service_manager.kubernetes.KubernetesServiceManager.wait_for_all_services_start" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Wait for all required services to be started in Kubernetes.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/service_manager/kubernetes.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">wait_for_all_services_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wait for all required services to be started in Kubernetes.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="s2">&quot;Waiting for all required services to be started in Kubernetes&quot;</span>
    <span class="p">)</span>
    <span class="c1"># TODO: Implement Kubernetes</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
        <span class="s2">&quot;KubernetesServiceManager.wait_for_all_services_start not implemented&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.services.service_manager.kubernetes.ServiceKubernetesRunInfo" class="doc doc-heading">
            <code>ServiceKubernetesRunInfo</code>


<a href="#aiperf.services.service_manager.kubernetes.ServiceKubernetesRunInfo" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Information about a service running in a Kubernetes pod.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/services/service_manager/kubernetes.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ServiceKubernetesRunInfo</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Information about a service running in a Kubernetes pod.&quot;&quot;&quot;</span>

    <span class="n">pod_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfservicesservice_managermultiprocess">aiperf.services.service_manager.multiprocess<a class="headerlink" href="#aiperfservicesservice_managermultiprocess" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.services.service_manager.multiprocess"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.services.service_manager.multiprocess.MultiProcessRunInfo" class="doc doc-heading">
            <code>MultiProcessRunInfo</code>


<a href="#aiperf.services.service_manager.multiprocess.MultiProcessRunInfo" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Information about a service running as a multiprocessing process.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/services/service_manager/multiprocess.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MultiProcessRunInfo</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Information about a service running as a multiprocessing process.&quot;&quot;&quot;</span>

    <span class="n">model_config</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">process</span><span class="p">:</span> <span class="n">Process</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">service_type</span><span class="p">:</span> <span class="n">ServiceType</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Type of service running in the process&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.services.service_manager.multiprocess.MultiProcessServiceManager" class="doc doc-heading">
            <code>MultiProcessServiceManager</code>


<a href="#aiperf.services.service_manager.multiprocess.MultiProcessServiceManager" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseServiceManager (aiperf.services.service_manager.base.BaseServiceManager)" href="#aiperf.services.service_manager.base.BaseServiceManager">BaseServiceManager</a></code></p>


        <p>Service Manager for starting and stopping services as multiprocessing processes.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/services/service_manager/multiprocess.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MultiProcessServiceManager</span><span class="p">(</span><span class="n">BaseServiceManager</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Service Manager for starting and stopping services as multiprocessing processes.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">required_service_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ServiceType</span><span class="p">],</span> <span class="n">config</span><span class="p">:</span> <span class="n">ServiceConfig</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">required_service_types</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multi_process_info</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MultiProcessRunInfo</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">initialize_all_services</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start all required services as multiprocessing processes.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Starting all required services as multiprocessing processes&quot;</span><span class="p">)</span>

        <span class="c1"># TODO: This is a hack to get the service classes</span>
        <span class="c1"># TODO: We should find a better way to do this</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">aiperf.services.dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatasetManager</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">aiperf.services.post_processor_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">PostProcessorManager</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">aiperf.services.records_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">RecordsManager</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">aiperf.services.timing_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimingManager</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">aiperf.services.worker_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">WorkerManager</span>

        <span class="n">service_class_map</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">ServiceType</span><span class="o">.</span><span class="n">DATASET_MANAGER</span><span class="p">:</span> <span class="n">DatasetManager</span><span class="p">,</span>
            <span class="n">ServiceType</span><span class="o">.</span><span class="n">TIMING_MANAGER</span><span class="p">:</span> <span class="n">TimingManager</span><span class="p">,</span>
            <span class="n">ServiceType</span><span class="o">.</span><span class="n">WORKER_MANAGER</span><span class="p">:</span> <span class="n">WorkerManager</span><span class="p">,</span>
            <span class="n">ServiceType</span><span class="o">.</span><span class="n">RECORDS_MANAGER</span><span class="p">:</span> <span class="n">RecordsManager</span><span class="p">,</span>
            <span class="n">ServiceType</span><span class="o">.</span><span class="n">POST_PROCESSOR_MANAGER</span><span class="p">:</span> <span class="n">PostProcessorManager</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="c1"># Create and start all service processes</span>
        <span class="k">for</span> <span class="n">service_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">required_service_types</span><span class="p">:</span>
            <span class="n">service_class</span> <span class="o">=</span> <span class="n">service_class_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">service_type</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">service_class</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No service class found for </span><span class="si">{</span><span class="n">service_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="n">process</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span>
                <span class="n">target</span><span class="o">=</span><span class="n">bootstrap_and_run_service</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">service_type</span><span class="si">}</span><span class="s2">_process&quot;</span><span class="p">,</span>
                <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">service_class</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">),</span>
                <span class="n">daemon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">process</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;Service </span><span class="si">%s</span><span class="s2"> started as process (pid: </span><span class="si">%d</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="n">service_type</span><span class="p">,</span>
                <span class="n">process</span><span class="o">.</span><span class="n">pid</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">multi_process_info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">MultiProcessRunInfo</span><span class="p">(</span><span class="n">process</span><span class="o">=</span><span class="n">process</span><span class="p">,</span> <span class="n">service_type</span><span class="o">=</span><span class="n">service_type</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="c1"># Sleep to allow the service to register</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">stop_all_services</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop all required services as multiprocessing processes.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Stopping all service processes&quot;</span><span class="p">)</span>

        <span class="c1"># Wait for all to finish in parallel</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
            <span class="o">*</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_process</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="k">for</span> <span class="n">info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_process_info</span><span class="p">]</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">wait_for_all_services_registration</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">stop_event</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait for all required services to be registered.</span>

<span class="sd">        Args:</span>
<span class="sd">            stop_event: Event to check if operation should be cancelled</span>
<span class="sd">            timeout_seconds: Maximum time to wait in seconds</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception if any service failed to register, None otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Waiting for all required services to register...&quot;</span><span class="p">)</span>

        <span class="c1"># Get the set of required service types for checking completion</span>
        <span class="n">required_types</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">required_service_types</span><span class="p">)</span>

        <span class="c1"># TODO: Can this be done better by using asyncio.Event()?</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">async</span> <span class="k">with</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">timeout_seconds</span><span class="p">):</span>
                <span class="k">while</span> <span class="ow">not</span> <span class="n">stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
                    <span class="c1"># Get all registered service types from the id map</span>
                    <span class="n">registered_types</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="n">service_info</span><span class="o">.</span><span class="n">service_type</span>
                        <span class="k">for</span> <span class="n">service_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_id_map</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                        <span class="k">if</span> <span class="n">service_info</span><span class="o">.</span><span class="n">registration_status</span>
                        <span class="o">==</span> <span class="n">ServiceRegistrationStatus</span><span class="o">.</span><span class="n">REGISTERED</span>
                    <span class="p">}</span>

                    <span class="c1"># Check if all required types are registered</span>
                    <span class="k">if</span> <span class="n">required_types</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">registered_types</span><span class="p">):</span>
                        <span class="k">return</span>

                    <span class="c1"># Wait a bit before checking again</span>
                    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span><span class="p">:</span>
            <span class="c1"># Log which services didn&#39;t register in time</span>
            <span class="n">registered_types</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">service_info</span><span class="o">.</span><span class="n">service_type</span>
                <span class="k">for</span> <span class="n">service_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_id_map</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">service_info</span><span class="o">.</span><span class="n">registration_status</span>
                <span class="o">==</span> <span class="n">ServiceRegistrationStatus</span><span class="o">.</span><span class="n">REGISTERED</span>
            <span class="p">}</span>

            <span class="k">for</span> <span class="n">service_type</span> <span class="ow">in</span> <span class="n">required_types</span> <span class="o">-</span> <span class="n">registered_types</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Service </span><span class="si">{</span><span class="n">service_type</span><span class="si">}</span><span class="s2"> failed to register within timeout&quot;</span>
                <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">wait_for_all_services_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait for all required services to be started.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Waiting for all required services to start...&quot;</span><span class="p">)</span>

        <span class="c1"># TODO: Implement this</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;wait_for_all_services_start not implemented&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_wait_for_process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">:</span> <span class="n">MultiProcessRunInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait for a process to terminate with timeout handling.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">process</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">info</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">info</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span>
                <span class="n">asyncio</span><span class="o">.</span><span class="n">to_thread</span><span class="p">(</span>
                    <span class="n">info</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">join</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.0</span>
                <span class="p">),</span>  <span class="c1"># Add timeout to join</span>
                <span class="n">timeout</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>  <span class="c1"># Overall timeout</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;Service </span><span class="si">%s</span><span class="s2"> process stopped (pid: </span><span class="si">%d</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="n">info</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                <span class="n">info</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">pid</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Service </span><span class="si">%s</span><span class="s2"> process (pid: </span><span class="si">%d</span><span class="s2">) did not terminate gracefully, killing&quot;</span><span class="p">,</span>
                <span class="n">info</span><span class="o">.</span><span class="n">service_type</span><span class="p">,</span>
                <span class="n">info</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">pid</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">info</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.services.service_manager.multiprocess.MultiProcessServiceManager.initialize_all_services" class="doc doc-heading">
            <code class=" language-python"><span class="n">initialize_all_services</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.services.service_manager.multiprocess.MultiProcessServiceManager.initialize_all_services" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Start all required services as multiprocessing processes.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/service_manager/multiprocess.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">initialize_all_services</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Start all required services as multiprocessing processes.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Starting all required services as multiprocessing processes&quot;</span><span class="p">)</span>

    <span class="c1"># TODO: This is a hack to get the service classes</span>
    <span class="c1"># TODO: We should find a better way to do this</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">aiperf.services.dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatasetManager</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">aiperf.services.post_processor_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">PostProcessorManager</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">aiperf.services.records_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">RecordsManager</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">aiperf.services.timing_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimingManager</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">aiperf.services.worker_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">WorkerManager</span>

    <span class="n">service_class_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">ServiceType</span><span class="o">.</span><span class="n">DATASET_MANAGER</span><span class="p">:</span> <span class="n">DatasetManager</span><span class="p">,</span>
        <span class="n">ServiceType</span><span class="o">.</span><span class="n">TIMING_MANAGER</span><span class="p">:</span> <span class="n">TimingManager</span><span class="p">,</span>
        <span class="n">ServiceType</span><span class="o">.</span><span class="n">WORKER_MANAGER</span><span class="p">:</span> <span class="n">WorkerManager</span><span class="p">,</span>
        <span class="n">ServiceType</span><span class="o">.</span><span class="n">RECORDS_MANAGER</span><span class="p">:</span> <span class="n">RecordsManager</span><span class="p">,</span>
        <span class="n">ServiceType</span><span class="o">.</span><span class="n">POST_PROCESSOR_MANAGER</span><span class="p">:</span> <span class="n">PostProcessorManager</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># Create and start all service processes</span>
    <span class="k">for</span> <span class="n">service_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">required_service_types</span><span class="p">:</span>
        <span class="n">service_class</span> <span class="o">=</span> <span class="n">service_class_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">service_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">service_class</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No service class found for </span><span class="si">{</span><span class="n">service_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">process</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span>
            <span class="n">target</span><span class="o">=</span><span class="n">bootstrap_and_run_service</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">service_type</span><span class="si">}</span><span class="s2">_process&quot;</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">service_class</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">),</span>
            <span class="n">daemon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">process</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;Service </span><span class="si">%s</span><span class="s2"> started as process (pid: </span><span class="si">%d</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="n">service_type</span><span class="p">,</span>
            <span class="n">process</span><span class="o">.</span><span class="n">pid</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">multi_process_info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">MultiProcessRunInfo</span><span class="p">(</span><span class="n">process</span><span class="o">=</span><span class="n">process</span><span class="p">,</span> <span class="n">service_type</span><span class="o">=</span><span class="n">service_type</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Sleep to allow the service to register</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.services.service_manager.multiprocess.MultiProcessServiceManager.stop_all_services" class="doc doc-heading">
            <code class=" language-python"><span class="n">stop_all_services</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.services.service_manager.multiprocess.MultiProcessServiceManager.stop_all_services" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Stop all required services as multiprocessing processes.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/service_manager/multiprocess.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">stop_all_services</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stop all required services as multiprocessing processes.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Stopping all service processes&quot;</span><span class="p">)</span>

    <span class="c1"># Wait for all to finish in parallel</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
        <span class="o">*</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_process</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="k">for</span> <span class="n">info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_process_info</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.services.service_manager.multiprocess.MultiProcessServiceManager.wait_for_all_services_registration" class="doc doc-heading">
            <code class=" language-python"><span class="n">wait_for_all_services_registration</span><span class="p">(</span><span class="n">stop_event</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.services.service_manager.multiprocess.MultiProcessServiceManager.wait_for_all_services_registration" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Wait for all required services to be registered.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>stop_event</code>
            </td>
            <td>
                  <code><span title="asyncio.Event">Event</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Event to check if operation should be cancelled</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timeout_seconds</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum time to wait in seconds</p>
              </div>
            </td>
            <td>
                  <code>30</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/service_manager/multiprocess.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">wait_for_all_services_registration</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">stop_event</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wait for all required services to be registered.</span>

<span class="sd">    Args:</span>
<span class="sd">        stop_event: Event to check if operation should be cancelled</span>
<span class="sd">        timeout_seconds: Maximum time to wait in seconds</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception if any service failed to register, None otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Waiting for all required services to register...&quot;</span><span class="p">)</span>

    <span class="c1"># Get the set of required service types for checking completion</span>
    <span class="n">required_types</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">required_service_types</span><span class="p">)</span>

    <span class="c1"># TODO: Can this be done better by using asyncio.Event()?</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">timeout_seconds</span><span class="p">):</span>
            <span class="k">while</span> <span class="ow">not</span> <span class="n">stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
                <span class="c1"># Get all registered service types from the id map</span>
                <span class="n">registered_types</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">service_info</span><span class="o">.</span><span class="n">service_type</span>
                    <span class="k">for</span> <span class="n">service_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_id_map</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">service_info</span><span class="o">.</span><span class="n">registration_status</span>
                    <span class="o">==</span> <span class="n">ServiceRegistrationStatus</span><span class="o">.</span><span class="n">REGISTERED</span>
                <span class="p">}</span>

                <span class="c1"># Check if all required types are registered</span>
                <span class="k">if</span> <span class="n">required_types</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">registered_types</span><span class="p">):</span>
                    <span class="k">return</span>

                <span class="c1"># Wait a bit before checking again</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span><span class="p">:</span>
        <span class="c1"># Log which services didn&#39;t register in time</span>
        <span class="n">registered_types</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">service_info</span><span class="o">.</span><span class="n">service_type</span>
            <span class="k">for</span> <span class="n">service_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_id_map</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">service_info</span><span class="o">.</span><span class="n">registration_status</span>
            <span class="o">==</span> <span class="n">ServiceRegistrationStatus</span><span class="o">.</span><span class="n">REGISTERED</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">service_type</span> <span class="ow">in</span> <span class="n">required_types</span> <span class="o">-</span> <span class="n">registered_types</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Service </span><span class="si">{</span><span class="n">service_type</span><span class="si">}</span><span class="s2"> failed to register within timeout&quot;</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.services.service_manager.multiprocess.MultiProcessServiceManager.wait_for_all_services_start" class="doc doc-heading">
            <code class=" language-python"><span class="n">wait_for_all_services_start</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.services.service_manager.multiprocess.MultiProcessServiceManager.wait_for_all_services_start" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Wait for all required services to be started.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/service_manager/multiprocess.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">wait_for_all_services_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wait for all required services to be started.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Waiting for all required services to start...&quot;</span><span class="p">)</span>

    <span class="c1"># TODO: Implement this</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;wait_for_all_services_start not implemented&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfservicessystem_controllersystem_controller">aiperf.services.system_controller.system_controller<a class="headerlink" href="#aiperfservicessystem_controllersystem_controller" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.services.system_controller.system_controller"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.services.system_controller.system_controller.SystemController" class="doc doc-heading">
            <code>SystemController</code>


<a href="#aiperf.services.system_controller.system_controller.SystemController" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseControllerService (aiperf.common.service.base_controller_service.BaseControllerService)" href="#aiperf.common.service.base_controller_service.BaseControllerService">BaseControllerService</a></code></p>








              <details class="quote">
                <summary>Source code in <code>aiperf/services/system_controller/system_controller.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SystemController</span><span class="p">(</span><span class="n">BaseControllerService</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">service_config</span><span class="p">:</span> <span class="n">ServiceConfig</span><span class="p">,</span> <span class="n">service_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">service_config</span><span class="o">=</span><span class="n">service_config</span><span class="p">,</span> <span class="n">service_id</span><span class="o">=</span><span class="n">service_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Creating System Controller&quot;</span><span class="p">)</span>

        <span class="c1"># List of required service types, in no particular order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">required_service_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ServiceType</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">ServiceType</span><span class="o">.</span><span class="n">DATASET_MANAGER</span><span class="p">,</span>
            <span class="n">ServiceType</span><span class="o">.</span><span class="n">TIMING_MANAGER</span><span class="p">,</span>
            <span class="n">ServiceType</span><span class="o">.</span><span class="n">WORKER_MANAGER</span><span class="p">,</span>
            <span class="n">ServiceType</span><span class="o">.</span><span class="n">RECORDS_MANAGER</span><span class="p">,</span>
            <span class="n">ServiceType</span><span class="o">.</span><span class="n">POST_PROCESSOR_MANAGER</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">service_manager</span><span class="p">:</span> <span class="n">BaseServiceManager</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;System Controller created&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">service_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ServiceType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The type of service.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ServiceType</span><span class="o">.</span><span class="n">SYSTEM_CONTROLLER</span>

    <span class="nd">@on_init</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize system controller-specific components.</span>

<span class="sd">        This method will:</span>
<span class="sd">        - Initialize the service manager</span>
<span class="sd">        - Subscribe to relevant messages</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Initializing System Controller&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">service_run_type</span> <span class="o">==</span> <span class="n">ServiceRunType</span><span class="o">.</span><span class="n">MULTIPROCESSING</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_manager</span> <span class="o">=</span> <span class="n">MultiProcessServiceManager</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">required_service_types</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_config</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">service_run_type</span> <span class="o">==</span> <span class="n">ServiceRunType</span><span class="o">.</span><span class="n">KUBERNETES</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_manager</span> <span class="o">=</span> <span class="n">KubernetesServiceManager</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">required_service_types</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_config</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ConfigError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unsupported service run type: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">service_run_type</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Subscribe to relevant messages</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">comms</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span>
                <span class="n">topic</span><span class="o">=</span><span class="n">Topic</span><span class="o">.</span><span class="n">REGISTRATION</span><span class="p">,</span>
                <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_process_registration_message</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to subscribe to registration topic: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationSubscribeError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">comms</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span>
                <span class="n">topic</span><span class="o">=</span><span class="n">Topic</span><span class="o">.</span><span class="n">HEARTBEAT</span><span class="p">,</span>
                <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_process_heartbeat_message</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to subscribe to heartbeat topic: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationSubscribeError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">comms</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span>
                <span class="n">topic</span><span class="o">=</span><span class="n">Topic</span><span class="o">.</span><span class="n">STATUS</span><span class="p">,</span>
                <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_process_status_message</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to subscribe to status topic: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationSubscribeError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;System controller waiting for 1 second to ensure that the &quot;</span>
            <span class="s2">&quot;communication is initialized&quot;</span>
        <span class="p">)</span>

        <span class="c1"># wait 1 second to ensure that the communication is initialized</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="nd">@on_start</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start the system controller and launch required services.</span>

<span class="sd">        This method will:</span>
<span class="sd">        - Initialize all required services</span>
<span class="sd">        - Wait for all required services to be registered</span>
<span class="sd">        - Start all required services</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Starting System Controller&quot;</span><span class="p">)</span>

        <span class="c1"># Start all required services</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_manager</span><span class="o">.</span><span class="n">initialize_all_services</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to initialize all services: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">ServiceInitializationError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Wait for all required services to be registered</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_manager</span><span class="o">.</span><span class="n">wait_for_all_services_registration</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="s2">&quot;System Controller stopped before all services registered&quot;</span>
                <span class="p">)</span>
                <span class="k">return</span>  <span class="c1"># Don&#39;t continue with the rest of the initialization</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s2">&quot;Not all required services registered within the timeout period&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">ServiceInitializationError</span><span class="p">(</span>
                <span class="s2">&quot;Not all required services registered within the timeout period&quot;</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;All required services registered successfully&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;AIPerf System is READY&quot;</span><span class="p">)</span>
        <span class="c1"># Wait for all required services to be started</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_all_services</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_manager</span><span class="o">.</span><span class="n">wait_for_all_services_start</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to wait for all services to start: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">ServiceInitializationError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;System Controller stopped before all services started&quot;</span><span class="p">)</span>
            <span class="k">return</span>  <span class="c1"># Don&#39;t continue with the rest of the initialization</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;All required services started successfully&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;AIPerf System is RUNNING&quot;</span><span class="p">)</span>

    <span class="nd">@on_stop</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop the system controller and all running services.</span>

<span class="sd">        This method will:</span>
<span class="sd">        - Stop all running services</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Stopping System Controller&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;AIPerf System is SHUTTING DOWN&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_manager</span><span class="o">.</span><span class="n">stop_all_services</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to stop all services: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">ServiceStopError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="nd">@on_cleanup</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clean up system controller-specific components.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Cleaning up System Controller&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Additional cleanup if needed</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">start_all_services</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start all required services.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Starting services&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">service_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_manager</span><span class="o">.</span><span class="n">service_id_map</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">service_info</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">READY</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_command_to_service</span><span class="p">(</span>
                        <span class="n">target_service_id</span><span class="o">=</span><span class="n">service_info</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
                        <span class="n">command</span><span class="o">=</span><span class="n">CommandType</span><span class="o">.</span><span class="n">START</span><span class="p">,</span>
                    <span class="p">)</span>

                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Failed to start service: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                    <span class="c1"># Continue to the next service</span>
                    <span class="c1"># TODO: should we have some sort of retries?</span>
                    <span class="k">continue</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_process_registration_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">RegistrationMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process a registration response from a service. It will</span>
<span class="sd">        add the service to the service manager and send a configure command</span>
<span class="sd">        to the service.</span>

<span class="sd">        Args:</span>
<span class="sd">            message: The registration response to process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service_id</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">service_id</span>
        <span class="n">service_type</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">service_type</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Processing registration from </span><span class="si">{</span><span class="n">service_type</span><span class="si">}</span><span class="s2"> with ID: </span><span class="si">{</span><span class="n">service_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="n">service_info</span> <span class="o">=</span> <span class="n">ServiceRunInfo</span><span class="p">(</span>
            <span class="n">registration_status</span><span class="o">=</span><span class="n">ServiceRegistrationStatus</span><span class="o">.</span><span class="n">REGISTERED</span><span class="p">,</span>
            <span class="n">service_type</span><span class="o">=</span><span class="n">service_type</span><span class="p">,</span>
            <span class="n">service_id</span><span class="o">=</span><span class="n">service_id</span><span class="p">,</span>
            <span class="n">first_seen</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">(),</span>
            <span class="n">state</span><span class="o">=</span><span class="n">ServiceState</span><span class="o">.</span><span class="n">READY</span><span class="p">,</span>
            <span class="n">last_seen</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">(),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">service_manager</span><span class="o">.</span><span class="n">service_id_map</span><span class="p">[</span><span class="n">service_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">service_info</span>
        <span class="k">if</span> <span class="n">service_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_manager</span><span class="o">.</span><span class="n">service_map</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service_manager</span><span class="o">.</span><span class="n">service_map</span><span class="p">[</span><span class="n">service_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">service_manager</span><span class="o">.</span><span class="n">service_map</span><span class="p">[</span><span class="n">service_type</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">service_info</span><span class="p">)</span>

        <span class="n">is_required</span> <span class="o">=</span> <span class="n">service_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">required_service_types</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Registered </span><span class="si">{</span><span class="s1">&#39;required&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_required</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;non-required&#39;</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;service: </span><span class="si">{</span><span class="n">service_type</span><span class="si">}</span><span class="s2"> with ID: </span><span class="si">{</span><span class="n">service_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Send configure command to the newly registered service</span>
        <span class="c1"># TODO: Retrieve the configuration to send to the service</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_command_to_service</span><span class="p">(</span>
                <span class="n">target_service_id</span><span class="o">=</span><span class="n">service_id</span><span class="p">,</span>
                <span class="n">command</span><span class="o">=</span><span class="n">CommandType</span><span class="o">.</span><span class="n">CONFIGURE</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Failed to send configure command to </span><span class="si">{</span><span class="n">service_type</span><span class="si">}</span><span class="s2"> (ID: </span><span class="si">{</span><span class="n">service_id</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">ServiceConfigureError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Sent configure command to </span><span class="si">{</span><span class="n">service_type</span><span class="si">}</span><span class="s2"> (ID: </span><span class="si">{</span><span class="n">service_id</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_process_heartbeat_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">HeartbeatMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process a heartbeat response from a service. It will</span>
<span class="sd">        update the last seen timestamp and state of the service.</span>

<span class="sd">        Args:</span>
<span class="sd">            message: The heartbeat response to process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service_id</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">service_id</span>
        <span class="n">service_type</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">service_type</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">timestamp</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Received heartbeat from </span><span class="si">{</span><span class="n">service_type</span><span class="si">}</span><span class="s2"> (ID: </span><span class="si">{</span><span class="n">service_id</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="c1"># Update the last heartbeat timestamp if the component exists</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">service_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_manager</span><span class="o">.</span><span class="n">service_id_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">service_id</span><span class="p">)</span>
            <span class="n">service_info</span><span class="o">.</span><span class="n">last_seen</span> <span class="o">=</span> <span class="n">timestamp</span>
            <span class="n">service_info</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">state</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updated heartbeat for </span><span class="si">{</span><span class="n">service_id</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Received heartbeat from unknown service: </span><span class="si">{</span><span class="n">service_id</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">service_type</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_process_status_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">StatusMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process a status response from a service. It will</span>
<span class="sd">        update the state of the service with the service manager.</span>

<span class="sd">        Args:</span>
<span class="sd">            message: The status response to process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service_id</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">service_id</span>
        <span class="n">service_type</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">service_type</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">state</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Received status update from </span><span class="si">{</span><span class="n">service_type</span><span class="si">}</span><span class="s2"> (ID: </span><span class="si">{</span><span class="n">service_id</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Update the component state if the component exists</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">service_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_manager</span><span class="o">.</span><span class="n">service_id_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">service_id</span><span class="p">)</span>
            <span class="n">service_info</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">state</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updated state for </span><span class="si">{</span><span class="n">service_id</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Received status update from un-registered service: </span><span class="si">{</span><span class="n">service_id</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">service_type</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">send_command_to_service</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target_service_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Send a command to a specific service.</span>

<span class="sd">        Args:</span>
<span class="sd">            target_service_id: ID of the target service</span>
<span class="sd">            command: The command to send (from CommandType enum).</span>
<span class="sd">            data: Optional data to send with the command.</span>

<span class="sd">        Raises:</span>
<span class="sd">            CommunicationNotInitializedError if the communication is not initialized</span>
<span class="sd">            CommunicationPublishError if the command was not sent successfully</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comms</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Cannot send command: Communication is not initialized&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationNotInitializedError</span><span class="p">()</span>

        <span class="c1"># Create command response using the helper method</span>
        <span class="n">command_message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_command_message</span><span class="p">(</span>
            <span class="n">command</span><span class="o">=</span><span class="n">command</span><span class="p">,</span>
            <span class="n">target_service_id</span><span class="o">=</span><span class="n">target_service_id</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Publish command response</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">comms</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span>
                <span class="n">topic</span><span class="o">=</span><span class="n">Topic</span><span class="o">.</span><span class="n">COMMAND</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="n">command_message</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Exception publishing command: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">CommunicationPublishError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="aiperf.services.system_controller.system_controller.SystemController.service_type" class="doc doc-heading">
            <code class=" language-python"><span class="n">service_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.services.system_controller.system_controller.SystemController.service_type" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The type of service.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="aiperf.services.system_controller.system_controller.SystemController.send_command_to_service" class="doc doc-heading">
            <code class=" language-python"><span class="n">send_command_to_service</span><span class="p">(</span><span class="n">target_service_id</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.services.system_controller.system_controller.SystemController.send_command_to_service" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Send a command to a specific service.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>target_service_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ID of the target service</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>command</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CommandType (aiperf.common.enums.CommandType)" href="#aiperf.common.enums.CommandType">CommandType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The command to send (from CommandType enum).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional data to send with the command.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/system_controller/system_controller.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">send_command_to_service</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">target_service_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">command</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Send a command to a specific service.</span>

<span class="sd">    Args:</span>
<span class="sd">        target_service_id: ID of the target service</span>
<span class="sd">        command: The command to send (from CommandType enum).</span>
<span class="sd">        data: Optional data to send with the command.</span>

<span class="sd">    Raises:</span>
<span class="sd">        CommunicationNotInitializedError if the communication is not initialized</span>
<span class="sd">        CommunicationPublishError if the command was not sent successfully</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_comms</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Cannot send command: Communication is not initialized&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">CommunicationNotInitializedError</span><span class="p">()</span>

    <span class="c1"># Create command response using the helper method</span>
    <span class="n">command_message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_command_message</span><span class="p">(</span>
        <span class="n">command</span><span class="o">=</span><span class="n">command</span><span class="p">,</span>
        <span class="n">target_service_id</span><span class="o">=</span><span class="n">target_service_id</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Publish command response</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">comms</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span>
            <span class="n">topic</span><span class="o">=</span><span class="n">Topic</span><span class="o">.</span><span class="n">COMMAND</span><span class="p">,</span>
            <span class="n">message</span><span class="o">=</span><span class="n">command_message</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Exception publishing command: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">CommunicationPublishError</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.services.system_controller.system_controller.SystemController.start_all_services" class="doc doc-heading">
            <code class=" language-python"><span class="n">start_all_services</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.services.system_controller.system_controller.SystemController.start_all_services" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Start all required services.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/system_controller/system_controller.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">start_all_services</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Start all required services.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Starting services&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">service_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_manager</span><span class="o">.</span><span class="n">service_id_map</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">service_info</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">READY</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_command_to_service</span><span class="p">(</span>
                    <span class="n">target_service_id</span><span class="o">=</span><span class="n">service_info</span><span class="o">.</span><span class="n">service_id</span><span class="p">,</span>
                    <span class="n">command</span><span class="o">=</span><span class="n">CommandType</span><span class="o">.</span><span class="n">START</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Failed to start service: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                <span class="c1"># Continue to the next service</span>
                <span class="c1"># TODO: should we have some sort of retries?</span>
                <span class="k">continue</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="aiperf.services.system_controller.system_controller.main" class="doc doc-heading">
            <code class=" language-python"><span class="n">main</span><span class="p">()</span></code>

<a href="#aiperf.services.system_controller.system_controller.main" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Main entry point for the system controller.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/system_controller/system_controller.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Main entry point for the system controller.&quot;&quot;&quot;</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">aiperf.common.bootstrap</span><span class="w"> </span><span class="kn">import</span> <span class="n">bootstrap_and_run_service</span>

    <span class="n">bootstrap_and_run_service</span><span class="p">(</span><span class="n">SystemController</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="aiperfservicestiming_managertiming_manager">aiperf.services.timing_manager.timing_manager<a class="headerlink" href="#aiperfservicestiming_managertiming_manager" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.services.timing_manager.timing_manager"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.services.timing_manager.timing_manager.TimingManager" class="doc doc-heading">
            <code>TimingManager</code>


<a href="#aiperf.services.timing_manager.timing_manager.TimingManager" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseComponentService (aiperf.common.service.base_component_service.BaseComponentService)" href="#aiperf.common.service.base_component_service.BaseComponentService">BaseComponentService</a></code></p>


        <p>The TimingManager service is responsible to generate the schedule and issuing
timing credits for requests.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/services/timing_manager/timing_manager.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">TimingManager</span><span class="p">(</span><span class="n">BaseComponentService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The TimingManager service is responsible to generate the schedule and issuing</span>
<span class="sd">    timing credits for requests.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">service_config</span><span class="p">:</span> <span class="n">ServiceConfig</span><span class="p">,</span> <span class="n">service_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">service_config</span><span class="o">=</span><span class="n">service_config</span><span class="p">,</span> <span class="n">service_id</span><span class="o">=</span><span class="n">service_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_credit_lock</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_credits_available</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Initializing timing manager&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_credit_drop_task</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">service_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ServiceType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The type of service.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ServiceType</span><span class="o">.</span><span class="n">TIMING_MANAGER</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">required_clients</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ClientType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The communication clients required by the service.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="o">*</span><span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">required_clients</span> <span class="ow">or</span> <span class="p">[]),</span>
            <span class="n">PullClientType</span><span class="o">.</span><span class="n">CREDIT_RETURN</span><span class="p">,</span>
            <span class="n">PushClientType</span><span class="o">.</span><span class="n">CREDIT_DROP</span><span class="p">,</span>
        <span class="p">]</span>

    <span class="nd">@on_init</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize timing manager-specific components.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Initializing timing manager&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Implement timing manager initialization</span>

    <span class="nd">@on_start</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start the timing manager.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Starting timing manager&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Implement timing manager start</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">comms</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span>
            <span class="n">topic</span><span class="o">=</span><span class="n">Topic</span><span class="o">.</span><span class="n">CREDIT_RETURN</span><span class="p">,</span>
            <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_credit_return</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">ServiceState</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_credit_drop_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_issue_credit_drops</span><span class="p">())</span>

    <span class="nd">@on_stop</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop the timing manager.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Stopping timing manager&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Implement timing manager stop</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_credit_drop_task</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_credit_drop_task</span><span class="o">.</span><span class="n">done</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_credit_drop_task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
            <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">suppress</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">):</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_credit_drop_task</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_credit_drop_task</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@on_cleanup</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clean up timing manager-specific components.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Cleaning up timing manager&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Implement timing manager cleanup</span>

    <span class="nd">@on_configure</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payload</span><span class="p">:</span> <span class="n">BasePayload</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Configure the timing manager.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Configuring timing manager with payload: </span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Implement timing manager configuration</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_issue_credit_drops</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Issue credit drops to workers.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Issuing credit drops to workers&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Actually implement real credit drop logic</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

                <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_credit_lock</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_credits_available</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                            <span class="s2">&quot;No credits available, skipping credit drop&quot;</span>
                        <span class="p">)</span>
                        <span class="k">continue</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Issuing credit drop&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_credits_available</span> <span class="o">-=</span> <span class="mi">1</span>

                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">comms</span><span class="o">.</span><span class="n">push</span><span class="p">(</span>
                    <span class="n">topic</span><span class="o">=</span><span class="n">Topic</span><span class="o">.</span><span class="n">CREDIT_DROP</span><span class="p">,</span>
                    <span class="n">message</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span>
                        <span class="n">payload</span><span class="o">=</span><span class="n">CreditDropPayload</span><span class="p">(</span>
                            <span class="n">amount</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">timestamp</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">(),</span>
                        <span class="p">),</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Credit drop task cancelled&quot;</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exception issuing credit drop: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_on_credit_return</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process a credit return response.</span>

<span class="sd">        Args:</span>
<span class="sd">            message: The response received from the pull request</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing credit return: </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">payload</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_credit_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_credits_available</span> <span class="o">+=</span> <span class="n">message</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">amount</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="aiperf.services.timing_manager.timing_manager.TimingManager.required_clients" class="doc doc-heading">
            <code class=" language-python"><span class="n">required_clients</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.services.timing_manager.timing_manager.TimingManager.required_clients" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The communication clients required by the service.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.services.timing_manager.timing_manager.TimingManager.service_type" class="doc doc-heading">
            <code class=" language-python"><span class="n">service_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.services.timing_manager.timing_manager.TimingManager.service_type" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The type of service.</p>

    </div>

</div>





  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="aiperf.services.timing_manager.timing_manager.main" class="doc doc-heading">
            <code class=" language-python"><span class="n">main</span><span class="p">()</span></code>

<a href="#aiperf.services.timing_manager.timing_manager.main" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Main entry point for the timing manager.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/timing_manager/timing_manager.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Main entry point for the timing manager.&quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">aiperf.common.bootstrap</span><span class="w"> </span><span class="kn">import</span> <span class="n">bootstrap_and_run_service</span>

    <span class="n">bootstrap_and_run_service</span><span class="p">(</span><span class="n">TimingManager</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="aiperfservicesworkerworker">aiperf.services.worker.worker<a class="headerlink" href="#aiperfservicesworkerworker" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.services.worker.worker"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.services.worker.worker.Worker" class="doc doc-heading">
            <code>Worker</code>


<a href="#aiperf.services.worker.worker.Worker" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseService (aiperf.common.service.base_service.BaseService)" href="#aiperf.common.service.base_service.BaseService">BaseService</a></code></p>


        <p>Worker is primarily responsible for converting the data into the appropriate
format for the interface being used by the server. Also responsible for managing
the conversation between turns.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/services/worker/worker.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Worker</span><span class="p">(</span><span class="n">BaseService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Worker is primarily responsible for converting the data into the appropriate</span>
<span class="sd">    format for the interface being used by the server. Also responsible for managing</span>
<span class="sd">    the conversation between turns.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">service_config</span><span class="p">:</span> <span class="n">ServiceConfig</span><span class="p">,</span> <span class="n">service_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">service_config</span><span class="o">=</span><span class="n">service_config</span><span class="p">,</span> <span class="n">service_id</span><span class="o">=</span><span class="n">service_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Initializing worker&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">service_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ServiceType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The type of service.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ServiceType</span><span class="o">.</span><span class="n">WORKER</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">required_clients</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ClientType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The communication clients required by the service.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="o">*</span><span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">required_clients</span> <span class="ow">or</span> <span class="p">[]),</span>
            <span class="n">PullClientType</span><span class="o">.</span><span class="n">CREDIT_DROP</span><span class="p">,</span>
            <span class="n">PushClientType</span><span class="o">.</span><span class="n">CREDIT_RETURN</span><span class="p">,</span>
        <span class="p">]</span>

    <span class="nd">@on_init</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize worker-specific components.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Initializing worker&quot;</span><span class="p">)</span>

    <span class="nd">@on_run</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Automatically start the worker in the run method.&quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="nd">@on_start</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start the worker.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Starting worker&quot;</span><span class="p">)</span>
        <span class="c1"># Subscribe to the credit drop topic</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">comms</span><span class="o">.</span><span class="n">pull</span><span class="p">(</span>
            <span class="n">topic</span><span class="o">=</span><span class="n">Topic</span><span class="o">.</span><span class="n">CREDIT_DROP</span><span class="p">,</span>
            <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_process_credit_drop</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@on_stop</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop the worker.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Stopping worker&quot;</span><span class="p">)</span>

    <span class="nd">@on_cleanup</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clean up worker-specific components.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Cleaning up worker&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_process_credit_drop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">CreditDropMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process a credit drop response.</span>

<span class="sd">        Args:</span>
<span class="sd">            message: The message received from the credit drop</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing credit drop: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Implement actual worker logic</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Simulate some processing time</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Returning credits&quot;</span><span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">comms</span><span class="o">.</span><span class="n">push</span><span class="p">(</span>
            <span class="n">topic</span><span class="o">=</span><span class="n">Topic</span><span class="o">.</span><span class="n">CREDIT_RETURN</span><span class="p">,</span>
            <span class="n">message</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span>
                <span class="n">payload</span><span class="o">=</span><span class="n">CreditReturnPayload</span><span class="p">(</span><span class="n">amount</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
            <span class="p">),</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="aiperf.services.worker.worker.Worker.required_clients" class="doc doc-heading">
            <code class=" language-python"><span class="n">required_clients</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.services.worker.worker.Worker.required_clients" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The communication clients required by the service.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="aiperf.services.worker.worker.Worker.service_type" class="doc doc-heading">
            <code class=" language-python"><span class="n">service_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.services.worker.worker.Worker.service_type" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The type of service.</p>

    </div>

</div>





  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="aiperf.services.worker.worker.main" class="doc doc-heading">
            <code class=" language-python"><span class="n">main</span><span class="p">()</span></code>

<a href="#aiperf.services.worker.worker.main" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Main entry point for the worker.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/worker/worker.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Main entry point for the worker.&quot;&quot;&quot;</span>

    <span class="kn">import</span><span class="w"> </span><span class="nn">uvloop</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">aiperf.common.config.loader</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_service_config</span>

    <span class="c1"># Load the service configuration</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">load_service_config</span><span class="p">()</span>

    <span class="c1"># Create and run the worker</span>
    <span class="n">worker</span> <span class="o">=</span> <span class="n">Worker</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
    <span class="n">uvloop</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">worker</span><span class="o">.</span><span class="n">run_forever</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="aiperfservicesworker_managerworker_manager">aiperf.services.worker_manager.worker_manager<a class="headerlink" href="#aiperfservicesworker_managerworker_manager" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.services.worker_manager.worker_manager"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.services.worker_manager.worker_manager.WorkerManager" class="doc doc-heading">
            <code>WorkerManager</code>


<a href="#aiperf.services.worker_manager.worker_manager.WorkerManager" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseComponentService (aiperf.common.service.base_component_service.BaseComponentService)" href="#aiperf.common.service.base_component_service.BaseComponentService">BaseComponentService</a></code></p>


        <p>The WorkerManager service is primary responsibility is to pull data from the dataset manager
after receiving the timing credit from the timing manager. It will then push the request data
to the worker to issue to the request.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/services/worker_manager/worker_manager.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">WorkerManager</span><span class="p">(</span><span class="n">BaseComponentService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The WorkerManager service is primary responsibility is to pull data from the dataset manager</span>
<span class="sd">    after receiving the timing credit from the timing manager. It will then push the request data</span>
<span class="sd">    to the worker to issue to the request.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">service_config</span><span class="p">:</span> <span class="n">ServiceConfig</span><span class="p">,</span> <span class="n">service_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">service_config</span><span class="o">=</span><span class="n">service_config</span><span class="p">,</span> <span class="n">service_id</span><span class="o">=</span><span class="n">service_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Initializing worker manager&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">WorkerProcess</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># TODO: Need to implement some sort of max workers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Detected </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span><span class="si">}</span><span class="s2"> CPU threads. Spawning </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">worker_count</span><span class="si">}</span><span class="s2"> workers&quot;</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">service_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ServiceType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The type of service.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ServiceType</span><span class="o">.</span><span class="n">WORKER_MANAGER</span>

    <span class="nd">@on_init</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize worker manager-specific components.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Initializing worker manager&quot;</span><span class="p">)</span>

    <span class="nd">@on_start</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start the worker manager.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Starting worker manager&quot;</span><span class="p">)</span>

        <span class="c1"># Spawn workers based on CPU count</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">service_run_type</span> <span class="o">==</span> <span class="n">ServiceRunType</span><span class="o">.</span><span class="n">MULTIPROCESSING</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spawn_multiprocessing_workers</span><span class="p">()</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">service_run_type</span> <span class="o">==</span> <span class="n">ServiceRunType</span><span class="o">.</span><span class="n">KUBERNETES</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spawn_kubernetes_workers</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unsupported run type: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">service_run_type</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">ConfigError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unsupported run type: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">service_run_type</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="nd">@on_stop</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop the worker manager.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Stopping worker manager&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: This needs to be investigated, as currently we handle the exit signal</span>
        <span class="c1">#       by all workers already, so need to understand best way to handle this</span>
        <span class="c1"># # Stop all workers</span>
        <span class="c1"># if self.service_config.service_run_type == ServiceRunType.MULTIPROCESSING:</span>
        <span class="c1">#     await self._stop_multiprocessing_workers()</span>
        <span class="c1"># elif self.service_config.service_run_type == ServiceRunType.KUBERNETES:</span>
        <span class="c1">#     await self._stop_kubernetes_workers()</span>
        <span class="c1"># else:</span>
        <span class="c1">#     self.logger.warning(</span>
        <span class="c1">#         f&quot;Unsupported run type: {self.service_config.service_run_type}&quot;</span>
        <span class="c1">#     )</span>

    <span class="nd">@on_cleanup</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clean up worker manager-specific components.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Cleaning up worker manager&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_spawn_kubernetes_workers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Spawn worker processes using Kubernetes.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Spawning </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">worker_count</span><span class="si">}</span><span class="s2"> worker processes&quot;</span><span class="p">)</span>

        <span class="c1"># TODO: Implement Kubernetes start</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Kubernetes start not implemented&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_stop_kubernetes_workers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop worker processes using Kubernetes.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Stopping all worker processes&quot;</span><span class="p">)</span>

        <span class="c1"># TODO: Implement Kubernetes stop</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Kubernetes stop not implemented&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_spawn_multiprocessing_workers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Spawn worker processes using multiprocessing.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Spawning </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">worker_count</span><span class="si">}</span><span class="s2"> worker processes&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">worker_count</span><span class="p">):</span>
            <span class="n">worker_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;worker_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">process</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span>
                <span class="n">target</span><span class="o">=</span><span class="n">bootstrap_and_run_service</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;worker_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_process&quot;</span><span class="p">,</span>
                <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">Worker</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_config</span><span class="p">),</span>
                <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">process</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="p">[</span><span class="n">worker_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">WorkerProcess</span><span class="p">(</span>
                <span class="n">worker_id</span><span class="o">=</span><span class="n">worker_id</span><span class="p">,</span> <span class="n">process</span><span class="o">=</span><span class="n">process</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Started worker process </span><span class="si">{</span><span class="n">worker_id</span><span class="si">}</span><span class="s2"> (pid: </span><span class="si">{</span><span class="n">process</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_stop_multiprocessing_workers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop all multiprocessing worker processes.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Stopping all worker processes&quot;</span><span class="p">)</span>

        <span class="c1"># First terminate all processes</span>
        <span class="k">for</span> <span class="n">worker_id</span><span class="p">,</span> <span class="n">worker_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping worker process </span><span class="si">{</span><span class="n">worker_id</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">worker_info</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">process</span> <span class="o">=</span> <span class="n">worker_info</span><span class="o">.</span><span class="n">process</span>
            <span class="k">if</span> <span class="n">process</span> <span class="ow">and</span> <span class="n">process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Terminating worker process </span><span class="si">{</span><span class="n">worker_id</span><span class="si">}</span><span class="s2"> (pid: </span><span class="si">{</span><span class="n">process</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="p">)</span>
                <span class="n">process</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>

        <span class="c1"># Then wait for all to finish</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
            <span class="o">*</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_process</span><span class="p">(</span><span class="n">worker_id</span><span class="p">,</span> <span class="n">worker_info</span><span class="o">.</span><span class="n">process</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">worker_id</span><span class="p">,</span> <span class="n">worker_info</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">workers</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">worker_info</span><span class="o">.</span><span class="n">process</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;All worker processes stopped&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_wait_for_process</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">worker_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">process</span><span class="p">:</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait for a process to terminate with timeout handling.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span>
                <span class="n">asyncio</span><span class="o">.</span><span class="n">to_thread</span><span class="p">(</span><span class="n">process</span><span class="o">.</span><span class="n">join</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span>  <span class="c1"># Add timeout to join</span>
                <span class="n">timeout</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>  <span class="c1"># Overall timeout</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Worker process </span><span class="si">{</span><span class="n">worker_id</span><span class="si">}</span><span class="s2"> (pid: </span><span class="si">{</span><span class="n">process</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">) stopped&quot;</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Worker process </span><span class="si">{</span><span class="n">worker_id</span><span class="si">}</span><span class="s2"> (pid: </span><span class="si">{</span><span class="n">process</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">) did not &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;terminate gracefully, killing&quot;</span>
            <span class="p">)</span>
            <span class="n">process</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>

    <span class="nd">@on_configure</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payload</span><span class="p">:</span> <span class="n">BasePayload</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Configure the worker manager.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Configuring worker manager with payload: </span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="aiperf.services.worker_manager.worker_manager.WorkerManager.service_type" class="doc doc-heading">
            <code class=" language-python"><span class="n">service_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#aiperf.services.worker_manager.worker_manager.WorkerManager.service_type" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>The type of service.</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.services.worker_manager.worker_manager.WorkerProcess" class="doc doc-heading">
            <code>WorkerProcess</code>


<a href="#aiperf.services.worker_manager.worker_manager.WorkerProcess" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Information about a worker process.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/services/worker_manager/worker_manager.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">WorkerProcess</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Information about a worker process.&quot;&quot;&quot;</span>

    <span class="n">worker_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;ID of the worker process&quot;</span><span class="p">)</span>
    <span class="n">process</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Process object or task&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="aiperf.services.worker_manager.worker_manager.main" class="doc doc-heading">
            <code class=" language-python"><span class="n">main</span><span class="p">()</span></code>

<a href="#aiperf.services.worker_manager.worker_manager.main" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Main entry point for the worker manager.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/services/worker_manager/worker_manager.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Main entry point for the worker manager.&quot;&quot;&quot;</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">aiperf.common.bootstrap</span><span class="w"> </span><span class="kn">import</span> <span class="n">bootstrap_and_run_service</span>

    <span class="n">bootstrap_and_run_service</span><span class="p">(</span><span class="n">WorkerManager</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="aiperftestsbase_test_component_service">aiperf.tests.base_test_component_service<a class="headerlink" href="#aiperftestsbase_test_component_service" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.tests.base_test_component_service"></a>
    <div class="doc doc-contents first">

        <p>Base test class for component services.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.tests.base_test_component_service.BaseTestComponentService" class="doc doc-heading">
            <code>BaseTestComponentService</code>


<a href="#aiperf.tests.base_test_component_service.BaseTestComponentService" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseTestService (aiperf.tests.base_test_service.BaseTestService)" href="#aiperf.tests.base_test_service.BaseTestService">BaseTestService</a></code></p>


        <p>Base class for testing component services.</p>
<p>This extends BaseTestService with specific tests for the component service
functionality such as heartbeat, registration, and status updates.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/tests/base_test_component_service.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BaseTestComponentService</span><span class="p">(</span><span class="n">BaseTestService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for testing component services.</span>

<span class="sd">    This extends BaseTestService with specific tests for the component service</span>
<span class="sd">    functionality such as heartbeat, registration, and status updates.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">service_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the service class to test.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The BaseComponentService class for testing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">BaseComponentService</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_service_heartbeat</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">BaseComponentService</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">:</span> <span class="n">MagicMock</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test that the service sends heartbeat messages correctly.</span>

<span class="sd">        Verifies:</span>
<span class="sd">        1. The service generates and sends a valid heartbeat message</span>
<span class="sd">        2. The message contains the correct service information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>

        <span class="c1"># Directly send a heartbeat instead of waiting for the task</span>
        <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">send_heartbeat</span><span class="p">()</span>

        <span class="c1"># Check that a heartbeat message was published</span>
        <span class="k">assert</span> <span class="n">Topic</span><span class="o">.</span><span class="n">HEARTBEAT</span> <span class="ow">in</span> <span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span><span class="p">[</span><span class="n">Topic</span><span class="o">.</span><span class="n">HEARTBEAT</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span>

        <span class="c1"># Verify heartbeat message contents</span>
        <span class="n">heartbeat_msg</span> <span class="o">=</span> <span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span><span class="p">[</span>
            <span class="n">Topic</span><span class="o">.</span><span class="n">HEARTBEAT</span>
        <span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">heartbeat_msg</span><span class="o">.</span><span class="n">service_id</span> <span class="o">==</span> <span class="n">service</span><span class="o">.</span><span class="n">service_id</span>
        <span class="k">assert</span> <span class="n">heartbeat_msg</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">service_type</span> <span class="o">==</span> <span class="n">service</span><span class="o">.</span><span class="n">service_type</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_service_registration</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">BaseComponentService</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">:</span> <span class="n">MagicMock</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test that the service registers with the system controller.</span>

<span class="sd">        Verifies:</span>
<span class="sd">        1. The service sends a registration message to the controller</span>
<span class="sd">        2. The registration message contains the correct service information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>

        <span class="c1"># Register the service</span>
        <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">register</span><span class="p">()</span>

        <span class="c1"># Check that a registration message was published</span>
        <span class="k">assert</span> <span class="n">Topic</span><span class="o">.</span><span class="n">REGISTRATION</span> <span class="ow">in</span> <span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span>

        <span class="c1"># Verify registration message contents</span>
        <span class="n">registration_msg</span> <span class="o">=</span> <span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span><span class="p">[</span>
            <span class="n">Topic</span><span class="o">.</span><span class="n">REGISTRATION</span>
        <span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">registration_msg</span><span class="o">.</span><span class="n">service_id</span> <span class="o">==</span> <span class="n">service</span><span class="o">.</span><span class="n">service_id</span>
        <span class="k">assert</span> <span class="n">registration_msg</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">service_type</span> <span class="o">==</span> <span class="n">service</span><span class="o">.</span><span class="n">service_type</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_service_status_update</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">BaseComponentService</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">:</span> <span class="n">MagicMock</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test that the service updates its status correctly.</span>

<span class="sd">        Verifies:</span>
<span class="sd">        1. The service publishes status messages when state changes</span>
<span class="sd">        2. The status message contains the correct state and service information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>

        <span class="c1"># Update the service status</span>
        <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">ServiceState</span><span class="o">.</span><span class="n">READY</span><span class="p">)</span>

        <span class="c1"># Check that a status message was published</span>
        <span class="k">assert</span> <span class="n">Topic</span><span class="o">.</span><span class="n">STATUS</span> <span class="ow">in</span> <span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span>

        <span class="c1"># Verify status message contents</span>
        <span class="n">status_msg</span> <span class="o">=</span> <span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span><span class="p">[</span><span class="n">Topic</span><span class="o">.</span><span class="n">STATUS</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">status_msg</span><span class="o">.</span><span class="n">service_id</span> <span class="o">==</span> <span class="n">service</span><span class="o">.</span><span class="n">service_id</span>
        <span class="k">assert</span> <span class="n">status_msg</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">service_type</span> <span class="o">==</span> <span class="n">service</span><span class="o">.</span><span class="n">service_type</span>
        <span class="k">assert</span> <span class="n">status_msg</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">READY</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.base_test_component_service.BaseTestComponentService.service_class" class="doc doc-heading">
            <code class=" language-python"><span class="n">service_class</span><span class="p">()</span></code>

<a href="#aiperf.tests.base_test_component_service.BaseTestComponentService.service_class" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the service class to test.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="type">type</span>[<a class="autorefs autorefs-internal" title="BaseService (aiperf.common.service.base_service.BaseService)" href="#aiperf.common.service.base_service.BaseService">BaseService</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The BaseComponentService class for testing</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/base_test_component_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">service_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the service class to test.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The BaseComponentService class for testing</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">BaseComponentService</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.base_test_component_service.BaseTestComponentService.test_service_heartbeat" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_service_heartbeat</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.base_test_component_service.BaseTestComponentService.test_service_heartbeat" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test that the service sends heartbeat messages correctly.</p>
<p>Verifies:
1. The service generates and sends a valid heartbeat message
2. The message contains the correct service information</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/base_test_component_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_service_heartbeat</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">BaseComponentService</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">:</span> <span class="n">MagicMock</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test that the service sends heartbeat messages correctly.</span>

<span class="sd">    Verifies:</span>
<span class="sd">    1. The service generates and sends a valid heartbeat message</span>
<span class="sd">    2. The message contains the correct service information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>

    <span class="c1"># Directly send a heartbeat instead of waiting for the task</span>
    <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">send_heartbeat</span><span class="p">()</span>

    <span class="c1"># Check that a heartbeat message was published</span>
    <span class="k">assert</span> <span class="n">Topic</span><span class="o">.</span><span class="n">HEARTBEAT</span> <span class="ow">in</span> <span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span><span class="p">[</span><span class="n">Topic</span><span class="o">.</span><span class="n">HEARTBEAT</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="c1"># Verify heartbeat message contents</span>
    <span class="n">heartbeat_msg</span> <span class="o">=</span> <span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span><span class="p">[</span>
        <span class="n">Topic</span><span class="o">.</span><span class="n">HEARTBEAT</span>
    <span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">heartbeat_msg</span><span class="o">.</span><span class="n">service_id</span> <span class="o">==</span> <span class="n">service</span><span class="o">.</span><span class="n">service_id</span>
    <span class="k">assert</span> <span class="n">heartbeat_msg</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">service_type</span> <span class="o">==</span> <span class="n">service</span><span class="o">.</span><span class="n">service_type</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.base_test_component_service.BaseTestComponentService.test_service_registration" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_service_registration</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.base_test_component_service.BaseTestComponentService.test_service_registration" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test that the service registers with the system controller.</p>
<p>Verifies:
1. The service sends a registration message to the controller
2. The registration message contains the correct service information</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/base_test_component_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_service_registration</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">BaseComponentService</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">:</span> <span class="n">MagicMock</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test that the service registers with the system controller.</span>

<span class="sd">    Verifies:</span>
<span class="sd">    1. The service sends a registration message to the controller</span>
<span class="sd">    2. The registration message contains the correct service information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>

    <span class="c1"># Register the service</span>
    <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">register</span><span class="p">()</span>

    <span class="c1"># Check that a registration message was published</span>
    <span class="k">assert</span> <span class="n">Topic</span><span class="o">.</span><span class="n">REGISTRATION</span> <span class="ow">in</span> <span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span>

    <span class="c1"># Verify registration message contents</span>
    <span class="n">registration_msg</span> <span class="o">=</span> <span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span><span class="p">[</span>
        <span class="n">Topic</span><span class="o">.</span><span class="n">REGISTRATION</span>
    <span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">registration_msg</span><span class="o">.</span><span class="n">service_id</span> <span class="o">==</span> <span class="n">service</span><span class="o">.</span><span class="n">service_id</span>
    <span class="k">assert</span> <span class="n">registration_msg</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">service_type</span> <span class="o">==</span> <span class="n">service</span><span class="o">.</span><span class="n">service_type</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.base_test_component_service.BaseTestComponentService.test_service_status_update" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_service_status_update</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.base_test_component_service.BaseTestComponentService.test_service_status_update" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test that the service updates its status correctly.</p>
<p>Verifies:
1. The service publishes status messages when state changes
2. The status message contains the correct state and service information</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/base_test_component_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_service_status_update</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">BaseComponentService</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">:</span> <span class="n">MagicMock</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test that the service updates its status correctly.</span>

<span class="sd">    Verifies:</span>
<span class="sd">    1. The service publishes status messages when state changes</span>
<span class="sd">    2. The status message contains the correct state and service information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>

    <span class="c1"># Update the service status</span>
    <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">ServiceState</span><span class="o">.</span><span class="n">READY</span><span class="p">)</span>

    <span class="c1"># Check that a status message was published</span>
    <span class="k">assert</span> <span class="n">Topic</span><span class="o">.</span><span class="n">STATUS</span> <span class="ow">in</span> <span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span>

    <span class="c1"># Verify status message contents</span>
    <span class="n">status_msg</span> <span class="o">=</span> <span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span><span class="p">[</span><span class="n">Topic</span><span class="o">.</span><span class="n">STATUS</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">status_msg</span><span class="o">.</span><span class="n">service_id</span> <span class="o">==</span> <span class="n">service</span><span class="o">.</span><span class="n">service_id</span>
    <span class="k">assert</span> <span class="n">status_msg</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">service_type</span> <span class="o">==</span> <span class="n">service</span><span class="o">.</span><span class="n">service_type</span>
    <span class="k">assert</span> <span class="n">status_msg</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">READY</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperftestsbase_test_controller_service">aiperf.tests.base_test_controller_service<a class="headerlink" href="#aiperftestsbase_test_controller_service" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.tests.base_test_controller_service"></a>
    <div class="doc doc-contents first">

        <p>Base test class for controller services.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.tests.base_test_controller_service.BaseTestControllerService" class="doc doc-heading">
            <code>BaseTestControllerService</code>


<a href="#aiperf.tests.base_test_controller_service.BaseTestControllerService" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseTestService (aiperf.tests.base_test_service.BaseTestService)" href="#aiperf.tests.base_test_service.BaseTestService">BaseTestService</a></code></p>


        <p>Base class for testing controller services.</p>
<p>This extends BaseTestService with specific tests for controller service
functionality such as command sending, service registration handling,
and monitoring of component services.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/tests/base_test_controller_service.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BaseTestControllerService</span><span class="p">(</span><span class="n">BaseTestService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for testing controller services.</span>

<span class="sd">    This extends BaseTestService with specific tests for controller service</span>
<span class="sd">    functionality such as command sending, service registration handling,</span>
<span class="sd">    and monitoring of component services.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_controller_command_publishing</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">BaseControllerService</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">:</span> <span class="n">MagicMock</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test that the controller can publish command messages.</span>

<span class="sd">        Verifies the controller can send properly formatted commands to components.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>

        <span class="c1"># Create a test command message</span>
        <span class="n">test_service_id</span> <span class="o">=</span> <span class="s2">&quot;test_service_123&quot;</span>
        <span class="n">command</span> <span class="o">=</span> <span class="n">CommandType</span><span class="o">.</span><span class="n">START</span>

        <span class="c1"># Create a command message</span>
        <span class="n">command_payload</span> <span class="o">=</span> <span class="n">CommandPayload</span><span class="p">(</span>
            <span class="n">command</span><span class="o">=</span><span class="n">command</span><span class="p">,</span>
            <span class="n">target_service_id</span><span class="o">=</span><span class="n">test_service_id</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">command_message</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span><span class="n">command_payload</span><span class="p">)</span>

        <span class="c1"># Publish the command</span>
        <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">comms</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span><span class="n">Topic</span><span class="o">.</span><span class="n">COMMAND</span><span class="p">,</span> <span class="n">command_message</span><span class="p">)</span>

        <span class="c1"># Check that the command was published</span>
        <span class="k">assert</span> <span class="n">Topic</span><span class="o">.</span><span class="n">COMMAND</span> <span class="ow">in</span> <span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span><span class="p">[</span><span class="n">Topic</span><span class="o">.</span><span class="n">COMMAND</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span>

        <span class="c1"># Verify command message</span>
        <span class="n">published_cmd</span> <span class="o">=</span> <span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span><span class="p">[</span><span class="n">Topic</span><span class="o">.</span><span class="n">COMMAND</span><span class="p">][</span>
            <span class="mi">0</span>
        <span class="p">]</span>
        <span class="k">assert</span> <span class="n">published_cmd</span><span class="o">.</span><span class="n">service_id</span> <span class="o">==</span> <span class="n">service</span><span class="o">.</span><span class="n">service_id</span>
        <span class="k">assert</span> <span class="n">published_cmd</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="n">command</span>
        <span class="k">assert</span> <span class="n">published_cmd</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">target_service_id</span> <span class="o">==</span> <span class="n">test_service_id</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.base_test_controller_service.BaseTestControllerService.test_controller_command_publishing" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_controller_command_publishing</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.base_test_controller_service.BaseTestControllerService.test_controller_command_publishing" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test that the controller can publish command messages.</p>
<p>Verifies the controller can send properly formatted commands to components.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/base_test_controller_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_controller_command_publishing</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">BaseControllerService</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">:</span> <span class="n">MagicMock</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test that the controller can publish command messages.</span>

<span class="sd">    Verifies the controller can send properly formatted commands to components.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>

    <span class="c1"># Create a test command message</span>
    <span class="n">test_service_id</span> <span class="o">=</span> <span class="s2">&quot;test_service_123&quot;</span>
    <span class="n">command</span> <span class="o">=</span> <span class="n">CommandType</span><span class="o">.</span><span class="n">START</span>

    <span class="c1"># Create a command message</span>
    <span class="n">command_payload</span> <span class="o">=</span> <span class="n">CommandPayload</span><span class="p">(</span>
        <span class="n">command</span><span class="o">=</span><span class="n">command</span><span class="p">,</span>
        <span class="n">target_service_id</span><span class="o">=</span><span class="n">test_service_id</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">command_message</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span><span class="n">command_payload</span><span class="p">)</span>

    <span class="c1"># Publish the command</span>
    <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">comms</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span><span class="n">Topic</span><span class="o">.</span><span class="n">COMMAND</span><span class="p">,</span> <span class="n">command_message</span><span class="p">)</span>

    <span class="c1"># Check that the command was published</span>
    <span class="k">assert</span> <span class="n">Topic</span><span class="o">.</span><span class="n">COMMAND</span> <span class="ow">in</span> <span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span><span class="p">[</span><span class="n">Topic</span><span class="o">.</span><span class="n">COMMAND</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span>

    <span class="c1"># Verify command message</span>
    <span class="n">published_cmd</span> <span class="o">=</span> <span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span><span class="p">[</span><span class="n">Topic</span><span class="o">.</span><span class="n">COMMAND</span><span class="p">][</span>
        <span class="mi">0</span>
    <span class="p">]</span>
    <span class="k">assert</span> <span class="n">published_cmd</span><span class="o">.</span><span class="n">service_id</span> <span class="o">==</span> <span class="n">service</span><span class="o">.</span><span class="n">service_id</span>
    <span class="k">assert</span> <span class="n">published_cmd</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="n">command</span>
    <span class="k">assert</span> <span class="n">published_cmd</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">target_service_id</span> <span class="o">==</span> <span class="n">test_service_id</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperftestsbase_test_service">aiperf.tests.base_test_service<a class="headerlink" href="#aiperftestsbase_test_service" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.tests.base_test_service"></a>
    <div class="doc doc-contents first">

        <p>Base test class for testing AIPerf services.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.tests.base_test_service.BaseTestService" class="doc doc-heading">
            <code>BaseTestService</code>


<a href="#aiperf.tests.base_test_service.BaseTestService" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>


        <p>Base test class for all service tests.</p>
<p>This class provides common test methods and fixtures for testing
AIPerf services. Specific service test classes should inherit from
this class and implement service-specific fixtures and tests.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/tests/base_test_service.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BaseTestService</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base test class for all service tests.</span>

<span class="sd">    This class provides common test methods and fixtures for testing</span>
<span class="sd">    AIPerf services. Specific service test classes should inherit from</span>
<span class="sd">    this class and implement service-specific fixtures and tests.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">autouse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">no_sleep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monkeypatch</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Patch asyncio.sleep with a no-op to prevent test delays.</span>

<span class="sd">        This ensures tests don&#39;t need to wait for real sleep calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">asyncio</span><span class="p">,</span> <span class="s2">&quot;sleep&quot;</span><span class="p">,</span> <span class="n">async_noop</span><span class="p">)</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">autouse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">patch_communication_factory</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">:</span> <span class="n">MagicMock</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Patch the communication factory to always return our mock communication.</span>

<span class="sd">        This ensures no real communication is attempted during tests.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">patch</span><span class="p">(</span>
            <span class="s2">&quot;aiperf.common.comms.base.CommunicationFactory.create_communication&quot;</span><span class="p">,</span>
            <span class="n">return_value</span><span class="o">=</span><span class="n">mock_communication</span><span class="p">,</span>
        <span class="p">):</span>
            <span class="k">yield</span>

    <span class="nd">@abstractmethod</span>
    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">service_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the service class to test.</span>

<span class="sd">        Must be implemented by subclasses to specify which service is being tested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Subclasses must implement this method&quot;</span><span class="p">)</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">service_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ServiceConfig</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a service configuration for testing.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A ServiceConfig instance with test settings</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ServiceConfig</span><span class="p">(</span>
            <span class="n">service_run_type</span><span class="o">=</span><span class="n">ServiceRunType</span><span class="o">.</span><span class="n">MULTIPROCESSING</span><span class="p">,</span>
            <span class="n">comm_backend</span><span class="o">=</span><span class="n">CommunicationBackend</span><span class="o">.</span><span class="n">ZMQ_TCP</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">uninitialized_service</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">service_class</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">],</span>
        <span class="n">service_config</span><span class="p">:</span> <span class="n">ServiceConfig</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncGenerator</span><span class="p">[</span><span class="n">BaseService</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create an uninitialized instance of the service under test.</span>

<span class="sd">        This provides a service instance before initialize() has been called,</span>
<span class="sd">        allowing tests to verify initialization behavior.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An uninitialized instance of the service</span>

<span class="sd">        Example usage:</span>
<span class="sd">        ```python</span>
<span class="sd">        async def test_service_initialization(uninitialized_service: BaseService):</span>
<span class="sd">            service = await async_fixture(uninitialized_service)</span>
<span class="sd">            await service.initialize()</span>
<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service</span> <span class="o">=</span> <span class="n">service_class</span><span class="p">(</span><span class="n">service_config</span><span class="o">=</span><span class="n">service_config</span><span class="p">)</span>
        <span class="k">yield</span> <span class="n">service</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">initialized_service</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">uninitialized_service</span><span class="p">:</span> <span class="n">BaseService</span><span class="p">,</span>
        <span class="n">mock_communication</span><span class="p">:</span> <span class="n">MagicMock</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncGenerator</span><span class="p">[</span><span class="n">BaseService</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create and initialize the service under test.</span>

<span class="sd">        This fixture sets up a complete service instance ready for testing,</span>
<span class="sd">        with the communication layer mocked.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An initialized instance of the service</span>

<span class="sd">        Example usage:</span>
<span class="sd">        ```python</span>
<span class="sd">        async def test_service_foo(initialized_service: BaseService):</span>
<span class="sd">            service = await async_fixture(initialized_service)</span>
<span class="sd">            await service.foo()</span>
<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">uninitialized_service</span><span class="p">)</span>

        <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

        <span class="k">yield</span> <span class="n">service</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_service_initialization</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">uninitialized_service</span><span class="p">:</span> <span class="n">BaseService</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">:</span> <span class="n">MagicMock</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test that the service initializes correctly. This will be executed</span>
<span class="sd">        for every service that inherits from BaseTestService.</span>

<span class="sd">        This verifies:</span>
<span class="sd">        1. The service has a valid ID and type</span>
<span class="sd">        2. The service transitions to the correct state during initialization</span>
<span class="sd">        3. The service&#39;s internal initialization method is called</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">uninitialized_service</span><span class="p">)</span>

        <span class="c1"># Check that the service has an ID and type</span>
        <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">service_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">service_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="c1"># Check that the service is not initialized</span>
        <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">UNKNOWN</span>

        <span class="c1"># Initialize the service</span>
        <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

        <span class="c1"># Check that the service is initialized and in the READY state</span>
        <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">is_initialized</span>
        <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">READY</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_service_start_stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">BaseService</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test that the service can start and stop correctly. This will be executed</span>
<span class="sd">        for every service that inherits from BaseTestService.</span>

<span class="sd">        This verifies:</span>
<span class="sd">        1. The service transitions to the `ServiceState.RUNNING` state when started</span>
<span class="sd">        2. The service transitions to the `ServiceState.STOPPED` state when stopped</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>

        <span class="c1"># Start the service</span>
        <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">RUNNING</span>

        <span class="c1"># Stop the service</span>
        <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">STOPPED</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span>
        <span class="s2">&quot;state&quot;</span><span class="p">,</span>
        <span class="p">[</span><span class="n">state</span> <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">ServiceState</span> <span class="k">if</span> <span class="n">state</span> <span class="o">!=</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_service_state_transitions</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">BaseService</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">ServiceState</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test that the service can transition to all possible states. This will be executed</span>
<span class="sd">        for every service that inherits from BaseTestService.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>

        <span class="c1"># Update the service state</span>
        <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

        <span class="c1"># Check that the service state was updated</span>
        <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">state</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_service_run_does_not_start</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">BaseService</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test that the service does not start when the run method is called (default behavior). This will be executed</span>
<span class="sd">        for every service that inherits from BaseTestService.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">MagicMock</span><span class="p">(</span><span class="n">wraps</span><span class="o">=</span><span class="n">initialized_service</span><span class="p">))</span>

        <span class="n">service</span><span class="o">.</span><span class="n">_forever_loop</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">run_forever</span><span class="p">()</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="n">service</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">called</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.base_test_service.BaseTestService.initialized_service" class="doc doc-heading">
            <code class=" language-python"><span class="n">initialized_service</span><span class="p">(</span><span class="n">uninitialized_service</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.base_test_service.BaseTestService.initialized_service" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create and initialize the service under test.</p>
<p>This fixture sets up a complete service instance ready for testing,
with the communication layer mocked.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.AsyncGenerator">AsyncGenerator</span>[<a class="autorefs autorefs-internal" title="BaseService (aiperf.common.service.base_service.BaseService)" href="#aiperf.common.service.base_service.BaseService">BaseService</a>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An initialized instance of the service</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="codehilite"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_service_foo</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">:</span> <span class="n">BaseService</span><span class="p">):</span>
    <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>
    <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">foo</span><span class="p">()</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/base_test_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">initialized_service</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">uninitialized_service</span><span class="p">:</span> <span class="n">BaseService</span><span class="p">,</span>
    <span class="n">mock_communication</span><span class="p">:</span> <span class="n">MagicMock</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncGenerator</span><span class="p">[</span><span class="n">BaseService</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create and initialize the service under test.</span>

<span class="sd">    This fixture sets up a complete service instance ready for testing,</span>
<span class="sd">    with the communication layer mocked.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An initialized instance of the service</span>

<span class="sd">    Example usage:</span>
<span class="sd">    ```python</span>
<span class="sd">    async def test_service_foo(initialized_service: BaseService):</span>
<span class="sd">        service = await async_fixture(initialized_service)</span>
<span class="sd">        await service.foo()</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">uninitialized_service</span><span class="p">)</span>

    <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

    <span class="k">yield</span> <span class="n">service</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.base_test_service.BaseTestService.no_sleep" class="doc doc-heading">
            <code class=" language-python"><span class="n">no_sleep</span><span class="p">(</span><span class="n">monkeypatch</span><span class="p">)</span></code>

<a href="#aiperf.tests.base_test_service.BaseTestService.no_sleep" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Patch asyncio.sleep with a no-op to prevent test delays.</p>
<p>This ensures tests don't need to wait for real sleep calls.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/base_test_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">autouse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">no_sleep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monkeypatch</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Patch asyncio.sleep with a no-op to prevent test delays.</span>

<span class="sd">    This ensures tests don&#39;t need to wait for real sleep calls.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">asyncio</span><span class="p">,</span> <span class="s2">&quot;sleep&quot;</span><span class="p">,</span> <span class="n">async_noop</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.base_test_service.BaseTestService.patch_communication_factory" class="doc doc-heading">
            <code class=" language-python"><span class="n">patch_communication_factory</span><span class="p">(</span><span class="n">mock_communication</span><span class="p">)</span></code>

<a href="#aiperf.tests.base_test_service.BaseTestService.patch_communication_factory" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Patch the communication factory to always return our mock communication.</p>
<p>This ensures no real communication is attempted during tests.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/base_test_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">autouse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">patch_communication_factory</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">:</span> <span class="n">MagicMock</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Patch the communication factory to always return our mock communication.</span>

<span class="sd">    This ensures no real communication is attempted during tests.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">patch</span><span class="p">(</span>
        <span class="s2">&quot;aiperf.common.comms.base.CommunicationFactory.create_communication&quot;</span><span class="p">,</span>
        <span class="n">return_value</span><span class="o">=</span><span class="n">mock_communication</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">yield</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.base_test_service.BaseTestService.service_class" class="doc doc-heading">
            <code class=" language-python"><span class="n">service_class</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#aiperf.tests.base_test_service.BaseTestService.service_class" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the service class to test.</p>
<p>Must be implemented by subclasses to specify which service is being tested.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/base_test_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">service_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the service class to test.</span>

<span class="sd">    Must be implemented by subclasses to specify which service is being tested.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Subclasses must implement this method&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.base_test_service.BaseTestService.service_config" class="doc doc-heading">
            <code class=" language-python"><span class="n">service_config</span><span class="p">()</span></code>

<a href="#aiperf.tests.base_test_service.BaseTestService.service_config" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create a service configuration for testing.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ServiceConfig (aiperf.common.config.service_config.ServiceConfig)" href="#aiperf.common.config.service_config.ServiceConfig">ServiceConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A ServiceConfig instance with test settings</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/base_test_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">service_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ServiceConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a service configuration for testing.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A ServiceConfig instance with test settings</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ServiceConfig</span><span class="p">(</span>
        <span class="n">service_run_type</span><span class="o">=</span><span class="n">ServiceRunType</span><span class="o">.</span><span class="n">MULTIPROCESSING</span><span class="p">,</span>
        <span class="n">comm_backend</span><span class="o">=</span><span class="n">CommunicationBackend</span><span class="o">.</span><span class="n">ZMQ_TCP</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.base_test_service.BaseTestService.test_service_initialization" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_service_initialization</span><span class="p">(</span><span class="n">uninitialized_service</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.base_test_service.BaseTestService.test_service_initialization" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test that the service initializes correctly. This will be executed
for every service that inherits from BaseTestService.</p>
<p>This verifies:
1. The service has a valid ID and type
2. The service transitions to the correct state during initialization
3. The service's internal initialization method is called</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/base_test_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_service_initialization</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">uninitialized_service</span><span class="p">:</span> <span class="n">BaseService</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">:</span> <span class="n">MagicMock</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test that the service initializes correctly. This will be executed</span>
<span class="sd">    for every service that inherits from BaseTestService.</span>

<span class="sd">    This verifies:</span>
<span class="sd">    1. The service has a valid ID and type</span>
<span class="sd">    2. The service transitions to the correct state during initialization</span>
<span class="sd">    3. The service&#39;s internal initialization method is called</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">uninitialized_service</span><span class="p">)</span>

    <span class="c1"># Check that the service has an ID and type</span>
    <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">service_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">service_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="c1"># Check that the service is not initialized</span>
    <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">UNKNOWN</span>

    <span class="c1"># Initialize the service</span>
    <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

    <span class="c1"># Check that the service is initialized and in the READY state</span>
    <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">is_initialized</span>
    <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">READY</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.base_test_service.BaseTestService.test_service_run_does_not_start" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_service_run_does_not_start</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.base_test_service.BaseTestService.test_service_run_does_not_start" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test that the service does not start when the run method is called (default behavior). This will be executed
for every service that inherits from BaseTestService.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/base_test_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_service_run_does_not_start</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">BaseService</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test that the service does not start when the run method is called (default behavior). This will be executed</span>
<span class="sd">    for every service that inherits from BaseTestService.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">MagicMock</span><span class="p">(</span><span class="n">wraps</span><span class="o">=</span><span class="n">initialized_service</span><span class="p">))</span>

    <span class="n">service</span><span class="o">.</span><span class="n">_forever_loop</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">run_forever</span><span class="p">()</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="n">service</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">called</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.base_test_service.BaseTestService.test_service_start_stop" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_service_start_stop</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.base_test_service.BaseTestService.test_service_start_stop" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test that the service can start and stop correctly. This will be executed
for every service that inherits from BaseTestService.</p>
<p>This verifies:
1. The service transitions to the <code>ServiceState.RUNNING</code> state when started
2. The service transitions to the <code>ServiceState.STOPPED</code> state when stopped</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/base_test_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_service_start_stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">BaseService</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test that the service can start and stop correctly. This will be executed</span>
<span class="sd">    for every service that inherits from BaseTestService.</span>

<span class="sd">    This verifies:</span>
<span class="sd">    1. The service transitions to the `ServiceState.RUNNING` state when started</span>
<span class="sd">    2. The service transitions to the `ServiceState.STOPPED` state when stopped</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>

    <span class="c1"># Start the service</span>
    <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">RUNNING</span>

    <span class="c1"># Stop the service</span>
    <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">STOPPED</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.base_test_service.BaseTestService.test_service_state_transitions" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_service_state_transitions</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.base_test_service.BaseTestService.test_service_state_transitions" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test that the service can transition to all possible states. This will be executed
for every service that inherits from BaseTestService.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/base_test_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span>
    <span class="s2">&quot;state&quot;</span><span class="p">,</span>
    <span class="p">[</span><span class="n">state</span> <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">ServiceState</span> <span class="k">if</span> <span class="n">state</span> <span class="o">!=</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">],</span>
<span class="p">)</span>
<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_service_state_transitions</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">BaseService</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">ServiceState</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test that the service can transition to all possible states. This will be executed</span>
<span class="sd">    for every service that inherits from BaseTestService.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>

    <span class="c1"># Update the service state</span>
    <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

    <span class="c1"># Check that the service state was updated</span>
    <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">state</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.base_test_service.BaseTestService.uninitialized_service" class="doc doc-heading">
            <code class=" language-python"><span class="n">uninitialized_service</span><span class="p">(</span><span class="n">service_class</span><span class="p">,</span> <span class="n">service_config</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.base_test_service.BaseTestService.uninitialized_service" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create an uninitialized instance of the service under test.</p>
<p>This provides a service instance before initialize() has been called,
allowing tests to verify initialization behavior.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.AsyncGenerator">AsyncGenerator</span>[<a class="autorefs autorefs-internal" title="BaseService (aiperf.common.service.base_service.BaseService)" href="#aiperf.common.service.base_service.BaseService">BaseService</a>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An uninitialized instance of the service</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example usage:</p>
<div class="codehilite"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_service_initialization</span><span class="p">(</span><span class="n">uninitialized_service</span><span class="p">:</span> <span class="n">BaseService</span><span class="p">):</span>
    <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">uninitialized_service</span><span class="p">)</span>
    <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/base_test_service.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">uninitialized_service</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">service_class</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">],</span>
    <span class="n">service_config</span><span class="p">:</span> <span class="n">ServiceConfig</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncGenerator</span><span class="p">[</span><span class="n">BaseService</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create an uninitialized instance of the service under test.</span>

<span class="sd">    This provides a service instance before initialize() has been called,</span>
<span class="sd">    allowing tests to verify initialization behavior.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An uninitialized instance of the service</span>

<span class="sd">    Example usage:</span>
<span class="sd">    ```python</span>
<span class="sd">    async def test_service_initialization(uninitialized_service: BaseService):</span>
<span class="sd">        service = await async_fixture(uninitialized_service)</span>
<span class="sd">        await service.initialize()</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">service</span> <span class="o">=</span> <span class="n">service_class</span><span class="p">(</span><span class="n">service_config</span><span class="o">=</span><span class="n">service_config</span><span class="p">)</span>
    <span class="k">yield</span> <span class="n">service</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperftestscommsmock_zmq">aiperf.tests.comms.mock_zmq<a class="headerlink" href="#aiperftestscommsmock_zmq" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.tests.comms.mock_zmq"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.tests.comms.mock_zmq.MockCommunicationData" class="doc doc-heading">
            <code>MockCommunicationData</code>


<a href="#aiperf.tests.comms.mock_zmq.MockCommunicationData" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Data structure to hold state information for mock communication objects.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/tests/comms/mock_zmq.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MockCommunicationData</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Data structure to hold state information for mock communication objects.&quot;&quot;&quot;</span>

    <span class="n">published_messages</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Topic</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Message</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">subscriptions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Message</span><span class="p">],</span> <span class="n">Coroutine</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span>
    <span class="p">)</span>
    <span class="n">pull_callbacks</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Topic</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Message</span><span class="p">],</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">push_messages</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Topic</span><span class="p">,</span> <span class="n">Message</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">requests</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Message</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">responses</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Message</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">published_messages</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subscriptions</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pull_callbacks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_messages</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">responses</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="aiperf.tests.comms.mock_zmq.mock_zmq_communication" class="doc doc-heading">
            <code class=" language-python"><span class="n">mock_zmq_communication</span><span class="p">()</span></code>

<a href="#aiperf.tests.comms.mock_zmq.mock_zmq_communication" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Create a mock communication object for testing service communication.</p>
<p>This mock tracks published messages, subscriptions, pull callbacks,
push messages, and requests and responses for verification in tests.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="unittest.mock.MagicMock">MagicMock</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A MagicMock configured to behave like ZMQCommunication</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/comms/mock_zmq.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mock_zmq_communication</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">MagicMock</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a mock communication object for testing service communication.</span>

<span class="sd">    This mock tracks published messages, subscriptions, pull callbacks,</span>
<span class="sd">    push messages, and requests and responses for verification in tests.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A MagicMock configured to behave like ZMQCommunication</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mock_comm</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">(</span><span class="n">spec</span><span class="o">=</span><span class="n">ZMQCommunication</span><span class="p">)</span>

    <span class="c1"># Configure basic behavior</span>
    <span class="n">mock_comm</span><span class="o">.</span><span class="n">initialize</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">mock_comm</span><span class="o">.</span><span class="n">shutdown</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">mock_comm</span><span class="o">.</span><span class="n">create_clients</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">mock_comm</span><span class="o">.</span><span class="n">mock_data</span> <span class="o">=</span> <span class="n">MockCommunicationData</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">mock_publish</span><span class="p">(</span><span class="n">topic</span><span class="p">:</span> <span class="n">Topic</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mock implementation of publish that stores messages by topic.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">topic</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mock_comm</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span><span class="p">:</span>
            <span class="n">mock_comm</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span><span class="p">[</span><span class="n">topic</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">mock_comm</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">published_messages</span><span class="p">[</span><span class="n">topic</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="n">mock_comm</span><span class="o">.</span><span class="n">publish</span><span class="o">.</span><span class="n">side_effect</span> <span class="o">=</span> <span class="n">mock_publish</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">mock_subscribe</span><span class="p">(</span>
        <span class="n">topic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Message</span><span class="p">],</span> <span class="n">Coroutine</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mock implementation of subscribe that stores callbacks by topic.&quot;&quot;&quot;</span>
        <span class="n">mock_comm</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">subscriptions</span><span class="p">[</span><span class="n">topic</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>

    <span class="n">mock_comm</span><span class="o">.</span><span class="n">subscribe</span><span class="o">.</span><span class="n">side_effect</span> <span class="o">=</span> <span class="n">mock_subscribe</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">mock_pull</span><span class="p">(</span><span class="n">topic</span><span class="p">:</span> <span class="n">Topic</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Message</span><span class="p">],</span> <span class="kc">None</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mock implementation of pull that stores callbacks by topic.&quot;&quot;&quot;</span>
        <span class="n">mock_comm</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">pull_callbacks</span><span class="p">[</span><span class="n">topic</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>

    <span class="n">mock_comm</span><span class="o">.</span><span class="n">pull</span><span class="o">.</span><span class="n">side_effect</span> <span class="o">=</span> <span class="n">mock_pull</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">mock_push</span><span class="p">(</span><span class="n">topic</span><span class="p">:</span> <span class="n">Topic</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mock implementation of push that stores messages by topic.&quot;&quot;&quot;</span>
        <span class="n">mock_comm</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">push_messages</span><span class="p">[</span><span class="n">topic</span><span class="p">]</span> <span class="o">=</span> <span class="n">message</span>

    <span class="n">mock_comm</span><span class="o">.</span><span class="n">push</span><span class="o">.</span><span class="n">side_effect</span> <span class="o">=</span> <span class="n">mock_push</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">mock_request</span><span class="p">(</span><span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">request_data</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Message</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mock implementation of request that stores requests by target.&quot;&quot;&quot;</span>
        <span class="n">mock_comm</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">requests</span><span class="p">[</span><span class="n">target</span><span class="p">]</span> <span class="o">=</span> <span class="n">request_data</span>

        <span class="c1"># Return a fake mock response</span>
        <span class="k">return</span> <span class="n">BaseMessage</span><span class="p">(</span>
            <span class="n">payload</span><span class="o">=</span><span class="n">DataPayload</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="n">mock_comm</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">side_effect</span> <span class="o">=</span> <span class="n">mock_request</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">mock_respond</span><span class="p">(</span><span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mock implementation of respond that stores responses by target.&quot;&quot;&quot;</span>
        <span class="n">mock_comm</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">responses</span><span class="p">[</span><span class="n">target</span><span class="p">]</span> <span class="o">=</span> <span class="n">response</span>

    <span class="n">mock_comm</span><span class="o">.</span><span class="n">respond</span><span class="o">.</span><span class="n">side_effect</span> <span class="o">=</span> <span class="n">mock_respond</span>

    <span class="k">return</span> <span class="n">mock_comm</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="aiperftestscommstest_zmq_communication">aiperf.tests.comms.test_zmq_communication<a class="headerlink" href="#aiperftestscommstest_zmq_communication" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.tests.comms.test_zmq_communication"></a>
    <div class="doc doc-contents first">

        <p>Tests for the ZMQ communication module.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.tests.comms.test_zmq_communication.TestZMQCommunication" class="doc doc-heading">
            <code>TestZMQCommunication</code>


<a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Tests for the ZMQ communication class.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/tests/comms/test_zmq_communication.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TestZMQCommunication</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Tests for the ZMQ communication class.&quot;&quot;&quot;</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">mock_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a mock configuration for ZMQCommunication.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ZMQCommunicationConfig</span><span class="p">(</span>
            <span class="n">protocol_config</span><span class="o">=</span><span class="n">ZMQTCPTransportConfig</span><span class="p">(),</span> <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;test-client&quot;</span>
        <span class="p">)</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">zmq_communication</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mock_config</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a ZMQCommunication instance for testing.&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">patch</span><span class="p">(</span><span class="s2">&quot;zmq.asyncio.Context&quot;</span><span class="p">,</span> <span class="n">MagicMock</span><span class="p">())</span> <span class="k">as</span> <span class="n">mock_context</span><span class="p">:</span>
            <span class="c1"># Set up the context mock to return properly</span>
            <span class="n">mock_context</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">()</span>
            <span class="n">comm</span> <span class="o">=</span> <span class="n">ZMQCommunication</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">mock_config</span><span class="p">)</span>
            <span class="n">comm</span><span class="o">.</span><span class="n">_context</span> <span class="o">=</span> <span class="n">mock_context</span>
            <span class="k">return</span> <span class="n">comm</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a test response for communication tests.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">BaseMessage</span><span class="p">(</span>
            <span class="n">service_id</span><span class="o">=</span><span class="s2">&quot;test-service&quot;</span><span class="p">,</span>
            <span class="n">payload</span><span class="o">=</span><span class="n">DataPayload</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_initialization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zmq_communication</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that the ZMQ communication initializes correctly.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">assert</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">is_initialized</span> <span class="ow">is</span> <span class="kc">True</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_initialization_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zmq_communication</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test initialization failure handling.&quot;&quot;&quot;</span>
        <span class="c1"># Temporarily clear initialized_event to test error path</span>
        <span class="n">zmq_communication</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="c1"># Create a mock implementation that raises an exception</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">mock_init_with_error</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">CommunicationInitializationError</span><span class="p">(</span><span class="s2">&quot;Test connection error&quot;</span><span class="p">)</span>

        <span class="c1"># Replace the original method and call to test error handling</span>
        <span class="n">original_init</span> <span class="o">=</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">initialize</span>
        <span class="n">zmq_communication</span><span class="o">.</span><span class="n">initialize</span> <span class="o">=</span> <span class="n">mock_init_with_error</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span>
                <span class="n">CommunicationInitializationError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Test connection error&quot;</span>
            <span class="p">):</span>
                <span class="k">await</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="c1"># Restore the original method</span>
            <span class="n">zmq_communication</span><span class="o">.</span><span class="n">initialize</span> <span class="o">=</span> <span class="n">original_init</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_create_clients</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zmq_communication</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test creating clients for different communication patterns.&quot;&quot;&quot;</span>
        <span class="c1"># Mock the client socket creation</span>
        <span class="n">mock_client</span> <span class="o">=</span> <span class="n">AsyncMock</span><span class="p">()</span>

        <span class="c1"># Patch the specific client classes and ensure they return our mock</span>
        <span class="k">with</span> <span class="p">(</span>
            <span class="n">patch</span><span class="p">(</span>
                <span class="s2">&quot;aiperf.common.comms.zmq.clients.ZMQPubClient&quot;</span><span class="p">,</span>
                <span class="n">return_value</span><span class="o">=</span><span class="n">mock_client</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">patch</span><span class="p">(</span>
                <span class="s2">&quot;aiperf.common.comms.zmq.clients.ZMQSubClient&quot;</span><span class="p">,</span>
                <span class="n">return_value</span><span class="o">=</span><span class="n">mock_client</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">):</span>
            <span class="c1"># Call create_clients</span>
            <span class="k">await</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">create_clients</span><span class="p">(</span>
                <span class="n">PubClientType</span><span class="o">.</span><span class="n">COMPONENT</span><span class="p">,</span> <span class="n">SubClientType</span><span class="o">.</span><span class="n">COMPONENT</span>
            <span class="p">)</span>

            <span class="c1"># Verify clients were added to the dictionary</span>
            <span class="k">assert</span> <span class="n">PubClientType</span><span class="o">.</span><span class="n">COMPONENT</span> <span class="ow">in</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">clients</span>
            <span class="k">assert</span> <span class="n">SubClientType</span><span class="o">.</span><span class="n">COMPONENT</span> <span class="ow">in</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">clients</span>

            <span class="c1"># Verify initialize was called for each client</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">zmq_communication</span><span class="o">.</span><span class="n">clients</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_publish_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zmq_communication</span><span class="p">,</span> <span class="n">test_message</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test publishing messages.&quot;&quot;&quot;</span>
        <span class="c1"># Mock the socket publish method</span>
        <span class="n">mock_client</span> <span class="o">=</span> <span class="n">AsyncMock</span><span class="p">()</span>
        <span class="n">mock_client</span><span class="o">.</span><span class="n">publish</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Set up the client in the clients dictionary</span>
        <span class="n">zmq_communication</span><span class="o">.</span><span class="n">clients</span> <span class="o">=</span> <span class="p">{</span><span class="n">PubClientType</span><span class="o">.</span><span class="n">COMPONENT</span><span class="p">:</span> <span class="n">mock_client</span><span class="p">}</span>
        <span class="n">zmq_communication</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

        <span class="c1"># Publish a message</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span><span class="n">Topic</span><span class="o">.</span><span class="n">STATUS</span><span class="p">,</span> <span class="n">test_message</span><span class="p">)</span>

        <span class="c1"># Verify the message was published</span>
        <span class="k">assert</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="n">mock_client</span><span class="o">.</span><span class="n">publish</span><span class="o">.</span><span class="n">assert_called_once_with</span><span class="p">(</span><span class="n">Topic</span><span class="o">.</span><span class="n">STATUS</span><span class="p">,</span> <span class="n">test_message</span><span class="p">)</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_subscribe_to_topic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zmq_communication</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test subscribing to a topic.&quot;&quot;&quot;</span>
        <span class="c1"># Mock the client socket</span>
        <span class="n">mock_client</span> <span class="o">=</span> <span class="n">AsyncMock</span><span class="p">()</span>
        <span class="n">mock_client</span><span class="o">.</span><span class="n">subscribe</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Set up the client in the clients dictionary</span>
        <span class="n">zmq_communication</span><span class="o">.</span><span class="n">clients</span> <span class="o">=</span> <span class="p">{</span><span class="n">SubClientType</span><span class="o">.</span><span class="n">COMPONENT</span><span class="p">:</span> <span class="n">mock_client</span><span class="p">}</span>
        <span class="n">zmq_communication</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

        <span class="c1"># Create a callback function</span>
        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="c1"># Subscribe to a topic</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">Topic</span><span class="o">.</span><span class="n">STATUS</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

        <span class="c1"># Verify subscription was set up</span>
        <span class="k">assert</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="n">mock_client</span><span class="o">.</span><span class="n">subscribe</span><span class="o">.</span><span class="n">assert_called_once_with</span><span class="p">(</span><span class="n">Topic</span><span class="o">.</span><span class="n">STATUS</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zmq_communication</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test graceful shutdown of communication.&quot;&quot;&quot;</span>
        <span class="c1"># Mock the client socket</span>
        <span class="n">mock_client1</span> <span class="o">=</span> <span class="n">AsyncMock</span><span class="p">()</span>
        <span class="n">mock_client1</span><span class="o">.</span><span class="n">shutdown</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">mock_client2</span> <span class="o">=</span> <span class="n">AsyncMock</span><span class="p">()</span>
        <span class="n">mock_client2</span><span class="o">.</span><span class="n">shutdown</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Set up clients</span>
        <span class="n">zmq_communication</span><span class="o">.</span><span class="n">clients</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">PubClientType</span><span class="o">.</span><span class="n">COMPONENT</span><span class="p">:</span> <span class="n">mock_client1</span><span class="p">,</span>
            <span class="n">SubClientType</span><span class="o">.</span><span class="n">COMPONENT</span><span class="p">:</span> <span class="n">mock_client2</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">zmq_communication</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
        <span class="n">zmq_communication</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="c1"># Mock the context with a patched shutdown method to avoid setting</span>
        <span class="c1"># context to None</span>
        <span class="n">context_mock</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">()</span>
        <span class="n">zmq_communication</span><span class="o">.</span><span class="n">_context</span> <span class="o">=</span> <span class="n">context_mock</span>

        <span class="c1"># Create a patched version of shutdown that doesn&#39;t set context to None</span>
        <span class="n">original_shutdown</span> <span class="o">=</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">shutdown</span>

        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">patched_shutdown</span><span class="p">():</span>
            <span class="c1"># Calls original gather but patch term() to prevent context from</span>
            <span class="c1"># becoming None</span>
            <span class="k">with</span> <span class="n">patch</span><span class="o">.</span><span class="n">object</span><span class="p">(</span><span class="n">zmq_communication</span><span class="p">,</span> <span class="s2">&quot;_context&quot;</span><span class="p">,</span> <span class="n">context_mock</span><span class="p">):</span>
                <span class="k">return</span> <span class="k">await</span> <span class="n">original_shutdown</span><span class="p">()</span>

        <span class="n">zmq_communication</span><span class="o">.</span><span class="n">shutdown</span> <span class="o">=</span> <span class="n">patched_shutdown</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Shutdown the communication</span>
            <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>

            <span class="c1"># Verify both clients were shutdown</span>
            <span class="k">assert</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="k">assert</span> <span class="n">mock_client1</span><span class="o">.</span><span class="n">shutdown</span><span class="o">.</span><span class="n">called</span>
            <span class="k">assert</span> <span class="n">mock_client2</span><span class="o">.</span><span class="n">shutdown</span><span class="o">.</span><span class="n">called</span>
            <span class="k">assert</span> <span class="n">context_mock</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">called</span>
            <span class="k">assert</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="c1"># Restore the original method</span>
            <span class="n">zmq_communication</span><span class="o">.</span><span class="n">shutdown</span> <span class="o">=</span> <span class="n">original_shutdown</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.mock_config" class="doc doc-heading">
            <code class=" language-python"><span class="n">mock_config</span><span class="p">()</span></code>

<a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.mock_config" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return a mock configuration for ZMQCommunication.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/comms/test_zmq_communication.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mock_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a mock configuration for ZMQCommunication.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ZMQCommunicationConfig</span><span class="p">(</span>
        <span class="n">protocol_config</span><span class="o">=</span><span class="n">ZMQTCPTransportConfig</span><span class="p">(),</span> <span class="n">client_id</span><span class="o">=</span><span class="s2">&quot;test-client&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_create_clients" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_create_clients</span><span class="p">(</span><span class="n">zmq_communication</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_create_clients" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test creating clients for different communication patterns.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/comms/test_zmq_communication.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_create_clients</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zmq_communication</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test creating clients for different communication patterns.&quot;&quot;&quot;</span>
    <span class="c1"># Mock the client socket creation</span>
    <span class="n">mock_client</span> <span class="o">=</span> <span class="n">AsyncMock</span><span class="p">()</span>

    <span class="c1"># Patch the specific client classes and ensure they return our mock</span>
    <span class="k">with</span> <span class="p">(</span>
        <span class="n">patch</span><span class="p">(</span>
            <span class="s2">&quot;aiperf.common.comms.zmq.clients.ZMQPubClient&quot;</span><span class="p">,</span>
            <span class="n">return_value</span><span class="o">=</span><span class="n">mock_client</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">patch</span><span class="p">(</span>
            <span class="s2">&quot;aiperf.common.comms.zmq.clients.ZMQSubClient&quot;</span><span class="p">,</span>
            <span class="n">return_value</span><span class="o">=</span><span class="n">mock_client</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">):</span>
        <span class="c1"># Call create_clients</span>
        <span class="k">await</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">create_clients</span><span class="p">(</span>
            <span class="n">PubClientType</span><span class="o">.</span><span class="n">COMPONENT</span><span class="p">,</span> <span class="n">SubClientType</span><span class="o">.</span><span class="n">COMPONENT</span>
        <span class="p">)</span>

        <span class="c1"># Verify clients were added to the dictionary</span>
        <span class="k">assert</span> <span class="n">PubClientType</span><span class="o">.</span><span class="n">COMPONENT</span> <span class="ow">in</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">clients</span>
        <span class="k">assert</span> <span class="n">SubClientType</span><span class="o">.</span><span class="n">COMPONENT</span> <span class="ow">in</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">clients</span>

        <span class="c1"># Verify initialize was called for each client</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">zmq_communication</span><span class="o">.</span><span class="n">clients</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_initialization" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_initialization</span><span class="p">(</span><span class="n">zmq_communication</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_initialization" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test that the ZMQ communication initializes correctly.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/comms/test_zmq_communication.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_initialization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zmq_communication</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that the ZMQ communication initializes correctly.&quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span>
    <span class="k">assert</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">is_initialized</span> <span class="ow">is</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_initialization_failure" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_initialization_failure</span><span class="p">(</span><span class="n">zmq_communication</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_initialization_failure" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test initialization failure handling.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/comms/test_zmq_communication.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_initialization_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zmq_communication</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test initialization failure handling.&quot;&quot;&quot;</span>
    <span class="c1"># Temporarily clear initialized_event to test error path</span>
    <span class="n">zmq_communication</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="c1"># Create a mock implementation that raises an exception</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">mock_init_with_error</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">CommunicationInitializationError</span><span class="p">(</span><span class="s2">&quot;Test connection error&quot;</span><span class="p">)</span>

    <span class="c1"># Replace the original method and call to test error handling</span>
    <span class="n">original_init</span> <span class="o">=</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">initialize</span>
    <span class="n">zmq_communication</span><span class="o">.</span><span class="n">initialize</span> <span class="o">=</span> <span class="n">mock_init_with_error</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span>
            <span class="n">CommunicationInitializationError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Test connection error&quot;</span>
        <span class="p">):</span>
            <span class="k">await</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># Restore the original method</span>
        <span class="n">zmq_communication</span><span class="o">.</span><span class="n">initialize</span> <span class="o">=</span> <span class="n">original_init</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_message" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_message</span><span class="p">()</span></code>

<a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_message" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create a test response for communication tests.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/comms/test_zmq_communication.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a test response for communication tests.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">BaseMessage</span><span class="p">(</span>
        <span class="n">service_id</span><span class="o">=</span><span class="s2">&quot;test-service&quot;</span><span class="p">,</span>
        <span class="n">payload</span><span class="o">=</span><span class="n">DataPayload</span><span class="p">(),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_publish_message" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_publish_message</span><span class="p">(</span><span class="n">zmq_communication</span><span class="p">,</span> <span class="n">test_message</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_publish_message" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test publishing messages.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/comms/test_zmq_communication.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_publish_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zmq_communication</span><span class="p">,</span> <span class="n">test_message</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test publishing messages.&quot;&quot;&quot;</span>
    <span class="c1"># Mock the socket publish method</span>
    <span class="n">mock_client</span> <span class="o">=</span> <span class="n">AsyncMock</span><span class="p">()</span>
    <span class="n">mock_client</span><span class="o">.</span><span class="n">publish</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Set up the client in the clients dictionary</span>
    <span class="n">zmq_communication</span><span class="o">.</span><span class="n">clients</span> <span class="o">=</span> <span class="p">{</span><span class="n">PubClientType</span><span class="o">.</span><span class="n">COMPONENT</span><span class="p">:</span> <span class="n">mock_client</span><span class="p">}</span>
    <span class="n">zmq_communication</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="c1"># Publish a message</span>
    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span><span class="n">Topic</span><span class="o">.</span><span class="n">STATUS</span><span class="p">,</span> <span class="n">test_message</span><span class="p">)</span>

    <span class="c1"># Verify the message was published</span>
    <span class="k">assert</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span>
    <span class="n">mock_client</span><span class="o">.</span><span class="n">publish</span><span class="o">.</span><span class="n">assert_called_once_with</span><span class="p">(</span><span class="n">Topic</span><span class="o">.</span><span class="n">STATUS</span><span class="p">,</span> <span class="n">test_message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_shutdown" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_shutdown</span><span class="p">(</span><span class="n">zmq_communication</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_shutdown" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test graceful shutdown of communication.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/comms/test_zmq_communication.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zmq_communication</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test graceful shutdown of communication.&quot;&quot;&quot;</span>
    <span class="c1"># Mock the client socket</span>
    <span class="n">mock_client1</span> <span class="o">=</span> <span class="n">AsyncMock</span><span class="p">()</span>
    <span class="n">mock_client1</span><span class="o">.</span><span class="n">shutdown</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">mock_client2</span> <span class="o">=</span> <span class="n">AsyncMock</span><span class="p">()</span>
    <span class="n">mock_client2</span><span class="o">.</span><span class="n">shutdown</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Set up clients</span>
    <span class="n">zmq_communication</span><span class="o">.</span><span class="n">clients</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">PubClientType</span><span class="o">.</span><span class="n">COMPONENT</span><span class="p">:</span> <span class="n">mock_client1</span><span class="p">,</span>
        <span class="n">SubClientType</span><span class="o">.</span><span class="n">COMPONENT</span><span class="p">:</span> <span class="n">mock_client2</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">zmq_communication</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
    <span class="n">zmq_communication</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="c1"># Mock the context with a patched shutdown method to avoid setting</span>
    <span class="c1"># context to None</span>
    <span class="n">context_mock</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">()</span>
    <span class="n">zmq_communication</span><span class="o">.</span><span class="n">_context</span> <span class="o">=</span> <span class="n">context_mock</span>

    <span class="c1"># Create a patched version of shutdown that doesn&#39;t set context to None</span>
    <span class="n">original_shutdown</span> <span class="o">=</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">shutdown</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">patched_shutdown</span><span class="p">():</span>
        <span class="c1"># Calls original gather but patch term() to prevent context from</span>
        <span class="c1"># becoming None</span>
        <span class="k">with</span> <span class="n">patch</span><span class="o">.</span><span class="n">object</span><span class="p">(</span><span class="n">zmq_communication</span><span class="p">,</span> <span class="s2">&quot;_context&quot;</span><span class="p">,</span> <span class="n">context_mock</span><span class="p">):</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">original_shutdown</span><span class="p">()</span>

    <span class="n">zmq_communication</span><span class="o">.</span><span class="n">shutdown</span> <span class="o">=</span> <span class="n">patched_shutdown</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Shutdown the communication</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>

        <span class="c1"># Verify both clients were shutdown</span>
        <span class="k">assert</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">assert</span> <span class="n">mock_client1</span><span class="o">.</span><span class="n">shutdown</span><span class="o">.</span><span class="n">called</span>
        <span class="k">assert</span> <span class="n">mock_client2</span><span class="o">.</span><span class="n">shutdown</span><span class="o">.</span><span class="n">called</span>
        <span class="k">assert</span> <span class="n">context_mock</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">called</span>
        <span class="k">assert</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># Restore the original method</span>
        <span class="n">zmq_communication</span><span class="o">.</span><span class="n">shutdown</span> <span class="o">=</span> <span class="n">original_shutdown</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_subscribe_to_topic" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_subscribe_to_topic</span><span class="p">(</span><span class="n">zmq_communication</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.test_subscribe_to_topic" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test subscribing to a topic.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/comms/test_zmq_communication.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_subscribe_to_topic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zmq_communication</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test subscribing to a topic.&quot;&quot;&quot;</span>
    <span class="c1"># Mock the client socket</span>
    <span class="n">mock_client</span> <span class="o">=</span> <span class="n">AsyncMock</span><span class="p">()</span>
    <span class="n">mock_client</span><span class="o">.</span><span class="n">subscribe</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Set up the client in the clients dictionary</span>
    <span class="n">zmq_communication</span><span class="o">.</span><span class="n">clients</span> <span class="o">=</span> <span class="p">{</span><span class="n">SubClientType</span><span class="o">.</span><span class="n">COMPONENT</span><span class="p">:</span> <span class="n">mock_client</span><span class="p">}</span>
    <span class="n">zmq_communication</span><span class="o">.</span><span class="n">initialized_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="c1"># Create a callback function</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">callback</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="c1"># Subscribe to a topic</span>
    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">zmq_communication</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">Topic</span><span class="o">.</span><span class="n">STATUS</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

    <span class="c1"># Verify subscription was set up</span>
    <span class="k">assert</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span>
    <span class="n">mock_client</span><span class="o">.</span><span class="n">subscribe</span><span class="o">.</span><span class="n">assert_called_once_with</span><span class="p">(</span><span class="n">Topic</span><span class="o">.</span><span class="n">STATUS</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.zmq_communication" class="doc doc-heading">
            <code class=" language-python"><span class="n">zmq_communication</span><span class="p">(</span><span class="n">mock_config</span><span class="p">)</span></code>

<a href="#aiperf.tests.comms.test_zmq_communication.TestZMQCommunication.zmq_communication" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return a ZMQCommunication instance for testing.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/comms/test_zmq_communication.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">zmq_communication</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mock_config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a ZMQCommunication instance for testing.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">patch</span><span class="p">(</span><span class="s2">&quot;zmq.asyncio.Context&quot;</span><span class="p">,</span> <span class="n">MagicMock</span><span class="p">())</span> <span class="k">as</span> <span class="n">mock_context</span><span class="p">:</span>
        <span class="c1"># Set up the context mock to return properly</span>
        <span class="n">mock_context</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">()</span>
        <span class="n">comm</span> <span class="o">=</span> <span class="n">ZMQCommunication</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">mock_config</span><span class="p">)</span>
        <span class="n">comm</span><span class="o">.</span><span class="n">_context</span> <span class="o">=</span> <span class="n">mock_context</span>
        <span class="k">return</span> <span class="n">comm</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperftestsconftest">aiperf.tests.conftest<a class="headerlink" href="#aiperftestsconftest" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.tests.conftest"></a>
    <div class="doc doc-contents first">

        <p>Shared fixtures for testing AIPerf services.</p>
<p>This file contains fixtures that are automatically discovered by pytest
and made available to test functions in the same directory and subdirectories.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="aiperf.tests.conftest.mock_communication" class="doc doc-heading">
            <code class=" language-python"><span class="n">mock_communication</span><span class="p">(</span><span class="n">mock_zmq_communication</span><span class="p">)</span></code>

<a href="#aiperf.tests.conftest.mock_communication" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Create a mock communication object for testing service communication.</p>
<p>This mock tracks published messages and subscriptions for verification in tests.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="unittest.mock.MagicMock">MagicMock</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An MagicMock configured to behave like ZMQCommunication</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/conftest.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mock_communication</span><span class="p">(</span><span class="n">mock_zmq_communication</span><span class="p">:</span> <span class="n">MagicMock</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MagicMock</span><span class="p">:</span>  <span class="c1"># noqa: F811 : used as a fixture</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a mock communication object for testing service communication.</span>

<span class="sd">    This mock tracks published messages and subscriptions for verification in tests.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An MagicMock configured to behave like ZMQCommunication</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">mock_zmq_communication</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="aiperf.tests.conftest.mock_zmq_context" class="doc doc-heading">
            <code class=" language-python"><span class="n">mock_zmq_context</span><span class="p">()</span></code>

<a href="#aiperf.tests.conftest.mock_zmq_context" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Fixture to provide a mock ZMQ context.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/conftest.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mock_zmq_context</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">MagicMock</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fixture to provide a mock ZMQ context.&quot;&quot;&quot;</span>
    <span class="n">zmq_context</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">()</span>
    <span class="n">zmq_context</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="n">mock_zmq_socket</span><span class="p">()</span>

    <span class="k">with</span> <span class="n">patch</span><span class="p">(</span><span class="s2">&quot;zmq.Context&quot;</span><span class="p">,</span> <span class="n">new_callable</span><span class="o">=</span><span class="n">zmq_context</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">zmq_context</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="aiperf.tests.conftest.mock_zmq_socket" class="doc doc-heading">
            <code class=" language-python"><span class="n">mock_zmq_socket</span><span class="p">()</span></code>

<a href="#aiperf.tests.conftest.mock_zmq_socket" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Fixture to provide a mock ZMQ socket.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/conftest.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mock_zmq_socket</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">MagicMock</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fixture to provide a mock ZMQ socket.&quot;&quot;&quot;</span>
    <span class="n">zmq_socket</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">patch</span><span class="p">(</span><span class="s2">&quot;zmq.Socket&quot;</span><span class="p">,</span> <span class="n">new_callable</span><span class="o">=</span><span class="n">zmq_socket</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">zmq_socket</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="aiperftestsservicestest_dataset_manager">aiperf.tests.services.test_dataset_manager<a class="headerlink" href="#aiperftestsservicestest_dataset_manager" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.tests.services.test_dataset_manager"></a>
    <div class="doc doc-contents first">

        <p>Tests for the dataset manager service.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.tests.services.test_dataset_manager.DatasetManagerTestConfig" class="doc doc-heading">
            <code>DatasetManagerTestConfig</code>


<a href="#aiperf.tests.services.test_dataset_manager.DatasetManagerTestConfig" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Configuration model for dataset manager tests.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/tests/services/test_dataset_manager.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DatasetManagerTestConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration model for dataset manager tests.&quot;&quot;&quot;</span>

    <span class="c1"># TODO: Replace this with the actual configuration model once available</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.tests.services.test_dataset_manager.TestDatasetManager" class="doc doc-heading">
            <code>TestDatasetManager</code>


<a href="#aiperf.tests.services.test_dataset_manager.TestDatasetManager" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseTestComponentService (aiperf.tests.base_test_component_service.BaseTestComponentService)" href="#aiperf.tests.base_test_component_service.BaseTestComponentService">BaseTestComponentService</a></code></p>


        <p>Tests for the dataset manager service.</p>
<p>This test class extends BaseTestComponentService to leverage common
component service tests while adding dataset manager specific tests.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/tests/services/test_dataset_manager.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TestDatasetManager</span><span class="p">(</span><span class="n">BaseTestComponentService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests for the dataset manager service.</span>

<span class="sd">    This test class extends BaseTestComponentService to leverage common</span>
<span class="sd">    component service tests while adding dataset manager specific tests.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">service_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the service class to be tested.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DatasetManager</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dataset_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DatasetManagerTestConfig</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a test configuration for the dataset manager.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DatasetManagerTestConfig</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_dataset_manager_initialization</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">DatasetManager</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test that the dataset manager initializes with the correct service type.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">service_type</span> <span class="o">==</span> <span class="n">ServiceType</span><span class="o">.</span><span class="n">DATASET_MANAGER</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_dataset_manager.TestDatasetManager.dataset_config" class="doc doc-heading">
            <code class=" language-python"><span class="n">dataset_config</span><span class="p">()</span></code>

<a href="#aiperf.tests.services.test_dataset_manager.TestDatasetManager.dataset_config" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return a test configuration for the dataset manager.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_dataset_manager.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">dataset_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DatasetManagerTestConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a test configuration for the dataset manager.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DatasetManagerTestConfig</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_dataset_manager.TestDatasetManager.service_class" class="doc doc-heading">
            <code class=" language-python"><span class="n">service_class</span><span class="p">()</span></code>

<a href="#aiperf.tests.services.test_dataset_manager.TestDatasetManager.service_class" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the service class to be tested.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_dataset_manager.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">service_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the service class to be tested.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DatasetManager</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_dataset_manager.TestDatasetManager.test_dataset_manager_initialization" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_dataset_manager_initialization</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.services.test_dataset_manager.TestDatasetManager.test_dataset_manager_initialization" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test that the dataset manager initializes with the correct service type.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_dataset_manager.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_dataset_manager_initialization</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">DatasetManager</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test that the dataset manager initializes with the correct service type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">service_type</span> <span class="o">==</span> <span class="n">ServiceType</span><span class="o">.</span><span class="n">DATASET_MANAGER</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperftestsservicestest_post_processor_manager">aiperf.tests.services.test_post_processor_manager<a class="headerlink" href="#aiperftestsservicestest_post_processor_manager" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.tests.services.test_post_processor_manager"></a>
    <div class="doc doc-contents first">

        <p>Tests for the post processor manager service.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.tests.services.test_post_processor_manager.PostProcessorTestConfig" class="doc doc-heading">
            <code>PostProcessorTestConfig</code>


<a href="#aiperf.tests.services.test_post_processor_manager.PostProcessorTestConfig" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Configuration model for post processor manager tests.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/tests/services/test_post_processor_manager.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PostProcessorTestConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration model for post processor manager tests.&quot;&quot;&quot;</span>

    <span class="c1"># TODO: Replace this with the actual configuration model once available</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.tests.services.test_post_processor_manager.TestPostProcessorManager" class="doc doc-heading">
            <code>TestPostProcessorManager</code>


<a href="#aiperf.tests.services.test_post_processor_manager.TestPostProcessorManager" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseTestComponentService (aiperf.tests.base_test_component_service.BaseTestComponentService)" href="#aiperf.tests.base_test_component_service.BaseTestComponentService">BaseTestComponentService</a></code></p>


        <p>Tests for the post processor manager service.</p>
<p>This test class extends BaseTestComponentService to leverage common
component service tests while adding post processor manager specific tests.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/tests/services/test_post_processor_manager.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TestPostProcessorManager</span><span class="p">(</span><span class="n">BaseTestComponentService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests for the post processor manager service.</span>

<span class="sd">    This test class extends BaseTestComponentService to leverage common</span>
<span class="sd">    component service tests while adding post processor manager specific tests.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">service_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the service class to be tested.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">PostProcessorManager</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">processor_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PostProcessorTestConfig</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a test configuration for the post processor manager.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">PostProcessorTestConfig</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_post_processor_manager_initialization</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">PostProcessorManager</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test that the post processor manager initializes with the correct service type.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">service_type</span> <span class="o">==</span> <span class="n">ServiceType</span><span class="o">.</span><span class="n">POST_PROCESSOR_MANAGER</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_post_processor_manager.TestPostProcessorManager.processor_config" class="doc doc-heading">
            <code class=" language-python"><span class="n">processor_config</span><span class="p">()</span></code>

<a href="#aiperf.tests.services.test_post_processor_manager.TestPostProcessorManager.processor_config" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return a test configuration for the post processor manager.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_post_processor_manager.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">processor_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PostProcessorTestConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a test configuration for the post processor manager.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">PostProcessorTestConfig</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_post_processor_manager.TestPostProcessorManager.service_class" class="doc doc-heading">
            <code class=" language-python"><span class="n">service_class</span><span class="p">()</span></code>

<a href="#aiperf.tests.services.test_post_processor_manager.TestPostProcessorManager.service_class" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the service class to be tested.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_post_processor_manager.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">service_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the service class to be tested.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">PostProcessorManager</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_post_processor_manager.TestPostProcessorManager.test_post_processor_manager_initialization" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_post_processor_manager_initialization</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.services.test_post_processor_manager.TestPostProcessorManager.test_post_processor_manager_initialization" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test that the post processor manager initializes with the correct service type.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_post_processor_manager.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_post_processor_manager_initialization</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">PostProcessorManager</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test that the post processor manager initializes with the correct service type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">service_type</span> <span class="o">==</span> <span class="n">ServiceType</span><span class="o">.</span><span class="n">POST_PROCESSOR_MANAGER</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperftestsservicestest_records_manager">aiperf.tests.services.test_records_manager<a class="headerlink" href="#aiperftestsservicestest_records_manager" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.tests.services.test_records_manager"></a>
    <div class="doc doc-contents first">

        <p>Tests for the records manager service.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.tests.services.test_records_manager.RecordsManagerTestConfig" class="doc doc-heading">
            <code>RecordsManagerTestConfig</code>


<a href="#aiperf.tests.services.test_records_manager.RecordsManagerTestConfig" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Configuration model for records manager tests.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/tests/services/test_records_manager.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RecordsManagerTestConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration model for records manager tests.&quot;&quot;&quot;</span>

    <span class="c1"># TODO: Replace this with the actual configuration model once available</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.tests.services.test_records_manager.TestRecordsManager" class="doc doc-heading">
            <code>TestRecordsManager</code>


<a href="#aiperf.tests.services.test_records_manager.TestRecordsManager" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseTestComponentService (aiperf.tests.base_test_component_service.BaseTestComponentService)" href="#aiperf.tests.base_test_component_service.BaseTestComponentService">BaseTestComponentService</a></code></p>


        <p>Tests for the records manager service.</p>
<p>This test class extends BaseTestComponentService to leverage common
component service tests while adding records manager specific tests.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/tests/services/test_records_manager.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TestRecordsManager</span><span class="p">(</span><span class="n">BaseTestComponentService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests for the records manager service.</span>

<span class="sd">    This test class extends BaseTestComponentService to leverage common</span>
<span class="sd">    component service tests while adding records manager specific tests.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">service_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the service class to be tested.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RecordsManager</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">records_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RecordsManagerTestConfig</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a test configuration for the records manager.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RecordsManagerTestConfig</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_records_manager_initialization</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">RecordsManager</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test that the records manager initializes with the correct service type.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">service_type</span> <span class="o">==</span> <span class="n">ServiceType</span><span class="o">.</span><span class="n">RECORDS_MANAGER</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_records_manager.TestRecordsManager.records_config" class="doc doc-heading">
            <code class=" language-python"><span class="n">records_config</span><span class="p">()</span></code>

<a href="#aiperf.tests.services.test_records_manager.TestRecordsManager.records_config" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return a test configuration for the records manager.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_records_manager.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">records_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RecordsManagerTestConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a test configuration for the records manager.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">RecordsManagerTestConfig</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_records_manager.TestRecordsManager.service_class" class="doc doc-heading">
            <code class=" language-python"><span class="n">service_class</span><span class="p">()</span></code>

<a href="#aiperf.tests.services.test_records_manager.TestRecordsManager.service_class" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the service class to be tested.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_records_manager.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">service_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the service class to be tested.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">RecordsManager</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_records_manager.TestRecordsManager.test_records_manager_initialization" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_records_manager_initialization</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.services.test_records_manager.TestRecordsManager.test_records_manager_initialization" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test that the records manager initializes with the correct service type.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_records_manager.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_records_manager_initialization</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">RecordsManager</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test that the records manager initializes with the correct service type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">service_type</span> <span class="o">==</span> <span class="n">ServiceType</span><span class="o">.</span><span class="n">RECORDS_MANAGER</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperftestsservicestest_system_controller">aiperf.tests.services.test_system_controller<a class="headerlink" href="#aiperftestsservicestest_system_controller" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.tests.services.test_system_controller"></a>
    <div class="doc doc-contents first">

        <p>Tests for the system controller service.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.tests.services.test_system_controller.SystemControllerTestConfig" class="doc doc-heading">
            <code>SystemControllerTestConfig</code>


<a href="#aiperf.tests.services.test_system_controller.SystemControllerTestConfig" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Configuration model for system controller tests.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/tests/services/test_system_controller.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SystemControllerTestConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration model for system controller tests.&quot;&quot;&quot;</span>

    <span class="c1"># TODO: Replace this with the actual configuration model once available</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.tests.services.test_system_controller.TestSystemController" class="doc doc-heading">
            <code>TestSystemController</code>


<a href="#aiperf.tests.services.test_system_controller.TestSystemController" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseTestControllerService (aiperf.tests.base_test_controller_service.BaseTestControllerService)" href="#aiperf.tests.base_test_controller_service.BaseTestControllerService">BaseTestControllerService</a></code></p>


        <p>Tests for the system controller service.</p>
<p>This test class extends BaseTestControllerService to leverage common
controller service tests while adding system controller specific tests.
Tests include service lifecycle management, message handling, and coordination.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/tests/services/test_system_controller.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TestSystemController</span><span class="p">(</span><span class="n">BaseTestControllerService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests for the system controller service.</span>

<span class="sd">    This test class extends BaseTestControllerService to leverage common</span>
<span class="sd">    controller service tests while adding system controller specific tests.</span>
<span class="sd">    Tests include service lifecycle management, message handling, and coordination.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">service_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the class to test.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">SystemController</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">controller_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SystemControllerTestConfig</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a test configuration for the system controller.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">SystemControllerTestConfig</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_controller_subscriptions</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">SystemController</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">:</span> <span class="n">MagicMock</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Verifies the controller sets up subscriptions to receive messages from components.&quot;&quot;&quot;</span>

        <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>

        <span class="c1"># A SystemController should subscribe to registration, status, and heartbeat topics</span>
        <span class="n">expected_topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">Topic</span><span class="o">.</span><span class="n">REGISTRATION</span><span class="p">,</span> <span class="n">Topic</span><span class="o">.</span><span class="n">STATUS</span><span class="p">,</span> <span class="n">Topic</span><span class="o">.</span><span class="n">HEARTBEAT</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">topic</span> <span class="ow">in</span> <span class="n">expected_topics</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">topic</span> <span class="ow">in</span> <span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">subscriptions</span>
            <span class="k">assert</span> <span class="nb">callable</span><span class="p">(</span><span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">subscriptions</span><span class="p">[</span><span class="n">topic</span><span class="p">])</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">autouse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">service_manager_with_multiprocess</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">monkeypatch</span><span class="p">,</span> <span class="n">service_config</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MultiProcessServiceManager</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a test service manager with multiprocess support.</span>

<span class="sd">        This fixture mocks the initialization methods to avoid actual process creation.</span>

<span class="sd">        Args:</span>
<span class="sd">            monkeypatch: Pytest monkeypatch fixture for patching functions</span>

<span class="sd">        Returns:</span>
<span class="sd">            A MultiProcessServiceManager instance configured for testing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create a proper async mock for the service methods</span>
        <span class="n">async_mock</span> <span class="o">=</span> <span class="n">AsyncMock</span><span class="p">(</span><span class="n">return_value</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span>
            <span class="n">MultiProcessServiceManager</span><span class="p">,</span> <span class="s2">&quot;wait_for_all_services_registration&quot;</span><span class="p">,</span> <span class="n">async_mock</span>
        <span class="p">)</span>
        <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span>
            <span class="n">MultiProcessServiceManager</span><span class="p">,</span> <span class="s2">&quot;initialize_all_services&quot;</span><span class="p">,</span> <span class="n">async_mock</span>
        <span class="p">)</span>
        <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">MultiProcessServiceManager</span><span class="p">,</span> <span class="s2">&quot;stop_all_services&quot;</span><span class="p">,</span> <span class="n">async_mock</span><span class="p">)</span>
        <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span>
            <span class="n">MultiProcessServiceManager</span><span class="p">,</span> <span class="s2">&quot;wait_for_all_services_start&quot;</span><span class="p">,</span> <span class="n">async_mock</span>
        <span class="p">)</span>

        <span class="n">multiprocess_manager</span> <span class="o">=</span> <span class="n">MultiProcessServiceManager</span><span class="p">(</span>
            <span class="n">required_service_types</span><span class="o">=</span><span class="p">[</span><span class="n">ServiceType</span><span class="o">.</span><span class="n">TEST</span><span class="p">],</span>
            <span class="n">config</span><span class="o">=</span><span class="n">service_config</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">multiprocess_manager</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_service_run_does_start</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">SystemController</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test that the service run method starts the service (added by BaseControllerService using @on_run).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>

        <span class="k">with</span> <span class="p">(</span>
            <span class="n">patch</span><span class="p">(</span>
                <span class="s2">&quot;aiperf.services.system_controller.system_controller.SystemController._forever_loop&quot;</span><span class="p">,</span>
                <span class="n">return_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span> <span class="k">as</span> <span class="n">mock_forever_loop</span><span class="p">,</span>
            <span class="n">patch</span><span class="p">(</span>
                <span class="s2">&quot;aiperf.services.system_controller.system_controller.SystemController.start&quot;</span><span class="p">,</span>
                <span class="n">return_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span> <span class="k">as</span> <span class="n">mock_start</span><span class="p">,</span>
        <span class="p">):</span>
            <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">run_forever</span><span class="p">()</span>
            <span class="n">mock_forever_loop</span><span class="o">.</span><span class="n">assert_called_once</span><span class="p">()</span>
            <span class="n">mock_start</span><span class="o">.</span><span class="n">assert_called_once</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_system_controller.TestSystemController.controller_config" class="doc doc-heading">
            <code class=" language-python"><span class="n">controller_config</span><span class="p">()</span></code>

<a href="#aiperf.tests.services.test_system_controller.TestSystemController.controller_config" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return a test configuration for the system controller.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_system_controller.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">controller_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SystemControllerTestConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a test configuration for the system controller.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">SystemControllerTestConfig</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_system_controller.TestSystemController.service_class" class="doc doc-heading">
            <code class=" language-python"><span class="n">service_class</span><span class="p">()</span></code>

<a href="#aiperf.tests.services.test_system_controller.TestSystemController.service_class" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the class to test.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_system_controller.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">service_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the class to test.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">SystemController</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_system_controller.TestSystemController.service_manager_with_multiprocess" class="doc doc-heading">
            <code class=" language-python"><span class="n">service_manager_with_multiprocess</span><span class="p">(</span><span class="n">monkeypatch</span><span class="p">,</span> <span class="n">service_config</span><span class="p">)</span></code>

<a href="#aiperf.tests.services.test_system_controller.TestSystemController.service_manager_with_multiprocess" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return a test service manager with multiprocess support.</p>
<p>This fixture mocks the initialization methods to avoid actual process creation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>monkeypatch</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pytest monkeypatch fixture for patching functions</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="MultiProcessServiceManager (aiperf.services.service_manager.multiprocess.MultiProcessServiceManager)" href="#aiperf.services.service_manager.multiprocess.MultiProcessServiceManager">MultiProcessServiceManager</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A MultiProcessServiceManager instance configured for testing</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_system_controller.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">autouse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">service_manager_with_multiprocess</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">monkeypatch</span><span class="p">,</span> <span class="n">service_config</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MultiProcessServiceManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a test service manager with multiprocess support.</span>

<span class="sd">    This fixture mocks the initialization methods to avoid actual process creation.</span>

<span class="sd">    Args:</span>
<span class="sd">        monkeypatch: Pytest monkeypatch fixture for patching functions</span>

<span class="sd">    Returns:</span>
<span class="sd">        A MultiProcessServiceManager instance configured for testing</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create a proper async mock for the service methods</span>
    <span class="n">async_mock</span> <span class="o">=</span> <span class="n">AsyncMock</span><span class="p">(</span><span class="n">return_value</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span>
        <span class="n">MultiProcessServiceManager</span><span class="p">,</span> <span class="s2">&quot;wait_for_all_services_registration&quot;</span><span class="p">,</span> <span class="n">async_mock</span>
    <span class="p">)</span>
    <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span>
        <span class="n">MultiProcessServiceManager</span><span class="p">,</span> <span class="s2">&quot;initialize_all_services&quot;</span><span class="p">,</span> <span class="n">async_mock</span>
    <span class="p">)</span>
    <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span><span class="n">MultiProcessServiceManager</span><span class="p">,</span> <span class="s2">&quot;stop_all_services&quot;</span><span class="p">,</span> <span class="n">async_mock</span><span class="p">)</span>
    <span class="n">monkeypatch</span><span class="o">.</span><span class="n">setattr</span><span class="p">(</span>
        <span class="n">MultiProcessServiceManager</span><span class="p">,</span> <span class="s2">&quot;wait_for_all_services_start&quot;</span><span class="p">,</span> <span class="n">async_mock</span>
    <span class="p">)</span>

    <span class="n">multiprocess_manager</span> <span class="o">=</span> <span class="n">MultiProcessServiceManager</span><span class="p">(</span>
        <span class="n">required_service_types</span><span class="o">=</span><span class="p">[</span><span class="n">ServiceType</span><span class="o">.</span><span class="n">TEST</span><span class="p">],</span>
        <span class="n">config</span><span class="o">=</span><span class="n">service_config</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">multiprocess_manager</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_system_controller.TestSystemController.test_controller_subscriptions" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_controller_subscriptions</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.services.test_system_controller.TestSystemController.test_controller_subscriptions" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Verifies the controller sets up subscriptions to receive messages from components.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_system_controller.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_controller_subscriptions</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">SystemController</span><span class="p">,</span> <span class="n">mock_communication</span><span class="p">:</span> <span class="n">MagicMock</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Verifies the controller sets up subscriptions to receive messages from components.&quot;&quot;&quot;</span>

    <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>

    <span class="c1"># A SystemController should subscribe to registration, status, and heartbeat topics</span>
    <span class="n">expected_topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">Topic</span><span class="o">.</span><span class="n">REGISTRATION</span><span class="p">,</span> <span class="n">Topic</span><span class="o">.</span><span class="n">STATUS</span><span class="p">,</span> <span class="n">Topic</span><span class="o">.</span><span class="n">HEARTBEAT</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">topic</span> <span class="ow">in</span> <span class="n">expected_topics</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">topic</span> <span class="ow">in</span> <span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">subscriptions</span>
        <span class="k">assert</span> <span class="nb">callable</span><span class="p">(</span><span class="n">mock_communication</span><span class="o">.</span><span class="n">mock_data</span><span class="o">.</span><span class="n">subscriptions</span><span class="p">[</span><span class="n">topic</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_system_controller.TestSystemController.test_service_run_does_start" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_service_run_does_start</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.services.test_system_controller.TestSystemController.test_service_run_does_start" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test that the service run method starts the service (added by BaseControllerService using @on_run).</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_system_controller.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_service_run_does_start</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">SystemController</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test that the service run method starts the service (added by BaseControllerService using @on_run).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>

    <span class="k">with</span> <span class="p">(</span>
        <span class="n">patch</span><span class="p">(</span>
            <span class="s2">&quot;aiperf.services.system_controller.system_controller.SystemController._forever_loop&quot;</span><span class="p">,</span>
            <span class="n">return_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">mock_forever_loop</span><span class="p">,</span>
        <span class="n">patch</span><span class="p">(</span>
            <span class="s2">&quot;aiperf.services.system_controller.system_controller.SystemController.start&quot;</span><span class="p">,</span>
            <span class="n">return_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">mock_start</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">run_forever</span><span class="p">()</span>
        <span class="n">mock_forever_loop</span><span class="o">.</span><span class="n">assert_called_once</span><span class="p">()</span>
        <span class="n">mock_start</span><span class="o">.</span><span class="n">assert_called_once</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperftestsservicestest_timing_manager">aiperf.tests.services.test_timing_manager<a class="headerlink" href="#aiperftestsservicestest_timing_manager" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.tests.services.test_timing_manager"></a>
    <div class="doc doc-contents first">

        <p>Tests for the timing manager service.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.tests.services.test_timing_manager.TestTimingManager" class="doc doc-heading">
            <code>TestTimingManager</code>


<a href="#aiperf.tests.services.test_timing_manager.TestTimingManager" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseTestComponentService (aiperf.tests.base_test_component_service.BaseTestComponentService)" href="#aiperf.tests.base_test_component_service.BaseTestComponentService">BaseTestComponentService</a></code></p>


        <p>Tests for the timing manager service.</p>
<p>This test class extends BaseTestComponentService to leverage common
component service tests while adding timing manager specific tests.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/tests/services/test_timing_manager.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TestTimingManager</span><span class="p">(</span><span class="n">BaseTestComponentService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests for the timing manager service.</span>

<span class="sd">    This test class extends BaseTestComponentService to leverage common</span>
<span class="sd">    component service tests while adding timing manager specific tests.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">service_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the service class to be tested.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">TimingManager</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">timing_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimingManagerTestConfig</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a test configuration for the timing manager.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">TimingManagerTestConfig</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_timing_manager_initialization</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">TimingManager</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test that the timing manager initializes with the correct service type.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">service_type</span> <span class="o">==</span> <span class="n">ServiceType</span><span class="o">.</span><span class="n">TIMING_MANAGER</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_timing_manager.TestTimingManager.service_class" class="doc doc-heading">
            <code class=" language-python"><span class="n">service_class</span><span class="p">()</span></code>

<a href="#aiperf.tests.services.test_timing_manager.TestTimingManager.service_class" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the service class to be tested.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_timing_manager.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">service_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the service class to be tested.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">TimingManager</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_timing_manager.TestTimingManager.test_timing_manager_initialization" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_timing_manager_initialization</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.services.test_timing_manager.TestTimingManager.test_timing_manager_initialization" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test that the timing manager initializes with the correct service type.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_timing_manager.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_timing_manager_initialization</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">TimingManager</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test that the timing manager initializes with the correct service type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">service_type</span> <span class="o">==</span> <span class="n">ServiceType</span><span class="o">.</span><span class="n">TIMING_MANAGER</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_timing_manager.TestTimingManager.timing_config" class="doc doc-heading">
            <code class=" language-python"><span class="n">timing_config</span><span class="p">()</span></code>

<a href="#aiperf.tests.services.test_timing_manager.TestTimingManager.timing_config" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return a test configuration for the timing manager.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_timing_manager.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">timing_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimingManagerTestConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a test configuration for the timing manager.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">TimingManagerTestConfig</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.tests.services.test_timing_manager.TimingManagerTestConfig" class="doc doc-heading">
            <code>TimingManagerTestConfig</code>


<a href="#aiperf.tests.services.test_timing_manager.TimingManagerTestConfig" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Configuration model for timing manager tests.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/tests/services/test_timing_manager.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">TimingManagerTestConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration model for timing manager tests.&quot;&quot;&quot;</span>

    <span class="c1"># TODO: Replace this with the actual configuration model once available</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperftestsservicestest_worker">aiperf.tests.services.test_worker<a class="headerlink" href="#aiperftestsservicestest_worker" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.tests.services.test_worker"></a>
    <div class="doc doc-contents first">

        <p>Tests for the worker service.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.tests.services.test_worker.TestWorker" class="doc doc-heading">
            <code>TestWorker</code>


<a href="#aiperf.tests.services.test_worker.TestWorker" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseTestService (aiperf.tests.base_test_service.BaseTestService)" href="#aiperf.tests.base_test_service.BaseTestService">BaseTestService</a></code></p>


        <p>Tests for the worker service.</p>
<p>This test class extends BaseTestService since Worker is a direct subclass
of BaseService, not a BaseComponentService.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/tests/services/test_worker.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TestWorker</span><span class="p">(</span><span class="n">BaseTestService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests for the worker service.</span>

<span class="sd">    This test class extends BaseTestService since Worker is a direct subclass</span>
<span class="sd">    of BaseService, not a BaseComponentService.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">service_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the service class to be tested.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Worker</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">worker_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WorkerTestConfig</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a test configuration for the worker.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">WorkerTestConfig</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_worker_initialization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">Worker</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test that the worker initializes with the correct configuration.</span>

<span class="sd">        Verifies the worker service is properly instantiated with its configuration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Basic existence checks</span>
        <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">service</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">service_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">service_type</span> <span class="o">==</span> <span class="n">ServiceType</span><span class="o">.</span><span class="n">WORKER</span>

        <span class="c1"># Initialize the worker</span>
        <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

        <span class="c1"># Check the worker is properly initialized</span>
        <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">is_initialized</span>
        <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">READY</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_worker.TestWorker.service_class" class="doc doc-heading">
            <code class=" language-python"><span class="n">service_class</span><span class="p">()</span></code>

<a href="#aiperf.tests.services.test_worker.TestWorker.service_class" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the service class to be tested.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_worker.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">service_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the service class to be tested.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Worker</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_worker.TestWorker.test_worker_initialization" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_worker_initialization</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.services.test_worker.TestWorker.test_worker_initialization" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test that the worker initializes with the correct configuration.</p>
<p>Verifies the worker service is properly instantiated with its configuration.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_worker.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_worker_initialization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">Worker</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test that the worker initializes with the correct configuration.</span>

<span class="sd">    Verifies the worker service is properly instantiated with its configuration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Basic existence checks</span>
    <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">service</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">service_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">service_type</span> <span class="o">==</span> <span class="n">ServiceType</span><span class="o">.</span><span class="n">WORKER</span>

    <span class="c1"># Initialize the worker</span>
    <span class="k">await</span> <span class="n">service</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

    <span class="c1"># Check the worker is properly initialized</span>
    <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">is_initialized</span>
    <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">ServiceState</span><span class="o">.</span><span class="n">READY</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_worker.TestWorker.worker_config" class="doc doc-heading">
            <code class=" language-python"><span class="n">worker_config</span><span class="p">()</span></code>

<a href="#aiperf.tests.services.test_worker.TestWorker.worker_config" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return a test configuration for the worker.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_worker.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">worker_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WorkerTestConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a test configuration for the worker.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">WorkerTestConfig</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.tests.services.test_worker.WorkerTestConfig" class="doc doc-heading">
            <code>WorkerTestConfig</code>


<a href="#aiperf.tests.services.test_worker.WorkerTestConfig" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Test configuration for the workers.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/tests/services/test_worker.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">WorkerTestConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test configuration for the workers.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># TODO: Replace this with the actual configuration model once available</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperftestsservicestest_worker_manager">aiperf.tests.services.test_worker_manager<a class="headerlink" href="#aiperftestsservicestest_worker_manager" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.tests.services.test_worker_manager"></a>
    <div class="doc doc-contents first">

        <p>Tests for the worker manager service.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aiperf.tests.services.test_worker_manager.TestWorkerManager" class="doc doc-heading">
            <code>TestWorkerManager</code>


<a href="#aiperf.tests.services.test_worker_manager.TestWorkerManager" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseTestComponentService (aiperf.tests.base_test_component_service.BaseTestComponentService)" href="#aiperf.tests.base_test_component_service.BaseTestComponentService">BaseTestComponentService</a></code></p>


        <p>Tests for the worker manager service.</p>
<p>This test class extends BaseTestComponentService to leverage common
component service tests while adding worker manager specific tests.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/tests/services/test_worker_manager.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">asyncio</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TestWorkerManager</span><span class="p">(</span><span class="n">BaseTestComponentService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tests for the worker manager service.</span>

<span class="sd">    This test class extends BaseTestComponentService to leverage common</span>
<span class="sd">    component service tests while adding worker manager specific tests.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">service_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the service class to be tested.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">WorkerManager</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">worker_manager_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WorkerManagerTestConfig</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a test configuration for the worker manager.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">WorkerManagerTestConfig</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_worker_manager_initialization</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">WorkerManager</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test that the worker manager initializes with the correct attributes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">service_type</span> <span class="o">==</span> <span class="n">ServiceType</span><span class="o">.</span><span class="n">WORKER_MANAGER</span>
        <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="s2">&quot;workers&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="s2">&quot;cpu_count&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">==</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">worker_count</span> <span class="o">==</span> <span class="n">service</span><span class="o">.</span><span class="n">cpu_count</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_worker_manager.TestWorkerManager.service_class" class="doc doc-heading">
            <code class=" language-python"><span class="n">service_class</span><span class="p">()</span></code>

<a href="#aiperf.tests.services.test_worker_manager.TestWorkerManager.service_class" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the service class to be tested.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_worker_manager.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">service_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the service class to be tested.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">WorkerManager</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_worker_manager.TestWorkerManager.test_worker_manager_initialization" class="doc doc-heading">
            <code class=" language-python"><span class="n">test_worker_manager_initialization</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.services.test_worker_manager.TestWorkerManager.test_worker_manager_initialization" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Test that the worker manager initializes with the correct attributes.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_worker_manager.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">test_worker_manager_initialization</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">initialized_service</span><span class="p">:</span> <span class="n">WorkerManager</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test that the worker manager initializes with the correct attributes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">service</span> <span class="o">=</span> <span class="k">await</span> <span class="n">async_fixture</span><span class="p">(</span><span class="n">initialized_service</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">service_type</span> <span class="o">==</span> <span class="n">ServiceType</span><span class="o">.</span><span class="n">WORKER_MANAGER</span>
    <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="s2">&quot;workers&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="s2">&quot;cpu_count&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">==</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">service</span><span class="o">.</span><span class="n">worker_count</span> <span class="o">==</span> <span class="n">service</span><span class="o">.</span><span class="n">cpu_count</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="aiperf.tests.services.test_worker_manager.TestWorkerManager.worker_manager_config" class="doc doc-heading">
            <code class=" language-python"><span class="n">worker_manager_config</span><span class="p">()</span></code>

<a href="#aiperf.tests.services.test_worker_manager.TestWorkerManager.worker_manager_config" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return a test configuration for the worker manager.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/services/test_worker_manager.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">worker_manager_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WorkerManagerTestConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a test configuration for the worker manager.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">WorkerManagerTestConfig</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="aiperf.tests.services.test_worker_manager.WorkerManagerTestConfig" class="doc doc-heading">
            <code>WorkerManagerTestConfig</code>


<a href="#aiperf.tests.services.test_worker_manager.WorkerManagerTestConfig" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Configuration model for worker manager tests.</p>







              <details class="quote">
                <summary>Source code in <code>aiperf/tests/services/test_worker_manager.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">WorkerManagerTestConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration model for worker manager tests.&quot;&quot;&quot;</span>

    <span class="c1"># TODO: Replace this with the actual configuration model once available</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>

    </div>

</div>




  </div>

    </div>

</div><h2 id="aiperfteststest_audio_generator">aiperf.tests.test_audio_generator<a class="headerlink" href="#aiperfteststest_audio_generator" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.tests.test_audio_generator"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="aiperf.tests.test_audio_generator.decode_audio" class="doc doc-heading">
            <code class=" language-python"><span class="n">decode_audio</span><span class="p">(</span><span class="n">data_uri</span><span class="p">)</span></code>

<a href="#aiperf.tests.test_audio_generator.decode_audio" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Helper function to decode audio from data URI format.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data_uri</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data URI string in format "format,b64_data"</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="numpy.ndarray">ndarray</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of (audio_data: np.ndarray, sample_rate: int)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/test_audio_generator.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">decode_audio</span><span class="p">(</span><span class="n">data_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Helper function to decode audio from data URI format.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_uri: Data URI string in format &quot;format,b64_data&quot;</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (audio_data: np.ndarray, sample_rate: int)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Parse data URI</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">b64_data</span> <span class="o">=</span> <span class="n">data_uri</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="n">decoded_data</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">b64_data</span><span class="p">)</span>

    <span class="c1"># Load audio using soundfile - format is auto-detected from content</span>
    <span class="n">audio_data</span><span class="p">,</span> <span class="n">sample_rate</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">decoded_data</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">audio_data</span><span class="p">,</span> <span class="n">sample_rate</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="aiperfteststest_image_generator">aiperf.tests.test_image_generator<a class="headerlink" href="#aiperfteststest_image_generator" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.tests.test_image_generator"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">











  </div>

    </div>

</div><h2 id="aiperfteststest_prompt_generator">aiperf.tests.test_prompt_generator<a class="headerlink" href="#aiperfteststest_prompt_generator" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.tests.test_prompt_generator"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">











  </div>

    </div>

</div><h2 id="aiperfteststest_tokenizer">aiperf.tests.test_tokenizer<a class="headerlink" href="#aiperfteststest_tokenizer" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.tests.test_tokenizer"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">











  </div>

    </div>

</div><h2 id="aiperftestsutilsasync_test_utils">aiperf.tests.utils.async_test_utils<a class="headerlink" href="#aiperftestsutilsasync_test_utils" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="aiperf.tests.utils.async_test_utils"></a>
    <div class="doc doc-contents first">

        <p>Utilities for testing asynchronous code.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="aiperf.tests.utils.async_test_utils.async_fixture" class="doc doc-heading">
            <code class=" language-python"><span class="n">async_fixture</span><span class="p">(</span><span class="n">fixture</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.utils.async_test_utils.async_fixture" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Manually await an async pytest fixture.</p>
<p>This is necessary because pytest fixtures are not awaited by default in test methods.
If the fixture is an async generator, this will get the first yielded value.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fixture</code>
            </td>
            <td>
                  <code><span title="aiperf.tests.utils.async_test_utils.T">T</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fixture to await</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="aiperf.tests.utils.async_test_utils.T">T</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The awaited fixture value</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/utils/async_test_utils.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">async_fixture</span><span class="p">(</span><span class="n">fixture</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Manually await an async pytest fixture.</span>

<span class="sd">    This is necessary because pytest fixtures are not awaited by default in test methods.</span>
<span class="sd">    If the fixture is an async generator, this will get the first yielded value.</span>

<span class="sd">    Args:</span>
<span class="sd">        fixture: The fixture to await</span>

<span class="sd">    Returns:</span>
<span class="sd">        The awaited fixture value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fixture</span><span class="p">,</span> <span class="s2">&quot;__aiter__&quot;</span><span class="p">):</span>
        <span class="c1"># If it&#39;s an async generator, get the first yielded value</span>
        <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">suppress</span><span class="p">(</span><span class="ne">StopAsyncIteration</span><span class="p">):</span>
            <span class="n">async_gen</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">AsyncIterator</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">fixture</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="k">await</span> <span class="n">anext</span><span class="p">(</span><span class="n">async_gen</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="c1"># Otherwise return the fixture as is</span>
    <span class="k">return</span> <span class="n">fixture</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="aiperf.tests.utils.async_test_utils.async_noop" class="doc doc-heading">
            <code class=" language-python"><span class="n">async_noop</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#aiperf.tests.utils.async_test_utils.async_noop" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>A no-op async function for testing purposes.</p>
<p>Can be used to replace asyncio.sleep, asyncio.wait_for, or other async calls in tests.
Accepts any arguments but performs no operation and returns immediately.</p>


            <details class="quote">
              <summary>Source code in <code>aiperf/tests/utils/async_test_utils.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">async_noop</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A no-op async function for testing purposes.</span>

<span class="sd">    Can be used to replace asyncio.sleep, asyncio.wait_for, or other async calls in tests.</span>
<span class="sd">    Accepts any arguments but performs no operation and returns immediately.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>